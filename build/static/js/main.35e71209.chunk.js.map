{"version":3,"sources":["config/serviceWorker.js","services/export-service/index.js","services/wri-service/constants.js","utils/process-location.js","modules/dashboard/actions.js","modules/dashboard/constants.js","modules/map/actions.js","services/wri-service/wri-json-api-serializer.js","services/wri-service/aggregate-by-key.js","services/wri-service/index.js","modules/data/actions.js","modules/app/actions.js","modules/app/reducers.js","modules/app/initial-state.js","modules/data/reducers.js","modules/data/initial-state.js","modules/pages/constants.js","modules/pages/actions.js","modules/pages/reducers.js","modules/pages/initial-state.js","modules/map/reducers.js","modules/map/initial-state.js","modules/layers/actions.js","modules/layers/reducers.js","modules/layers/initial-state.js","modules/dashboard/reducers.js","modules/dashboard/initial-state.js","config/router.js","config/store.js","components/modal-manager/index.js","components/share-modal/component.js","modules/dashboard/selectors.js","components/country-selector/component.js","components/country-selector/index.js","components/indicator-selector/component.js","components/indicator-selector/index.js","components/header-general/component.js","components/header-country/component.js","components/bar/component.js","components/widget/component.js","components/dashboard-widgets/constants.js","components/dashboard-widgets/component.js","components/footer/component.js","components/dashboard/component.js","components/dashboard/index.js","components/legend-type-choropleth/component.js","components/legend-type-choropleth/index.js","components/map/constants.js","components/map/basemap-control/component.js","components/map/basemap-control/index.js","components/map/component.js","modules/layers/selectors.js","components/map/index.js","components/main/component.js","components/main/index.js","pages/home/index.js","pages/not-found/index.js","components/layout/component.js","components/layout/index.js","index.js"],"names":["Boolean","window","location","hostname","match","service","data","dataStr","encodeURIComponent","JSON","stringify","this","triggerDownload","flattenedData","map","row","indicators","opts","Object","objectWithoutProperties","objectSpread","fromEntries","entries","flatMap","entry","feat","concat","fields","keys","csv","json2csv","parse","process","name","el","document","createElement","setAttribute","click","INDICATORS","label","value","INDICATOR_CATEGORIES","Tot","Dom","Ind","Irr","Liv","Pop","Avg","ERRORS","MISSING_REQUIRED_PARAMETER","MISSING_WIDGET_REQUEST_PARAMETERS","getAverage","filter","category","reduce","acc","indicator","index","_ref","length","score","getIndicators","_objectSpread2","defineProperty","toFixed","rank","processLocation","iso","nameProp","arguments","undefined","setCountries","createAction","setIndicators","setLocation","setCountryValue","setIndicatorValue","setWidgetData","setWidgetStats","setWidth","actions","SCOPE","GENERAL","COUNTRY","setMap","setMapBounds","setMapStyle","setMapLabels","setMapRoads","setBasemap","setMapViewport","setMapLoaded","setMapFlying","getCountryBounds","createThunkAction","dispatch","getState","_state$dashboard","dashboard","locationId","offset","width","boundsSQL","axios","get","then","result","theGeom","rows","geometry","bbox","L","geoJSON","getBounds","toBBoxString","split","b","parseFloat","options","paddingTopLeft","map_actions","serialize","id","type","attributes","assign","itemSerializer","_ref2","d","prototype","hasOwnProperty","call","widget","layer","metadata","locale","find","m","language","vocabulary","legendConfig","items","item","i","wriAPISerializer","_ref3","Array","isArray","aggregateByKey","collection","key","mapFn","x","stats","sum","max","min","rowKey","rowValue","country","province","push","_stats","WRIService","classCallCheck","client","create","baseURL","headers","Content-Type","params","response","status","statusText","Error","serializer","datasets","_this","_Object$entries$reduc","toConsumableArray","fetchLayersFromDataset","_Object$entries$reduc2","slicedToArray","datasetNames","datasetPromises","all","_this2","widgetId","widgetParams","widgetData","url","processWidgetData","indexKey","weight","score_ranked","_widgetData$widgetCon","widgetConfig","params_config","param","required","replace","setCountriesData","loadDashboardData","state","router","query","getCountriesData","countries4widget","setCountry","toUpperCase","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","abrupt","fetchDatasetWidgets","res","countries","sort","localeCompare","sent","stop","_x","_x2","apply","getProvincesData","_callee2","_context2","_x3","_x4","data_actions","setDashboardCollapsed","setModalState","payload","setUrl","getData","setIndicator","scope","_state2$router","newQuery","saveData","exportService","saveRankings","reducerMap","_reducerMap","isDashboardCollapsed","isModalOpen","initial_state","data_reducers","_actions$setCountries","isLoading","isLoaded","data_initial_state","error","provinces","cache","PAGES","path","page","NOT_FOUND","pageActions","setPage","current","setPageReducer","pages_initial_state","map_reducers","_actions$setMap$actio","bounds","basemap","_ref4","mapStyle","_ref5","mapLabels","_ref6","mapRoads","_ref7","viewport","_ref8","settings","_ref9","isFlying","map_initial_state","zoom","latitude","longitude","setList","setLoading","setError","setLayersOpacity","getLayers","fetchDatasetsLayers","country_rankings","province_rankings","layers","catch","err","layers_actions","layers_reducers","_setList$setLoading$s","list","l","opacity","layers_initial_state","dashboard_reducers","reducers_actions$setCountries","dashboard_initial_state","routes","thunk","basename","notFoundPath","initialDispatch","querySerializer","queryString","connectRoutes","modules","namespace","components","app","pages","routerReducer","reducer","routerMiddleware","middleware","routerEnhancer","enhancer","reducers","combineReducers","module","handleModule","applyMiddleware","thunkMiddleware","enhancers","composeWithDevTools","store","createStore","connect","Modal","ShareModal","props","possibleConstructorReturn","getPrototypeOf","copied","getShareUrl","href","clipboard","Clipboard","btn","on","e","setState","setTimeout","clearSelection","preventDefault","left","innerWidth","top","innerHeight","currentTarget","open","_this3","title","share","urlEncoded","text","classCopy","react_default","className","readOnly","onFocus","select","data-clipboard-target","ref","node","target","rel","onClick","triggerPopup","dist_bundle","React","Component","defaultProps","createSelector","_data","currentLocation","_dashboard","getCountryData","_currentLocation","_countries","countrySelectStyles","container","styles","height","valueContainer","marginLeft","IndicatorsContainer","CountrySelector","bundle","theme","placeholder","onChange","option","customClass","console","log","mapDispatchToProps","IndicatorSelector","classnames","HeaderGeneral","country_selector","indicator_selector","HeaderCountry","onBackClick","order","headerIndicators","includes","indexOf","DashboardWidgets","fill","style","display","backgroundColor","Chart","_ref$config","config","palette","react","field","bar_component","Widget","classes","rowNumber","chartConfig","columns","component_Chart","chartOrder","tableClasses","buttonText","onSelect","indicatorsLegend","sortedData","_a$indicators","aTot","aPop","_b$indicators","bTot","bPop","widget_component","Footer","Dashboard","headerData","widgetsData","dashboardEl","useRef","useEffect","currentWidth","offsetWidth","rankingTitle","header_general_component","header_country_component","dashboard_widgets_component","footer_component","LegendTypeChoropleth","activeLayer","color","disclaimer","background","PureComponent","LABEL_LAYER_CONFIG","attribution","BASEMAPS","osm","satellite","terrain","hydro","BasemapControl","active","_onScreenClick","onScreenClick","bind","assertThisInitialized","removeEventListener","querySelector","contains","toggleDropdown","to","requestAnimationFrame","addEventListener","react_tether_default","attachment","constraints","targetOffset","element","k","bs","selected","_basemap","onBasemapChange","Map","latlng","interactions","_this$props","_this$props$className","basemapConfig","mapProps","mapOptions","center","lat","lng","events","zoomend","dragend","layerGroups","dataset","shareClickHandler","_map","plugin","PluginLeaflet","onReady","interactionConfig","output","interactivity","provider","o","column","interactionData","basemap_control","name_1","name_0","sortable","lg","layerGroup","onChangeOpacity","_layer","_opacity","toolbar","trackStyle","handleStyle","legend_type_choropleth","children","dragPan","dragRotate","onViewportChange","onLoad","onStyleLoad","indexes","bws","drr","rfr","getActiveLayers","_layers","_currentScope","_currentCountry","_currentIndicator","indicatorIndex","layerSpec","Main","onToggle","isExpanded","visible","components_dashboard","modal_manager","isOpen","appElement","onRequestClose","component_ShareModal","HomePage","main","NotFoundPage","pageMap","Layout","Page","has","ReactDOM","render","es","layout","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"gqGAaoBA,QACW,cAA7BC,OAAOC,SAASC,UAEkB,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MAC1B,yJCsCSC,EADQ,uGArDVC,GACT,IAAMC,EAAU,gCAAkCC,mBAAmBC,KAAKC,UAAUJ,IACpFK,KAAKC,gBAAgB,eAAgBL,qCAG7BD,GACR,IAAMO,EAAgBP,EAAKQ,IAAI,SAAAC,GAAO,IAC7BC,EAAuBD,EAAvBC,WAAeC,EADcC,OAAAC,EAAA,EAAAD,CACNH,EADM,gBAGpC,OAAKC,EAIEE,OAAAE,EAAA,EAAAF,CAAA,GACFD,EACAC,OAAOG,YACRH,OAAOI,QAAQP,EAAIC,YAAYO,QAC7B,SAAAC,GAAK,OAAIN,OAAOI,QAAQE,EAAM,IAAIV,IAChC,SAAAW,GAAI,MAAI,IAAAC,OAAIF,EAAM,GAAV,KAAAE,OAAgBD,EAAK,IAAKA,EAAK,UARtCP,OAAAE,EAAA,EAAAF,CAAA,GAAID,KAeTU,EAAST,OAAOU,KAAKf,EAAc,IAEnCgB,EAAMC,IAASC,MAAMlB,EAAe,CAAEc,WACtCpB,EAAU,+BAAiCC,mBAAmBqB,GACpElB,KAAKC,gBAAgB,cAAeL,0CAOpC,IAAMA,EAAO,GAAAmB,OAAMM,GAAN,iCACbrB,KAAKC,gBAAgB,+BAAgCL,2CAQvC0B,EAAM1B,GACpB,IAAM2B,EAAKC,SAASC,cAAc,KAClCF,EAAGG,aAAa,OAAQ9B,GACxB2B,EAAGG,aAAa,WAAYJ,GAC5BC,EAAGI,kBCpDMC,EAAa,CACxB,CACEC,MAAO,wBACPC,MAAO,OAET,CACED,MAAO,eACPC,MAAO,OAET,CACED,MAAO,sBACPC,MAAO,QAIEC,EAAuB,CAClCC,IAAO,QACPC,IAAO,WACPC,IAAO,aACPC,IAAO,eACPC,IAAO,YACPC,IAAO,aACPC,IAAO,WAGIC,EAAS,CACpBC,2BAA4B,qCAC5BC,kCAAmC,wDCrBrC,SAASC,EAAW/C,GAClB,OAAOA,EAAKgD,OAAO,SAAA9B,GAAK,MAAuB,QAAnBA,EAAM+B,WAC/BC,OAAO,SAACC,EAAKC,EAAWC,EAAjBC,GAAA,IAAyBC,EAAzBD,EAAyBC,OAAzB,OAAsCF,IAAUE,EAAQ,GAC3DJ,EAAMC,EAAUI,OAAQD,EACzBJ,EAAMC,EAAUI,OAAO,GAW/B,SAASC,EAAczD,GACrB,OAAOA,EAAKkD,OAAO,SAACC,EAAKC,GAAN,IAAAM,EATHF,EASG,OAAA5C,OAAAE,EAAA,EAAAF,CAAA,GACduC,GADcO,EAAA,GAAA9C,OAAA+C,EAAA,EAAA/C,CAAA8C,EAEhBN,EAAUH,SAAW,CACpBtB,KAAMS,EAAqBgB,EAAUH,UACrCO,OAbYA,EAaIJ,EAAUI,MAZzBA,EAIEA,EAAMI,QAAQ,GAHZ,WAYLC,KAAMT,EAAUS,OALDjD,OAAA+C,EAAA,EAAA/C,CAAA8C,EAAA,MAOZ,CACH/B,KAAMS,EAAoB,IAC1BoB,MAAOT,EAAW/C,GAAM4D,QAAQ,KATjBF,KAWf,IAgBSI,MARR,SAAyBC,EAAK/D,GAA0B,IAApBgE,EAAoBC,UAAAV,OAAA,QAAAW,IAAAD,UAAA,GAAAA,UAAA,GAAX,UAClD,MAAO,CACLF,MACApC,KAAM3B,EAAK,GAAGgE,GACdtD,WAAY+C,EAAczD,KC3CjBmE,EAAeC,uBAAa,0BAC5BC,EAAgBD,uBAAa,2BAC7BE,EAAcF,uBAAa,yBAC3BG,EAAkBH,uBAAa,6BAC/BI,EAAoBJ,uBAAa,+BACjCK,EAAgBL,uBAAa,2BAC7BM,EAAiBN,uBAAa,4BAC9BO,EAAWP,uBAAa,sBAEtBQ,EAAA,CACbN,cACAC,kBACAC,qBCdWK,GAAQ,CACnBC,QAAS,UACTC,QAAS,+BCCEC,GAASZ,uBAAa,cACtBa,GAAeb,uBAAa,oBAC5Bc,GAAcd,uBAAa,mBAC3Be,GAAef,uBAAa,oBAC5BgB,GAAchB,uBAAa,mBAC3BiB,GAAajB,uBAAa,kBAC1BkB,GAAiBlB,uBAAa,sBAC9BmB,GAAenB,uBAAa,oBAC5BoB,GAAepB,uBAAa,oBAE5BqB,GAAmBC,4BAAkB,uBAAwB,kBAAM,SAACC,EAAUC,GACzF,IADsGC,EACxFD,IACmCE,UAA7B/B,EAFkF8B,EAE9FE,WAAwBC,EAFsEH,EAE7EI,MACnBC,EAAS,mHAAA9E,OAAsH2C,EAAtH,KAEfoC,KAAMC,IAAN,yCAAAhF,OAAmD8E,IAChDG,KAAK,SAACC,GACL,IAAMC,EAAUpG,KAAKsB,MAAM6E,EAAOtG,KAAKwG,KAAK,GAAGC,UAEzCC,EADS/G,OAAOgH,EAAEC,QAAQL,GAASM,YACrBC,eAAeC,MAAM,KAAKvG,IAAI,SAAAwG,GAAC,OAAIC,WAAWD,KAClErB,EAASV,GAAa,CAAEyB,OAAMQ,QAAS,CACrCC,eAAgB,CAACnB,EAAQ,YAKlBoB,GAAA,CACbpC,UACAC,gBACAC,eACAG,cACAF,gBACAC,eACAE,kBACAC,gBACAC,gBACAC,yFCvCI4B,GAAY,SAAA/D,GAAA,IAAGgE,EAAHhE,EAAGgE,GAAIC,EAAPjE,EAAOiE,KAAMC,EAAblE,EAAakE,WAAb,OAA8B5G,OAAO6G,OAAO,GAAI,CAAEH,KAAIC,QAAQC,IAE1EE,GAAiB,SAAAC,GAA4C,IAAzCL,EAAyCK,EAAzCL,GAAIC,EAAqCI,EAArCJ,KAAMC,EAA+BG,EAA/BH,WAAcN,EAAiBjD,UAAAV,OAAA,QAAAW,IAAAD,UAAA,GAAAA,UAAA,GAAP,GACpD2D,EAAIhH,OAAO6G,OAAO,GAAI,CAAEH,KAAIC,QAAQC,GAqB1C,OAnBI5G,OAAOiH,UAAUC,eAAeC,KAAKH,EAAG,YAAWA,EAAEI,OAASJ,EAAEI,OAAOxH,IAAI6G,KAC3EzG,OAAOiH,UAAUC,eAAeC,KAAKH,EAAG,WAAUA,EAAEK,MAAQL,EAAEK,MAAMzH,IAAI6G,KACxEzG,OAAOiH,UAAUC,eAAeC,KAAKH,EAAG,cAC1CA,EAAEM,SAAWN,EAAEM,SAAS1H,IAAI6G,IAExBH,EAAQiB,SACVP,EAAEM,SAAWN,EAAEM,SAASE,KAAK,SAAAC,GAAC,OAAIA,EAAEC,WAAapB,EAAQiB,UAAW,KAGpEvH,OAAOiH,UAAUC,eAAeC,KAAKH,EAAG,gBAAeA,EAAEW,WAAaX,EAAEW,WAAW/H,IAAI6G,KACvFzG,OAAOiH,UAAUC,eAAeC,KAAKH,EAAG,iBAC1ChH,OAAOiH,UAAUC,eAAeC,KAAKH,EAAEY,aAAc,WACrDZ,EAAEY,aAAaC,MAAQb,EAAEY,aAAaC,MAAMjI,IAAI,SAACkI,EAAMrF,GACrD,IAAMsF,EAAI/H,OAAO6G,OAAO,GAAIiB,GAE5B,OADAC,EAAErB,GAAKqB,EAAErB,IAAMjE,EACRsF,KAIJf,GAQMgB,GALiB,SAAAC,GAA4B,IAAzB7I,EAAyB6I,EAAzB7I,KAAQkH,EAAiBjD,UAAAV,OAAA,QAAAW,IAAAD,UAAA,GAAAA,UAAA,GAAP,GACnD,OAAIjE,GAAQ8I,MAAMC,QAAQ/I,GAAcA,EAAKQ,IAAI,SAAAoH,GAAC,OAAIF,GAAeE,EAAGV,KACjEQ,GAAe1H,EAAMkH,IC6Bf8B,sBAlDR,SAAwBC,EAAYC,GAAqB,IAAhBC,EAAgBlF,UAAAV,OAAA,QAAAW,IAAAD,UAAA,GAAAA,UAAA,GAAR,SAAAmF,GAAC,OAAIA,GAErDC,EAAQ,CACZ9F,OAAQ,EACR+F,IAAK,KACLC,IAAK,KACLC,IAAK,MAGP,OAAOP,EAAW/F,OAAO,SAACC,EAAK1C,GAC7B,IAAMgJ,EAASrD,KAAI3F,EAAKyI,GAClBQ,EAAWP,EAAM1I,GAIvB,OAFsB,QAARyI,EAAiBzI,EAAIkJ,QAAUlJ,EAAImJ,WAM7CnJ,EAAI+C,QACN6F,EAAM9F,SACN8F,EAAMC,KAAO7I,EAAI+C,MAEZ6F,EAAMG,IAGL/I,EAAI+C,MAAQ6F,EAAMG,MACpBH,EAAMG,IAAM/I,EAAI+C,OAHlB6F,EAAMG,IAAM/I,EAAI+C,MAOb6F,EAAME,IAGL9I,EAAI+C,MAAQ6F,EAAME,MACpBF,EAAME,IAAM9I,EAAI+C,OAHlB6F,EAAME,IAAM9I,EAAI+C,OAQhBL,EAAIsG,GACNtG,EAAIsG,GAAQI,KAAKH,GAEjBvG,EAAIsG,GAAU,CAACC,GAGVvG,GA9BEA,GA+BR,CAAE2G,OAAQT,KCmDAtJ,GADQ,eA/FrB,SAAAgK,IAAenJ,OAAAoJ,EAAA,EAAApJ,CAAAP,KAAA0J,GACb1J,KAAK4J,OAAS9D,KAAM+D,OAAO,CACzBC,QAASzI,+CACT0I,QAAS,CAAEC,eAAgB,yFAIR/C,GAAiB,IAAbgD,EAAarG,UAAAV,OAAA,QAAAW,IAAAD,UAAA,GAAAA,UAAA,GAAJ,GAClC,OAAO5D,KAAK4J,OAAO7D,IAAZ,YAAAhF,OAA4BkG,EAA5B,UAAwC,CAAEgD,WAC9CjE,KAAK,SAAAkE,GAAY,IACRC,EAA6BD,EAA7BC,OAAQC,EAAqBF,EAArBE,WAAYzK,EAASuK,EAATvK,KAC5B,GAAIwK,GAAU,IAAK,MAAM,IAAIE,MAAMD,GACnC,OAAOE,GAAW3K,iDAIJ4K,GAAU,IAAAC,EAAAxK,KAAAyK,EAGclK,OAAOI,QAAQ4J,GAAU1H,OAAO,SAACC,EAAKuF,GAAN,MAAe,IAAAtH,OAAAR,OAAAmK,GAAA,EAAAnK,CACnFuC,EAAI,IAD+E,CAC3EuF,EAAK,KADsE,GAAAtH,OAAAR,OAAAmK,GAAA,EAAAnK,CAEnFuC,EAAI,IAF+E,CAE3E0H,EAAKG,uBAAuBtC,EAAK,QAC5C,CAAC,GAAI,KANoBuC,EAAArK,OAAAsK,GAAA,EAAAtK,CAAAkK,EAAA,GAGpBK,EAHoBF,EAAA,GAGNG,EAHMH,EAAA,GAQ5B,OAAO9E,KAAMkF,IAAID,GACd/E,KAAK,SAAAkE,GACJ,OAAOY,EAAajI,OAAO,SAACC,EAAKxB,EAAM0B,GAAZ,OAAAzC,OAAAE,EAAA,EAAAF,CAAA,GACtBuC,EADsBvC,OAAA+C,EAAA,EAAA/C,CAAA,GAExBe,EAAO4I,EAASlH,MACf,kDAcU6D,GAAS,IAAAoE,EAAAjL,KACrBkL,EAAWnF,KAAIc,EAAS,YAAa,MACrCsE,EAAepF,KAAIc,EAAS,gBAAiB,MAC7CoD,EAASlE,KAAIc,EAAS,SAAU,IAEtC,GAAIqE,GAAYC,EACd,OAAOnL,KAAK4J,OAAL,WAAA7I,OAAuBmK,GAAYjB,GACvCjE,KAAK,SAAAkE,GAAY,IACRC,EAA6BD,EAA7BC,OAAQC,EAAqBF,EAArBE,WAAYzK,EAASuK,EAATvK,KAC5B,GAAIwK,GAAU,IAAK,MAAM,IAAIE,MAAMD,GACnC,OAAOE,GAAW3K,KAEnBqG,KAAK,SAAAoF,GACJ,IAAMC,EAAMJ,EAAKK,kBAAkBF,EAAYD,GAC/C,OAAOrF,KAAMC,IAAIsF,KAElBrF,KAAK,SAAAkE,GAAY,IACRC,EAA6BD,EAA7BC,OAAQC,EAAqBF,EAArBE,WAAYzK,EAASuK,EAATvK,KAC5B,GAAIwK,GAAU,IAAK,MAAM,IAAIE,MAAMD,GACnC,OAAOzB,GAAehJ,EAAKwG,KAAMU,EAAQ0E,SAAU,SAAAnL,GAAG,MAAK,CACzDkJ,QAA+B,QAArBzC,EAAQ0E,SAAsBnL,EAAIkJ,QAAUlJ,EAAImJ,SAC1D3G,SAAUxC,EAAIoL,OACdrI,MAAO/C,EAAI+C,MACXK,KAAMpD,EAAIqL,kBAKlB,MAAM,IAAIpB,MAAM9H,EAAOE,6EAWP2I,EAAYD,GAAc,IAAAO,EACIN,EAAWO,aAAjDhM,EADkC+L,EAClC/L,KACR,OAF0C+L,EAC5BE,cACM/I,OAAO,SAACC,EAAK+I,GAAU,IACjChD,EAAQgD,EAARhD,IACR,GAAIgD,EAAMC,WAAaX,EAAatC,GAClC,MAAM,IAAIwB,MAAM9H,EAAOC,4BAGzB,OAAOM,EAAIiJ,QAAJ,KAAAhL,OAAiB8H,EAAjB,UAAA9H,OAA8BoK,EAAatC,GAA3C,OACNlJ,EAAK,GAAG0L,eCnFFW,GAAmBjI,uBAAa,yBAU/BkI,GAAoB5G,4BAAkB,yBAA0B,kBAAM,SAACC,EAAU4G,GAAU,IAAAjJ,EACpFiJ,IAAXC,OAC8BC,OAAS,GAAvC9C,EAF+FrG,EAE/FqG,QAASvG,EAFsFE,EAEtFF,UAEjBuC,EAASlC,MAELL,GACFuC,EAASnB,EAAkB,CAACxE,KAAMoD,KAGpCuC,EAAS+G,MAAoBrG,KAAK,SAAArG,GAChC,IAAM2M,EAAmB/L,OAAOI,QAAQhB,GACrCgD,OAAO,SAAA9B,GAAK,MAAiB,WAAbA,EAAM,KACtBV,IAAI,SAAAU,GAAK,OAAI4C,EAAgB5C,EAAM,GAAIA,EAAM,MAE5CyI,EACFhE,EAASiH,GAAW,CAAC5M,KAAM2J,EAAQkD,kBAEnClH,EAASjB,EAAe,CAAC1E,KAAMA,EAAK8J,UACpCnE,EAASlB,EAAc,CAACzE,KAAM2M,WAKvBlJ,GAAgBiC,4BAAkB,qBAAsB,kBAAM,SAAAC,GAEzEA,EAAStB,EAAc,CAACrE,KAAMiC,KAC9B0D,EAASnB,EAAkB,CAACxE,KAAMiC,EAAW,GAAGE,YAGrCuK,GAAmBhH,4BAAkB,wBAAyB,iCAAAiC,EAAA/G,OAAAkM,GAAA,EAAAlM,CAAAmM,GAAAC,EAAAC,KAAM,SAAAC,EAAOvH,EAAU4G,GAAjB,IAAAzG,EAAA1C,EAAA8D,EAAA,OAAA6F,GAAAC,EAAAG,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,UACzExH,EAAYyG,IAAQzG,UACG1C,EAAe0C,EAApCpF,WAAcyB,MAFyD,CAAAiL,EAAAE,KAAA,eAAAF,EAAAG,OAAA,wBAMzErG,EAAU,CACdc,OAAQ,CACNV,GAAI,uCACJgD,OAAQ,CAAElH,cAEZwI,SAAU,OAXmEwB,EAAAE,KAAA,EAclEvD,GAAWyD,oBAAoBtG,GAC3Cb,KAAK,SAAAoH,GACJ,IAAMC,EAAY9M,OAAOI,QAAQyM,GAC9BzK,OAAO,SAAA9B,GAAK,MAAiB,WAAbA,EAAM,KACtBV,IACC,SAAAmJ,GAAO,MAAK,CACVzH,MAAOyH,EAAQ,GAAG,GAAGA,QACrBxH,MAAOwH,EAAQ,MAEjBgE,KAAK,SAACX,EAAEhG,GACR,OAAIgG,EAAE9K,OAAS8E,EAAE9E,MACR8K,EAAE9K,MAAM0L,cAAc5G,EAAE9E,QAGzB,IAMZ,OAHAyD,EAASxB,EAAa,CAACnE,KAAM0N,KAE7B/H,EAAS0G,GAAiB,CAACrM,KAAMyN,KAC1BA,IAlCsE,cAAAL,EAAAG,OAAA,SAAAH,EAAAS,MAAA,wBAAAT,EAAAU,SAAAZ,MAAN,gBAAAa,EAAAC,GAAA,OAAArG,EAAAsG,MAAA5N,KAAA4D,YAAA,KAsC9DiK,GAAmBxI,4BAAkB,wBAAyB,iCAAAmD,EAAAjI,OAAAkM,GAAA,EAAAlM,CAAAmM,GAAAC,EAAAC,KAAM,SAAAkB,EAAOxI,EAAU4G,GAAjB,IAAAzG,EAAAC,EAAA3C,EAAA8D,EAAA,OAAA6F,GAAAC,EAAAG,KAAA,SAAAiB,GAAA,cAAAA,EAAAf,KAAAe,EAAAd,MAAA,UACzExH,EAAYyG,IAAQzG,UAClBC,EAAgDD,EAAhDC,WAAiC3C,EAAe0C,EAApCpF,WAAcyB,MAF6C,CAAAiM,EAAAd,KAAA,eAAAc,EAAAb,OAAA,wBAMzErG,EAAU,CACdc,OAAQ,CACNV,GAAI,uCACJgD,OAAQ,CAAElH,YAAWW,IAAKgC,IAE5B6F,SAAU,YAXmEwC,EAAAd,KAAA,EAclEvD,GAAWyD,oBAAoBtG,GAdmC,cAAAkH,EAAAb,OAAA,SAAAa,EAAAP,MAAA,wBAAAO,EAAAN,SAAAK,MAAN,gBAAAE,EAAAC,GAAA,OAAAzF,EAAAoF,MAAA5N,KAAA4D,YAAA,KAmB5DsK,GAAA,CACb9K,iBACAiJ,oBACAwB,qBCpGWM,GAAwBpK,uBAAa,6BACrCqK,GAAgBrK,uBAAa,qBAE7BwI,GAAalH,4BAAkB,iBAAkB,SAAAgJ,GAAO,OAAI,SAAA/I,GACvEA,EAASrB,EAAYoK,IACrB/I,EAASpB,EAAgBmK,IACzB/I,EAASgJ,GAAO,CAACrE,OAAQ,CAACX,QAAS+E,EAAQ1O,SAC3C2F,EAASF,GAAiBiJ,EAAQ1O,OAElC,IAAM4O,EAAWF,EAAQ1O,KAAQkO,GAAmBxB,GAEpD/G,EAASiJ,KAAWvI,KAAK,SAAArG,GACvB,IAAMyL,EAAa7K,OAAOI,QAAQhB,GAC/BgD,OAAO,SAAA9B,GAAK,MAAiB,WAAbA,EAAM,KACtBV,IAAI,SAAAU,GAAK,OAAI4C,EAAgB5C,EAAM,GAAIA,EAAM,MAEhDyE,EAASjB,EAAe,CAAC1E,KAAMA,EAAK8J,UACpCnE,EAASlB,EAAc,CAACzE,KAAMyL,OAG3BiD,EAAQ1O,MACX2F,EAASV,GAAa,CAACyB,KAAM,EAAE,IAAK,GAAI,KAAM,UAIrCmI,GAAenJ,4BAAkB,mBAAoB,SAAAgJ,GAAO,OAAI,SAAC/I,EAAU4G,GACtF5G,EAASnB,EAAkBkK,IAC3B/I,EAASgJ,GAAO,CAACrE,OAAQ,CAAClH,UAAWsL,EAAQ1O,SAFmD,IAI7E8O,EAAUvC,IAAtBzG,UAAYgJ,MAGnBnJ,GAFiBmJ,IAAUjK,GAAME,QAAYmJ,GAAmBxB,OAE5CrG,KAAK,SAAArG,GACvB,IAAMyL,EAAa7K,OAAOI,QAAQhB,GAC/BgD,OAAO,SAAA9B,GAAK,MAAiB,WAAbA,EAAM,KACtBV,IAAI,SAAAU,GAAK,OAAI4C,EAAgB5C,EAAM,GAAIA,EAAM,MAEhDyE,EAASjB,EAAe,CAAC1E,KAAMA,EAAK8J,UACpCnE,EAASlB,EAAc,CAACzE,KAAMyL,UAIrBkD,GAASjJ,4BAAkB,eAAgB,SAAApC,GAAA,IAAGgH,EAAHhH,EAAGgH,OAAQ8B,EAAX9I,EAAW8I,QAAX,OAAyB,SAACzG,EAAU4G,GAAU,IAAAwC,EAClExC,IAA1BC,OAASjF,EADmFwH,EACnFxH,KAAMkF,EAD6EsC,EAC7EtC,MAEjBuC,EAAW5C,EAAOxL,OAAAE,EAAA,EAAAF,CAAA,GAChB0J,GADgB1J,OAAAE,EAAA,EAAAF,CAAA,GAEhB6L,EAAUnC,GAIlB3E,EAAS,CACP4B,OACAkF,MAJiB7L,OAAOG,YAAYH,OAAOI,QAAQgO,GAAUhM,OAAO,SAAA9B,GAAK,OAAIxB,QAAQwB,EAAM,YAQlF+N,GAAWvJ,4BAAkB,eAAgB,kBAAM,WAC9DwJ,EAAcC,kBC1DDC,IAZCC,GAAA,GAAAzO,OAAA+C,EAAA,EAAA/C,CAAAyO,GACbzC,GAAa,SAACL,EAADjJ,GAAA,IAAUoL,EAAVpL,EAAUoL,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GACT2L,EADS,CACF5C,QAAS+E,EAAQvM,UAFfvB,OAAA+C,EAAA,EAAA/C,CAAAyO,GAIbb,GAAwB,SAACjC,EAAD5E,GAAA,IAAU+G,EAAV/G,EAAU+G,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GACpB2L,EADoB,CACb+C,qBAAsB5P,QAAQgP,OAL5B9N,OAAA+C,EAAA,EAAA/C,CAAAyO,GAObZ,GAAgB,SAAClC,EAAD1D,GAAA,IAAU6F,EAAV7F,EAAU6F,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GACZ2L,EADY,CACLgD,YAAa7P,QAAQgP,OARnBW,ICNDG,GAAA,CACbF,sBAAsB,EACtBC,aAAa,GCAfE,IAAAC,GAAA,GAAA9O,OAAA+C,EAAA,EAAA/C,CAAA8O,GACG9K,GAA2B,SAAC2H,EAADjJ,GAAA,IAAqBtD,EAArBsD,EAAUoL,QAAW1O,KAArB,OAAAY,OAAAE,EAAA,EAAAF,CAAA,GAAwC2L,EAAxC,CAA+CmB,UAAU9M,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAMmB,UAAZ,CAAuB1N,aAD7GY,OAAA+C,EAAA,EAAA/C,CAAA8O,GAGE,4BAA6B,SAAAnD,GAAK,OAAA3L,OAAAE,EAAA,EAAAF,CAAA,GAAW2L,EAAX,CAAkBmB,UAAU9M,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAMmB,UAAZ,CAAuBiC,WAAW,QAHjG/O,OAAA+C,EAAA,EAAA/C,CAAA8O,GAIE,8BAA+B,SAAAnD,GAAK,OAAA3L,OAAAE,EAAA,EAAAF,CAAA,GAAW2L,EAAX,CAAkBmB,UAAU9M,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAMmB,UAAZ,CAAuBiC,WAAW,EAAOC,UAAU,QAJpHhP,OAAA+C,EAAA,EAAA/C,CAAA8O,GAKE,6BAA8B,SAAAnD,GAAK,OAAA3L,OAAAE,EAAA,EAAAF,CAAA,GAAW2L,EAAX,CAAkB7L,WAAWE,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAM7L,WAAZ,CAAwBiP,WAAW,QALpG/O,OAAA+C,EAAA,EAAA/C,CAAA8O,GAME,+BAAgC,SAAAnD,GAAK,OAAA3L,OAAAE,EAAA,EAAAF,CAAA,GAAW2L,EAAX,CAAkB7L,WAAWE,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAM7L,WAAZ,CAAwBiP,WAAW,EAAOC,UAAU,QANvHhP,OAAA+C,EAAA,EAAA/C,CAAA8O,GAOE,6BAA8B,SAAAnD,GAAK,OAAA3L,OAAAE,EAAA,EAAAF,CAAA,GAAW2L,EAAX,CAAkBvE,OAAOpH,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAMvE,OAAZ,CAAoB2H,WAAW,QAP5F/O,OAAA+C,EAAA,EAAA/C,CAAA8O,GAQE,+BAAgC,SAAAnD,GAAK,OAAA3L,OAAAE,EAAA,EAAAF,CAAA,GAAW2L,EAAX,CAAkBvE,OAAOpH,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAMvE,OAAZ,CAAoB2H,WAAW,EAAOC,UAAU,QAR/GF,ICFeG,GAAA,CACbnC,UAAW,CACT1N,KAAM,KACN2P,WAAW,EACXC,UAAU,EACVE,MAAO,MAETC,UAAW,CACTC,MAAO,GACPhQ,KAAM,KACN2P,WAAW,EACXC,UAAU,EACVE,MAAO,MAETpP,WAAY,CACVV,KAAM,KACN2P,WAAW,EACXC,UAAU,EACVE,MAAO,gBChBEG,GAAQ,CACnB,CACEtO,KAAM,OACNuO,KAAM,qBACNC,KAAM,QAER,CACExO,KAAMyO,aACNF,KAAM,OACNC,KAAM,cCPGE,GDWEJ,GCXkB/M,OAC/B,SAACC,EAAKgN,GAAN,OAAAvP,OAAAE,EAAA,EAAAF,CAAA,GAAqBuC,EAArBvC,OAAA+C,EAAA,EAAA/C,CAAA,GAA2BuP,EAAKxO,KAAOyC,uBAAY,SAAAhD,OAAU+O,EAAKxO,UAClE,IAEW2O,GAAUlM,uBAAa,iBCArBgL,GALIxO,OAAOU,KAAK+O,IAAanN,OAC1C,SAACC,EAAK+F,GAAN,OAAAtI,OAAAE,EAAA,EAAAF,CAAA,GAAoBuC,EAApBvC,OAAA+C,EAAA,EAAA/C,CAAA,GAA0BsI,EAFL,SAAAA,GAAG,OAAI,SAACqD,EAADjJ,GAAA,IAAUoL,EAAVpL,EAAUoL,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAA9B,CAAqCgE,QAASrH,EAAKwF,aAE/C8B,CAAetH,MAC/C,ICLauH,GAAA,CACbF,QAAS,cCCXG,IAAAC,GAAA,GAAA/P,OAAA+C,EAAA,EAAA/C,CAAA+P,GACG/L,GAAiB,SAAC2H,EAADjJ,GAAA,IAAUoL,EAAVpL,EAAUoL,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAAUmC,KAD5D9N,OAAA+C,EAAA,EAAA/C,CAAA+P,GAEG/L,GAAuB,SAAC2H,EAAD5E,GAAA,IAAU+G,EAAV/G,EAAU+G,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAA9B,CAAqCqE,OAAQlC,MAFvE9N,OAAA+C,EAAA,EAAA/C,CAAA+P,GAGG/L,GAAqB,SAAC2H,EAAD1D,GAAA,IAAU6F,EAAV7F,EAAU6F,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAA9B,CAAqCsE,QAASnC,MAHtE9N,OAAA+C,EAAA,EAAA/C,CAAA+P,GAIG/L,GAAsB,SAAC2H,EAADuE,GAAA,IAAUpC,EAAVoC,EAAUpC,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAA9B,CAAqCwE,SAAUrC,MAJxE9N,OAAA+C,EAAA,EAAA/C,CAAA+P,GAKG/L,GAAuB,SAAC2H,EAADyE,GAAA,IAAUtC,EAAVsC,EAAUtC,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAA9B,CAAqC0E,UAAWvC,MAL1E9N,OAAA+C,EAAA,EAAA/C,CAAA+P,GAMG/L,GAAsB,SAAC2H,EAAD2E,GAAA,IAAUxC,EAAVwC,EAAUxC,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAA9B,CAAqC4E,SAAUzC,MANxE9N,OAAA+C,EAAA,EAAA/C,CAAA+P,GAOG/L,GAAyB,SAAC2H,EAAD6E,GAAA,IAAU1C,EAAV0C,EAAU1C,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAA9B,CAAqC8E,SAAU3C,MAP3E9N,OAAA+C,EAAA,EAAA/C,CAAA+P,GAQG/L,GAAuB,SAAC2H,EAAD+E,GAAA,IAAU5C,EAAV4C,EAAU5C,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAA9B,CAAqCgF,SAAU,CAAE3B,SAAUlB,OARrF9N,OAAA+C,EAAA,EAAA/C,CAAA+P,GASG/L,GAAuB,SAAC2H,EAADiF,GAAA,IAAU9C,EAAV8C,EAAU9C,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GAA8B2L,EAA9B,CAAqCgF,SAAU,CAAEE,SAAU/C,OATrFiC,ICFee,GAAA,CACbL,SAAU,CACRM,KAAM,EACNC,SAAU,mBACVC,WAAY,kBAEdhB,QAAS,SCHEiB,GAAU1N,uBAAa,kBACvB2N,GAAa3N,uBAAa,qBAC1B4N,GAAW5N,uBAAa,mBACxB6N,GAAmB7N,uBAAa,2BAChC8N,GAAYxM,4BAAkB,mBAAoB,kBAAM,SAAAC,GACnEA,EAASoM,IAAW,IACpBpM,EAASqM,GAAS,OAOlB,OAAOjI,GAAWoI,oBALD,CACfC,iBAAkB,uCAClBC,kBAAmB,yCAIlBhM,KAAK,SAAAiM,GACJ3M,EAASmM,GAAQQ,IACjB3M,EAASoM,IAAW,MAErBQ,MAAM,SAACC,GACN7M,EAASqM,GAASQ,IAClB7M,EAASoM,IAAW,SAIXU,GAAA,CACbX,WACAC,cACAC,YACAE,aACAD,qBCzBFS,IAAAC,GAAA,GAAA/R,OAAA+C,EAAA,EAAA/C,CAAA+R,GACGb,GAAU,SAACvF,EAADjJ,GAAA,IAAUoL,EAAVpL,EAAUoL,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GACN2L,EADM,CACCqG,KAAMlE,MAFpB9N,OAAA+C,EAAA,EAAA/C,CAAA+R,GAIGZ,GAAa,SAACxF,EAAD5E,GAAA,IAAU+G,EAAV/G,EAAU+G,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GACT2L,EADS,CACFoD,UAAWjQ,QAAQgP,OALjC9N,OAAA+C,EAAA,EAAA/C,CAAA+R,GAOGX,GAAW,SAACzF,EAAD1D,GAAA,IAAU6F,EAAV7F,EAAU6F,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GACP2L,EADO,CACAuD,MAAOpB,MARrB9N,OAAA+C,EAAA,EAAA/C,CAAA+R,GAUGV,GAAmB,SAAC1F,EAADuE,GAAA,IAAUpC,EAAVoC,EAAUpC,QAAV,OAAA9N,OAAAE,EAAA,EAAAF,CAAA,GACf2L,EADe,CAElBqG,KAAM,CACJR,iBAAkB7F,EAAMqG,KAAKR,iBAAiB5R,IAAI,SAAAqS,GAAC,OAAAjS,OAAAE,EAAA,EAAAF,CAAA,GAAUiS,EAAV,CAAaC,QAASpE,MACzE2D,kBAAmB9F,EAAMqG,KAAKP,kBAAkB7R,IAAI,SAAAqS,GAAC,OAAAjS,OAAAE,EAAA,EAAAF,CAAA,GAAUiS,EAAV,CAAaC,QAASpE,WAdjFiE,ICPeI,GAAA,CACbH,KAAM,KACNjD,WAAW,EACXC,UAAU,EACVE,MAAO,MCATkD,IAAAC,GAAA,GAAArS,OAAA+C,EAAA,EAAA/C,CAAAqS,GACGrO,EAAuB,SAAC2H,EAADjJ,GAAA,IAAqBtD,EAArBsD,EAAUoL,QAAW1O,KAArB,OAAAY,OAAAE,EAAA,EAAAF,CAAA,GAAuC2L,EAAvC,CAA8CmB,UAAU9M,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAMmB,UAAZ,CAAuBkF,KAAM5S,QAD9GY,OAAA+C,EAAA,EAAA/C,CAAAqS,GAEGrO,EAAwB,SAAC2H,EAAD5E,GAAA,IAAqB3H,EAArB2H,EAAU+G,QAAW1O,KAArB,OAAAY,OAAAE,EAAA,EAAAF,CAAA,GAAwC2L,EAAxC,CAA+C7L,WAAWE,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAM7L,WAAZ,CAAwBkS,KAAM5S,QAFlHY,OAAA+C,EAAA,EAAA/C,CAAAqS,GAGGrO,EAAsB,SAAC2H,EAAD1D,GAAA,IAAqB7I,EAArB6I,EAAU6F,QAAW1O,KAArB,OAAAY,OAAAE,EAAA,EAAAF,CAAA,GAClB2L,EADkB,CAErBxG,WAAY/F,EACZ8O,MAAO9O,EAAO6E,GAAME,QAAUF,GAAMC,YANxClE,OAAA+C,EAAA,EAAA/C,CAAAqS,GAQGrO,EAA0B,SAAC2H,EAADuE,GAAA,IAAqB9Q,EAArB8Q,EAAUpC,QAAW1O,KAArB,OAAAY,OAAAE,EAAA,EAAAF,CAAA,GAAwC2L,EAAxC,CAA+CmB,UAAU9M,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAMmB,UAAZ,CAAuBvL,MAAOnC,QARnHY,OAAA+C,EAAA,EAAA/C,CAAAqS,GASGrO,EAA4B,SAAC2H,EAADyE,GAAA,IAAqBhR,EAArBgR,EAAUtC,QAAW1O,KAArB,OAAAY,OAAAE,EAAA,EAAAF,CAAA,GAAwC2L,EAAxC,CAA+C7L,WAAWE,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAM7L,WAAZ,CAAwByB,MAAOnC,QATvHY,OAAA+C,EAAA,EAAA/C,CAAAqS,GAUGrO,EAAwB,SAAC2H,EAAD2E,GAAA,IAAqBlR,EAArBkR,EAAUxC,QAAW1O,KAArB,OAAAY,OAAAE,EAAA,EAAAF,CAAA,GAAwC2L,EAAxC,CAA+CvE,OAAOpH,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAMvE,OAAZ,CAAoBhI,aAVpGY,OAAA+C,EAAA,EAAA/C,CAAAqS,GAWGrO,EAAyB,SAAC2H,EAAD6E,GAAA,IAA2B/H,EAA3B+H,EAAU1C,QAAW1O,KAArB,OAAAY,OAAAE,EAAA,EAAAF,CAAA,GAA+C2L,EAA/C,CAAsDvE,OAAOpH,OAAAE,EAAA,EAAAF,CAAA,GAAK2L,EAAMvE,OAAZ,CAAoBqB,cAX5GzI,OAAA+C,EAAA,EAAA/C,CAAAqS,GAYGrO,EAAmB,SAAC2H,EAAD+E,GAAA,IAAqBtR,EAArBsR,EAAU5C,QAAW1O,KAArB,OAAAY,OAAAE,EAAA,EAAAF,CAAA,GAAwC2L,EAAxC,CAA+CtG,MAAOjG,MAZ5EiT,ICFeC,GAAA,CACbpE,MAAOjK,GAAMC,QACbiB,WAAY,KACZE,MAAO,KACPyH,UAAW,CACTkF,KAAM,GACNzQ,MAAO,MAETzB,WAAY,CACVkS,KAAM,GACNzQ,MAAO,MAET6F,OAAQ,CACNhI,KAAM,0BCVJmT,GAASlD,GAAM/M,OAAO,SAACC,EAAKgN,GAAN,OAAAvP,OAAAE,EAAA,EAAAF,CAAA,GACvBuC,EADuBvC,OAAA+C,EAAA,EAAA/C,CAAA,GAEzBuP,EAAKxO,KAFoBf,OAAAE,EAAA,EAAAF,CAAA,CAGxBsP,KAAMC,EAAKD,MACR,CAAEkD,MAAOjD,EAAKiD,WAEjB,IAEElM,GAAU,CACdmM,SAAU3R,IACV9B,SAAU,SACV0T,aAAY,GAAAlS,OAAKM,IAAL,OACZ6R,iBAAiB,EACjBC,gBAAiBC,MAGJC,4BAAcP,GAAQjM,ICR/ByM,GAAU,CACd,CAAEC,UAAW,MAAOC,WAAYC,GAChC,CAAEF,UAAW,OAAQC,WAAY7T,GACjC,CAAE4T,UAAW,OAAQC,WAAYE,GACjC,CAAEH,UAAW,MAAOC,WAAYrT,GAChC,CAAEoT,UAAW,SAAUC,WAAYvB,GACnC,CAAEsB,UAAW,YAAaC,WAAY/N,IAItCyN,GAIE/G,GAJF+G,gBACSS,GAGPxH,GAHFyH,QACYC,GAEV1H,GAFF2H,WACUC,GACR5H,GADF6H,SAGIC,GAAWC,0BAAgB3T,OAAAE,EAAA,EAAAF,CAAA,CAC/B4L,OAAQwH,IACLL,GAAQzQ,OACT,SAACC,EAAKqR,GAAN,OAAA5T,OAAAE,EAAA,EAAAF,CAAA,GAAuBuC,EAAvBvC,OAAA+C,EAAA,EAAA/C,CAAA,GAA6B4T,EAAOZ,UAAYa,uBAAaD,EAAOX,eACpE,MAIEM,GAAaO,0BAAiBR,GAAkBS,KAEhDC,GAAYC,8BAAoBT,GAAgBD,IAEhDW,GAAQC,sBAAYT,GAAUM,IAEpCrB,KAEeuB,UCrCAE,eAJS,SAAAzI,GAAK,MAAK,IAEP,GAEZyI,CAA6CC,kECFvCC,eAEnB,SAAAA,EAAYC,GAAO,IAAAtK,EAAA,OAAAjK,OAAAoJ,EAAA,EAAApJ,CAAAP,KAAA6U,IACjBrK,EAAAjK,OAAAwU,GAAA,EAAAxU,CAAAP,KAAAO,OAAAyU,GAAA,EAAAzU,CAAAsU,GAAAnN,KAAA1H,KAAM8U,KAED5I,MAAQ,CACX+I,QAAQ,GAJOzK,qFASjBxK,KAAK8U,MAAMI,YAAY5V,OAAOC,SAAS4V,kDAIrB,IAAAlK,EAAAjL,KAClBA,KAAKoV,UAAY,IAAIC,KAAUrV,KAAKsV,KACpCtV,KAAKoV,UAAUG,GAAG,UAAW,SAACC,GAC5BvK,EAAKwK,SAAS,CAAER,QAAQ,IACxBS,WAAW,WACTzK,EAAKwK,SAAS,CAAER,QAAQ,IACxBO,EAAEG,kBACD,OAGL3V,KAAKoV,UAAUG,GAAG,QAAS,WACzBtK,EAAKwK,SAAS,CAAEhG,OAAO,IACvBiG,WAAW,WACTzK,EAAKwK,SAAS,CAAEhG,OAAO,KACtB,4CAKM+F,GACXA,GAAKA,EAAEI,iBACP,IAEMC,GAAQvW,OAAOwW,WAFP,KAE6B,EACrCC,GAAOzW,OAAO0W,YAFL,KAE6B,EAEtC3K,EAAMmK,EAAES,cAAcd,KACtB7U,EAAI,kBAAAS,OANI,IAMJ,YAAAA,OALK,IAKL,SAAAA,OAAmDgV,EAAnD,UAAAhV,OAA+D8U,GAEzEvW,OAAO4W,KAAK7K,EAAK,sBAAuB/K,oCAGjC,IAAA6V,EAAAnW,KACDoW,EAAQ,mCACR/K,EAAMrL,KAAK8U,MAAMuB,MAAMhL,KAAO/L,OAAOC,SAAS4V,KAC9CmB,EAAazW,mBAAmBG,KAAK8U,MAAMuB,MAAMhL,KAAO/L,OAAOC,SAAS4V,MAE1EoB,EAAO,OACPC,EAAY,GAWhB,OATIxW,KAAKkM,MAAM+I,SACbsB,EAAO,SACPC,EAAY,YAEVxW,KAAKkM,MAAMuD,QACb8G,EAAO,QACPC,EAAY,UAIZC,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,WACbD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,gBACbD,EAAA9J,EAAAlL,cAAA,MAAIiV,UAAU,eAAd,oBAEFD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,iBACbD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,gBACbD,EAAA9J,EAAAlL,cAAA,SACEwF,GAAG,MACHyP,UAAU,YACV5U,MAAOuJ,EACPsL,UAAQ,EACRC,QAAS,SAAApB,GAAC,OAAIA,EAAES,cAAcY,YAEhCJ,EAAA9J,EAAAlL,cAAA,UACEqV,wBAAsB,OACtBC,IAAK,SAACC,GAAWb,EAAKb,IAAM0B,GAC5BN,UAAS,kBAAA3V,OAAoByV,GAC7BtP,KAAK,UAEJqP,IAILE,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,gBACbD,EAAA9J,EAAAlL,cAAA,KACE0T,KAAI,iCAAApU,OAAmCuV,GACvCW,OAAO,SACPC,IAAI,sBACJR,UAAU,6CACVS,QAASnX,KAAKoX,cAEdX,EAAA9J,EAAAlL,cAAC4V,GAAA,KAAD,CAAM/V,KAAK,iBACXmV,EAAA9J,EAAAlL,cAAA,wBAEFgV,EAAA9J,EAAAlL,cAAA,KACE0T,KAAI,gDAAApU,OAAkDuV,EAAlD,OAAAvV,OAAkEqV,GACtEa,OAAO,SACPC,IAAI,sBACJR,UAAU,8CACVS,QAASnX,KAAKoX,cAEdX,EAAA9J,EAAAlL,cAAC4V,GAAA,KAAD,CAAM/V,KAAK,kBACXmV,EAAA9J,EAAAlL,cAAA,yBAEFgV,EAAA9J,EAAAlL,cAAA,KACE0T,KAAI,uDAAApU,OAAyDuV,EAAzD,WAAAvV,OAA6EqV,EAA7E,qBACJa,OAAO,SACPC,IAAI,sBACJR,UAAU,8CACVS,QAASnX,KAAKoX,cAEdX,EAAA9J,EAAAlL,cAAC4V,GAAA,KAAD,CAAM/V,KAAK,kBACXmV,EAAA9J,EAAAlL,cAAA,mCArH0B6V,IAAMC,WAmI9C1C,GAAW2C,aAAe,CACxBnB,MAAO,GACPnB,YAAa,SAAAnM,GAAC,OAAIA,iBCtIdsE,GAAYoK,aAAe,CADpB,SAAAvL,GAAK,OAAIA,EAAMvM,OACa,SAAA+X,GAAK,OAAIA,EAAMrK,UAAU1N,OAErDgY,GAAkBF,aAAe,CAJ5B,SAAAvL,GAAK,OAAIA,EAAMzG,YAI0B,SAAAmS,GAAU,OAAIA,EAAWlS,aAEvEmS,GAAiBJ,aAC5B,CAACE,GAAiBtK,IAClB,SAACyK,EAAkBC,GAAnB,OAAkCD,EAC9BrU,EAAgBqU,EAAkBC,EAAWD,IAC7C,OCRAE,GAAsB,CAC1BC,UAAW,SAAAC,GAAM,OAAA3X,OAAAE,EAAA,EAAAF,CAAA,GACZ2X,EADY,CAEfC,OAAQ,UAEVC,eAAgB,SAAAF,GAAM,OAAA3X,OAAAE,EAAA,EAAAF,CAAA,GACjB2X,EADiB,CAEpBC,OAAQ,OACRE,WAAY,WAIVC,GAAsB,kBAC1B7B,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,0BACbD,EAAA9J,EAAAlL,cAAC4V,GAAA,KAAD,CAAMX,UAAU,SAASpV,KAAK,kBAIlC,SAASiX,GAATtV,GAGG,IAFDoK,EAECpK,EAFDoK,UACAd,EACCtJ,EADDsJ,WAMA,OACEkK,EAAA9J,EAAAlL,cAAC+W,EAAA,aAAD,CACEC,MAAM,QACNC,YAAY,mBACZ7R,QAASwG,EAAUkF,KACnBoG,SATyB,SAACC,GAC5BrM,EAAW,CAAC5M,KAAMiZ,EAAO9W,SASvB+W,YAAY,qBACZX,OAAQF,GACRxE,WAAY,CAAE8E,wBACdxW,MAAOuL,EAAUvL,QAUvByW,GAAgBf,aAAe,CAC7BjL,WAAY,WACVuM,QAAQC,IAAI,gCAIDR,UC/CTS,GAAqB,CAAEzM,eAEdoI,eANS,SAAAzI,GAAK,MAAK,CAChCmB,UAAWnB,EAAMzG,UAAU4H,YAKW2L,GAAzBrE,CAA6C4D,yBCL5D,SAASU,GAAThW,GAIG,IAHD5C,EAGC4C,EAHD5C,WACAmO,EAECvL,EAFDuL,aACAkI,EACCzT,EADDyT,UAIA,OACED,EAAA9J,EAAAlL,cAAC+W,EAAA,MAAD,CACElX,KAAK,oBACLO,MAAM,8BACN6U,UAAU,WAEVD,EAAA9J,EAAAlL,cAAC+W,EAAA,aAAD,CACEC,MAAM,QACN5R,QAASxG,EAAWkS,KACpBoG,SAXyB,SAAAC,GAAM,OAAIpK,EAAa,CAAC7O,KAAMiZ,EAAO9W,SAY9D+W,YAAaK,KAAW,uBAAD3Y,OAAA+C,EAAA,EAAA/C,CAAA,GAA4BmW,EAAYrX,QAAQqX,KACvE5U,MAAOzB,EAAWyB,SAW1BmX,GAAkBzB,aAAe,CAC/BhJ,aAAc,WACZsK,QAAQC,IAAI,kCAIDE,UChCTD,GAAqB,CACzBxK,iBAGamG,eARS,SAAAzI,GAAK,MAAK,CAChC7L,WAAY6L,EAAMzG,UAAUpF,aAOU2Y,GAAzBrE,CAA6CsE,ICI7CE,GAZO,WACpB,OACE1C,EAAA9J,EAAAlL,cAAA,UAAQiV,UAAU,YAChBD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,mBACbD,EAAA9J,EAAAlL,cAAC2X,GAAD,MACA3C,EAAA9J,EAAAlL,cAAC4X,GAAD,MACA5C,EAAA9J,EAAAlL,cAAA,KAAGiV,UAAU,sBAAb,oOCJF4C,GAAgB,SAAArW,GAA2B,IAAxBsW,EAAwBtW,EAAxBsW,YAAa5Z,EAAWsD,EAAXtD,KAG9B6Z,EAAQ,CAAC,MAAO,MAAO,MAAO,OAC9BC,EAAmBlZ,OAAOG,YAAYH,OAAOI,QAAQhB,EAAKU,YAC7DsC,OAAO,SAAAhD,GAAI,OAAI6Z,EAAME,SAAS/Z,EAAK,MACnC2N,KAAK,SAACX,EAAGhG,GAAJ,OAAU6S,EAAMG,QAAQhN,EAAE,IAAM6M,EAAMG,QAAQhT,EAAE,OAExD,OACE8P,EAAA9J,EAAAlL,cAAA,UAAQiV,UAAU,YAChBD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,sBAAsBS,QAThB,kBAAMoC,MAUzB9C,EAAA9J,EAAAlL,cAAC4V,GAAA,KAAD,CAAMX,UAAU,SAASpV,KAAK,oBAC9BmV,EAAA9J,EAAAlL,cAAA,QAAMiV,UAAU,cAAhB,qBAEFD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,mBACbD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,gBACbD,EAAA9J,EAAAlL,cAAA,UAAK9B,EAAK2B,MACVmV,EAAA9J,EAAAlL,cAAC+W,EAAA,MAAD,CACElX,KAAK,oBACLO,MAAM,kBACN6U,UAAU,WAEVD,EAAA9J,EAAAlL,cAAA,MAAIiV,UAAU,sBACXnW,OAAOI,QAAQ8Y,GAAkBtZ,IAAI,SAAA4C,GAAS,OAC7C0T,EAAA9J,EAAAlL,cAAA,MAAIiV,UAAU,oBAAoB7N,IAAK9F,EAAU,IAC9CA,EAAU,GAAGzB,KADhB,KACwByB,EAAU,GAAGI,YAM7CsT,EAAA9J,EAAAlL,cAAC4X,GAAD,CAAmB3C,UAAU,+BAC7BD,EAAA9J,EAAAlL,cAAA,KAAGiV,UAAU,sBAAb,oOAUR4C,GAAc9B,aAAe,CAC3B+B,YAAa,WACXT,QAAQC,IAAI,iCAIDO,UCpDTM,GAAmB,SAAA3W,GAAsC,IAApCyT,EAAoCzT,EAApCyT,UAAWyB,EAAyBlV,EAAzBkV,OAAQvS,EAAiB3C,EAAjB2C,MAAOiU,EAAU5W,EAAV4W,KACnD,OACEpD,EAAA9J,EAAAlL,cAAA,OACEiV,UAAWA,EACXoD,MAAO,CAACC,QAAS,eAAgBC,gBAAiBH,EAAM1B,SAAQvS,YAWtEgU,GAAiBpC,aAAe,CAC9BW,OAAQ,OACRvS,MAAO,OACPiU,KAAM,WAGOD,UClBTK,GAAQ,SAAAhX,GAAqD,IAAnD5C,EAAmD4C,EAAnD5C,WAAmD6Z,EAAAjX,EAAvCkX,OAASnZ,EAA8BkZ,EAA9BlZ,OAAQoZ,EAAsBF,EAAtBE,QAASlX,EAAagX,EAAbhX,OACpD,IAAK7C,EACH,OAAO,KAGT,IAAMwZ,EAAO,SAACO,EAASpX,GAAV,OAAoBoX,EAAQpX,EAAQoX,EAAQlX,SAEzD,OACEuT,EAAA9J,EAAAlL,cAAC4Y,EAAA,SAAD,KACGrZ,EAAOb,IAAI,SAACma,EAAOtX,GAClB,IAAK3C,EAAWia,GACd,OAAO,KAGT,IAAMxY,EAAQzB,EAAWia,GAAOnX,MAEhC,OACEsT,EAAA9J,EAAAlL,cAAA,OAAKoH,IAAKyR,GACR7D,EAAA9J,EAAAlL,cAAA,QAAMiV,UAAU,sBAAhB,GAAA3V,OAAyCe,IACzC2U,EAAA9J,EAAAlL,cAAC8Y,GAAD,CAAKV,KAAMA,EAAKO,EAASpX,GAAQ4C,MAAK,GAAA7E,OAAKmC,EAAOpB,GAAZ,aA0BnC0Y,GAlBA,SAAAlT,GAAgD,IAA9CmT,EAA8CnT,EAA9CmT,QAASC,EAAqCpT,EAArCoT,UAAWpR,EAA0BhC,EAA1BgC,QAASqR,EAAiBrT,EAAjBqT,YAC5C,OACElE,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAWwC,KAAW,WAAD3Y,OAAA+C,EAAA,EAAA/C,CAAA,GAAgBka,EAAQra,IAAMf,QAAQob,EAAQra,QACtEqW,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAW+D,EAAQG,QAAQ,IAAKF,GACrCjE,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAW+D,EAAQG,QAAQ,IAAKtR,EAAQhI,MAC7CmV,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAW+D,EAAQG,QAAQ,IAC9BnE,EAAA9J,EAAAlL,cAACoZ,GAAD,CAAOxa,WAAYiJ,EAAQjJ,WAAY8Z,OAAQQ,KAEjDlE,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAW+D,EAAQG,QAAQ,IAAKtR,EAAQjJ,YAAciJ,EAAQjJ,WAAR,KAA6BiJ,EAAQjJ,WAAR,IAA0B8C,SCzC3GiX,GAAU,CAAC,UAAW,UAAW,WACjCU,GAAa,CAAC,MAAO,MAAO,MAAO,OACnCC,GAAe,CAC1B3a,IAAK,uBACLwa,QAAS,CACP,sBACA,gBACA,iBACA,mBCGEhB,GAAmB,SAAA3W,GAAyC,IAAvCmT,EAAuCnT,EAAvCmT,MAAO4E,EAAgC/X,EAAhC+X,WAAYrb,EAAoBsD,EAApBtD,KAAMsb,EAAchY,EAAdgY,SAClD,GAAoB,IAAhBtb,EAAKuD,OACP,OAAO,KAGT,IAIMgY,EAJmB3a,OAAOI,QAAQhB,EAAK,GAAGU,YAC7CsC,OAAO,SAAAhD,GAAI,OAAImb,GAAWpB,SAAS/Z,EAAK,MACxC2N,KAAK,SAACX,EAAGhG,GAAJ,OAAUmU,GAAWnB,QAAQhN,EAAE,IAAMmO,GAAWnB,QAAQhT,EAAE,MAExBxG,IAAI,SAACR,EAAM2I,GAAP,OAC5CmO,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,0BAA0B7N,IAAKlJ,GAC5C8W,EAAA9J,EAAAlL,cAAC8Y,GAAD,CAAK7D,UAAU,0BAA0BmD,KAAMO,GAAQ9R,KACtD3I,EAAK,GAAG2B,QAIPqZ,EAAc,CAClB3Z,OAAQ8Z,GACRV,WACAlX,OAAQ,SAAApB,GAAK,OAAKA,EAAQ,EAAK,KAG3BqZ,EAAaxb,EAAK2N,KAAK,SAACX,EAAGhG,GAAM,IAAAyU,EACRzO,EAAEtM,WAApBgb,EAD0BD,EAC9BpZ,IAAcsZ,EADgBF,EACpB/Y,IADoBkZ,EAER5U,EAAEtG,WAApBmb,EAF0BD,EAE9BvZ,IAAcyZ,EAFgBF,EAEpBlZ,IACjB,OAAIgZ,GAAQG,GAAQH,EAAKlY,OAASqY,EAAKrY,MAC9ByD,WAAW4U,EAAKrY,OAASyD,WAAWyU,EAAKlY,OACvCmY,GAAQG,GAAQH,EAAKnY,OAASsY,EAAKtY,MACrCyD,WAAW6U,EAAKtY,OAASyD,WAAW0U,EAAKnY,OAG3C,IAGT,OACEsT,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,aACbD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,mBACbD,EAAA9J,EAAAlL,cAAA,QAAMiV,UAAU,cAAcN,GAC9BK,EAAA9J,EAAAlL,cAAA,UAAQyF,KAAK,SAASiQ,QAAS8D,GAAWD,IAE5CvE,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,4BACbD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,2BACbD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAWqE,GAAaH,QAAQ,IAArC,QACAnE,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAWqE,GAAaH,QAAQ,IAArC,QACAnE,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAWqE,GAAaH,QAAQ,IAArC,iBAAwDM,GACxDzE,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAWqE,GAAaH,QAAQ,IAArC,gBAEFnE,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,yBACdyE,EAAWhb,IAAI,SAACmJ,EAAStG,GACxB,OACIyT,EAAA9J,EAAAlL,cAACia,GAAD,CACEjB,QAASM,GACTlS,IAAKS,EAAQ5F,IACbgX,UAAW1X,EAAQ,EACnBsG,QAASA,EACTqR,YAAaA,UAgB7Bf,GAAiBpC,aAAe,CAC9BpB,MAAO,sBACP4E,WAAY,oBAGCpB,UCxDA+B,GAxBA,SAAA1Y,GAGb,OADIA,EADJwL,QAEcjK,GAAMC,QACX,KAIPgS,EAAA9J,EAAAlL,cAAA,UAAQiV,UAAU,YAChBD,EAAA9J,EAAAlL,cAAC+W,EAAA,MAAD,CACElX,KAAK,mBACLO,MAAM,eACN6U,UAAU,WAEVD,EAAA9J,EAAAlL,cAAC2X,GAAD,SCoBOwC,GAhCG,SAAA3Y,GAQZ,IAPJ2C,EAOI3C,EAPJ2C,MACAtB,EAMIrB,EANJqB,SACAmK,EAKIxL,EALJwL,MACAoN,EAII5Y,EAJJ4Y,WACAC,EAGI7Y,EAHJ6Y,YACAvP,EAEItJ,EAFJsJ,WACAqC,EACI3L,EADJ2L,SAEMmN,EAAcC,iBAAO,MAC3BC,oBAAU,WACR,IAAMC,EAAeH,EAAY7L,QAAQiM,YAErCD,IAAiBtW,GACnBtB,EAAS,CAAC3E,KAAMuc,MAGpB,IACME,EAAgB3N,IAAUjK,GAAMC,QAAW,mBAAqB,wBAEtE,OACEgS,EAAA9J,EAAAlL,cAAA,OAAKsV,IAAKgF,EAAarF,UAAU,aAC7BjI,IAAUjK,GAAMC,QAChBgS,EAAA9J,EAAAlL,cAAC4a,GAAD,MACA5F,EAAA9J,EAAAlL,cAAC6a,GAAD,CAAe3c,KAAMkc,EAAYtC,YAPd,kBAAMhN,EAAW,CAAC5M,KAAM,UAS7C8W,EAAA9J,EAAAlL,cAAC8a,GAAD,CAAkB5c,KAAMmc,EAAab,SAAUrM,EAAUwH,MAAOgG,IAChE3F,EAAA9J,EAAAlL,cAAC+a,GAAD,CAAQ/N,MAAOA,MCrBfuK,GAAqB,CACzBzM,cACAqC,YACAtK,YAGaqQ,eAbS,SAAAzI,GAAK,MAAK,CAChCuC,MAAOvC,EAAMzG,UAAUgJ,MACvB7I,MAAOsG,EAAMzG,UAAUG,MACvBiW,WAAYhE,GAAe3L,GAC3B4P,YAAa5P,EAAMzG,UAAUkC,OAAOhI,OASEqZ,GAAzBrE,CAA6CiH,IClBtDa,uLASK,IAECtU,EADgBnI,KAAK8U,MAArB4H,YACAvU,aAER,OAAKA,GAAsC,eAAtBA,EAAajB,KAKhCuP,EAAA9J,EAAAlL,cAAA,WACEgV,EAAA9J,EAAAlL,cAAA,MAAIiV,UAAU,4BACXvO,EAAaC,MAAMjI,IAAI,SAAA8C,GAAA,IAAG3B,EAAH2B,EAAG3B,KAAMQ,EAATmB,EAASnB,MAAO6a,EAAhB1Z,EAAgB0Z,MAAhB,OACtBlG,EAAA9J,EAAAlL,cAAA,MAAIoH,IAAG,0BAAA9H,OAA4BO,GAAQQ,IACzC2U,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,kBAAkBoD,MAAO,CAAEE,gBAAiB2C,KAC3DlG,EAAA9J,EAAAlL,cAAA,QAAMiV,UAAU,QACbpV,GAEHmV,EAAA9J,EAAAlL,cAAA,QAAMiV,UAAU,QACb5U,OAKRqG,EAAayU,YACZnG,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,4BACbD,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,cACZvO,EAAayU,WAAWzc,IAAI,SAAAkI,GAAI,OAC/BoO,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,kBAAkB7N,IAAKR,EAAK/G,MACzCmV,EAAA9J,EAAAlL,cAAA,QAAMiV,UAAU,QAAQoD,MAAO,CAAE+C,WAAYxU,EAAKsU,SAClDlG,EAAA9J,EAAAlL,cAAA,QAAMiV,UAAU,SAASrO,EAAK/G,YAxBnC,YAdsBgW,IAAMwF,eAAnCL,GAKGjF,aAAe,CACpBkF,YAAa,IA2CFD,IClDAlF,GDkDAkF,kCE/CFM,GAAqB,CAChC1R,IAAKhK,0KACLwF,QAAS,CAAEmW,YAAa,wHAGbC,GAAW,CAEtBC,IAAK,CACHjW,GAAI,MACJnF,MAAOT,0KACPQ,MAAO,QACPgF,QAAS,CAAEmW,YAAa,wHAE1BG,UAAW,CACTlW,GAAI,YACJnF,MAAO,qDACPD,MAAO,YACPgF,QAAS,CAAEmW,YAAa,mGAE1BI,QAAS,CACPnW,GAAI,UACJnF,MAAO,gNACPD,MAAO,UACPgF,QAAS,CAAEmW,YAAa,sKAE1BK,MAAO,CACLpW,GAAI,QACJnF,MAAO,mNACPD,MAAO,cACPgF,QAAS,CAAEmW,YAAa,uKCmEbM,eA1Fb,SAAAA,EAAYxI,GAAO,IAAAtK,EAAA,OAAAjK,OAAAoJ,EAAA,EAAApJ,CAAAP,KAAAsd,IACjB9S,EAAAjK,OAAAwU,GAAA,EAAAxU,CAAAP,KAAAO,OAAAyU,GAAA,EAAAzU,CAAA+c,GAAA5V,KAAA1H,KAAM8U,KAED5I,MAAQ,CAAEqR,QAAQ,GAEvB/S,EAAKgT,eAAiBhT,EAAKiT,cAAcC,KAAnBnd,OAAAod,GAAA,EAAApd,CAAAiK,IALLA,uFASjBhJ,SAASoc,oBAAoB,QAAS5d,KAAKyd,qDAG/BjI,GACZ,IAAMjU,EAAKC,SAASqc,cAAc,sBACbtc,GAAMA,EAAGuc,WAAavc,EAAGuc,SAAStI,EAAEyB,SAEvCjX,KAAK+d,gBAAe,8CAGb,IAATjc,EAASmB,EAATnB,MAChB9B,KAAK8U,MAAM9P,WAAWlD,0CAGTkc,GAAI,IAAA/S,EAAAjL,KACXud,EAAwB,qBAAPS,GAA6B,OAAPA,EAAeA,GAAMhe,KAAKkM,MAAMqR,OAE7Evd,KAAKyV,SAAS,CAAE8H,WAEhBU,sBAAsB,WAChBD,EACF1e,OAAO4e,iBAAiB,QAASjT,EAAKuS,gBAEtCle,OAAOse,oBAAoB,QAAS3S,EAAKuS,kBAG7Cxd,KAAKyV,SAAS,CAAE8H,4CAIT,IAAApH,EAAAnW,KACCwQ,EAAYxQ,KAAK8U,MAAjBtE,QACA+M,EAAWvd,KAAKkM,MAAhBqR,OAER,OACE9G,EAAA9J,EAAAlL,cAAC0c,GAAAxR,EAAD,CACEyR,WAAW,YACXC,YAAa,CAAC,CACZL,GAAI,WAENM,aAAa,WACb7D,QAAS,CACP8D,QAAS,mCAIX9H,EAAA9J,EAAAlL,cAAA,UAAQyF,KAAK,SAASwP,UAAU,iBAAiBS,QAAS,kBAAMhB,EAAK4H,gBAAe,KAClFtH,EAAA9J,EAAAlL,cAAC+W,EAAA,KAAD,CAAMlX,KAAK,SAASoV,UAAU,YAI/B6G,GACC9G,EAAA9J,EAAAlL,cAAA,WACEgV,EAAA9J,EAAAlL,cAAC+W,EAAA,WAAD,CACEpQ,MAAO7H,OAAOU,KAAKgc,IAAU9c,IAAI,SAACqe,GAChC,IAAMC,EAAKxB,GAASuB,GACpB,MAAO,CACL3c,MAAO4c,EAAG5c,MACVC,MAAO2c,EAAGxX,MAGd3F,KAAK,UACLod,SAAUlO,EACVmI,SAAU,SAACgG,GAAexI,EAAKyI,gBAAgBD,MAIjDlI,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,qBA7EEoG,iBCNdnI,eACb,SAAAzI,GAAK,MAAK,CAAEsE,QAAStE,EAAM/L,IAAIqQ,UAC/B,CAAExL,eAFW2P,CAGb2I,wBCcIuB,gNA+BJ3S,MAAQ,CACN4S,OAAQ,KACRC,aAAc,6EAGP,IAAA9T,EAAAjL,KAAAgf,EAC+Fhf,KAAK8U,MADpGmK,EAAAD,EACCtI,iBADD,IAAAuI,EACa,GADbA,EACiBjO,EADjBgO,EACiBhO,SAAUiB,EAD3B+M,EAC2B/M,OAAQ1B,EADnCyO,EACmCzO,OAAQC,EAD3CwO,EAC2CxO,QAAS/B,EADpDuQ,EACoDvQ,MAAOmD,EAD3DoN,EAC2DpN,iBAAkBxD,EAD7E4Q,EAC6E5Q,cAC9E8Q,EAAa3e,OAAAE,EAAA,EAAAF,CAAA,GACd0c,GAASzM,GAAW,OADN,CAEjBnF,IAAK4R,GAASzM,GAAW,OAAO1O,QAE5Bqd,EAAW,CACftG,YAAanC,EACb0I,WAAY,CACV9N,KAAMN,EAASM,KACf+N,OAAQ,CACNC,IAAKtO,EAASO,SACdgO,IAAKvO,EAASQ,YAGlBjB,SACAC,QAAS0O,EACTM,OAAQ,CACNC,QAAS,SAACjK,EAAGrV,KACbuf,QAAS,SAAClK,EAAGrV,OAIXwf,EAAe1N,GAAUA,EAAO/O,OAAU+O,EAAO9R,IAAI,SAAAqS,GAAC,MAAK,CAC/DlR,KAAMkR,EAAElR,KACRse,QAASpN,EAAEoN,QACX3N,OAAQ,CAAC1R,OAAAE,EAAA,EAAAF,CAAA,GAAIiS,EAAL,CAAQ+K,QAAQ,QACpB,GAEQ,YAAV9O,IAAqB0Q,EAAStd,MAAQkb,IAE1C,IAAM8C,EAAoB,WACxBzR,GAAc,IAKhB,OACEqI,EAAA9J,EAAAlL,cAAC4V,GAAA,IAAU8H,EACR,SAAAW,GAGC,OAFAxgB,OAAO0I,EAAI8X,EAGXrJ,EAAA9J,EAAAlL,cAAC4Y,EAAA,SAAD,KACE5D,EAAA9J,EAAAlL,cAAC+R,GAAA,aAAD,CACIrT,IAAK2f,EACLC,OAAQC,KACRC,QAAS,cAEVhO,EAAO9R,IAAI,SAAAyH,GAAK,OACf6O,EAAA9J,EAAAlL,cAAC+R,GAAA,MAADjT,OAAA6G,OAAA,CACEyB,IAAKjB,EAAMX,IACPW,IACEA,EAAMsY,qBAAuBtY,EAAMsY,kBAAkBC,UAAYvY,EAAMsY,kBAAkBC,OAAOjd,QAAU,CAC9Gkd,cAAmC,UAAnBxY,EAAMyY,UAA2C,YAAnBzY,EAAMyY,UAA0BzY,EAAMsY,kBAAkBC,OAAOhgB,IAAI,SAAAmgB,GAAC,OAAIA,EAAEC,SACxHf,OAAQ,CACN7d,MAAO,SAAC6T,GACNvK,EAAKwK,SAAS,CACZ+K,gBAAiBhL,EAAE7V,KACnBmf,OAAQtJ,EAAEsJ,iBAQxBrI,EAAA9J,EAAAlL,cAAC4V,GAAA,YAAD,KACEZ,EAAA9J,EAAAlL,cAAC4V,GAAA,YAAD,CAAalX,IAAK2f,IAClBrJ,EAAA9J,EAAAlL,cAACgf,GAAD,MACAhK,EAAA9J,EAAAlL,cAAA,UAAQyF,KAAK,SAASiQ,QAAS0I,GAAmBpJ,EAAA9J,EAAAlL,cAAC4V,GAAA,KAAD,CAAMX,UAAU,UAAUpV,KAAK,iBAGnFmV,EAAA9J,EAAAlL,cAAC4V,GAAA,SAAD,CACElX,IAAK2f,EACLhB,OAAQ7T,EAAKiB,MAAM4S,OACnBnf,KAAM,CACJmf,OAAQ7T,EAAKiB,MAAM4S,OACnBC,aAAc9T,EAAKiB,MAAM6S,eAIxB9T,EAAKiB,MAAMsU,gBACV/J,EAAA9J,EAAAlL,cAAA,WACGwJ,EAAKiB,MAAMsU,gBAAgBE,OAC1BjK,EAAA9J,EAAAlL,cAAA,WACEgV,EAAA9J,EAAAlL,cAAA,UAAKwJ,EAAKiB,MAAMsU,gBAAgBE,QAChCjK,EAAA9J,EAAAlL,cAAA,UAAKwJ,EAAKiB,MAAMsU,gBAAgBG,SAGlClK,EAAA9J,EAAAlL,cAAA,UAAKwJ,EAAKiB,MAAMsU,gBAAgBG,QAElClK,EAAA9J,EAAAlL,cAAA,WAAMwJ,EAAKiB,MAAMsU,gBAAgB3e,QAEjC4U,EAAA9J,EAAAlL,cAAA,uBAGRgV,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,YACbD,EAAA9J,EAAAlL,cAAC4V,GAAA,OAAD,CAAQuJ,UAAU,GACfjB,EAAYxf,IAAI,SAAC0gB,EAAIvY,GAAL,OACfmO,EAAA9J,EAAAlL,cAAC4V,GAAA,eAAD,CACErU,MAAOsF,EACPO,IAAKgY,EAAGjB,QACRkB,WAAYD,EACZE,gBAAiB,SAACC,EAAQC,GAAT,OAAsBrP,EAAiBqP,IACxDC,QACEzK,EAAA9J,EAAAlL,cAAC4V,GAAA,kBAAD,KACEZ,EAAA9J,EAAAlL,cAAC4V,GAAA,wBAAD,CACE8J,WAAY,CAAEnH,gBAAiB,WAC/BoH,YAAa,CAAEpH,gBAAiB,eAKtCvD,EAAA9J,EAAAlL,cAAC4V,GAAA,gBAAD,KACEZ,EAAA9J,EAAAlL,cAAC4f,GAAD,sBAvJJ9J,aAAZsH,GAkBGrH,aAAe,CACpB8J,SAAU,KACVtQ,SAAU,CAAEM,KAAM,EAAGgO,IAAK,EAAGC,IAAK,GAClChP,OAAQ,GACRgR,SAAS,EACTC,YAAY,EACZC,iBAAkB,aAClBC,OAAQ,aACRC,YAAa,aACb1c,eAAgB,aAChBgN,OAAQ,IAwIG4M,UClLT+C,GAAU,CAAEC,IAAK,EAAGC,IAAK,EAAGC,IAAK,GAE1BC,GAAkBvK,aAC7B,CARa,SAAAvL,GAAK,OAAIA,EAAM+F,OAAOM,MAEhB,SAAArG,GAAK,OAAIA,EAAMzG,UAAUgJ,OADvB,SAAAvC,GAAK,OAAIA,EAAMzG,UAAUC,YAEvB,SAAAwG,GAAK,OAAIA,EAAMzG,UAAUpF,WAAWyB,QAM3D,SAACmgB,EAASC,EAAeC,EAAiBC,GACxC,IAAKH,EACH,MAAO,GAGT,IAAMI,EAAiBT,GAAQQ,GAG/B,GAAsB,YAAlBF,EAA6B,CAC/B,IAAMI,EAAYL,EAAQjQ,kBAAkBqQ,GAC5C,MAAO,CAAC9hB,OAAAE,EAAA,EAAAF,CAAA,GACH+hB,EADE,CAEL7P,QAAS6P,EAAU7P,SAAW,GAC9BxI,OAAO1J,OAAAE,EAAA,EAAAF,CAAA,GAAM+hB,EAAUrY,OAAjB,CAAyBvG,IAAKye,OAKxC,MAAO,CAAC5hB,OAAAE,EAAA,EAAAF,CAAA,GACH0hB,EAAQlQ,iBAAiBsQ,GADvB,CAEL5P,QAASwP,EAAQlQ,iBAAiBsQ,GAAgB5P,SAAW,QCf7DuG,GAAqB,CACzB/T,kBACAL,gBACAM,gBACAC,gBACAyM,oBACAxD,kBAGauG,eAfS,SAAAzI,GAAK,OAAA3L,OAAAE,EAAA,EAAAF,CAAA,GACxB2L,EAAM/L,IADkB,CAE3B8R,OAAQ+P,GAAgB9V,GACxBuC,MAAOvC,EAAMzG,UAAUgJ,SAYeuK,GAAzBrE,CAA6CkK,ICM7C0D,GAvBF,SAAAtf,GAAgF,IAA7EgM,EAA6EhM,EAA7EgM,qBAAsBC,EAAuDjM,EAAvDiM,YAAaf,EAA0ClL,EAA1CkL,sBAAuBC,EAAmBnL,EAAnBmL,cAExE,OACEqI,EAAA9J,EAAAlL,cAAA,QAAMiV,UAAU,UACdD,EAAA9J,EAAAlL,cAAC+W,EAAA,QAAD,CACEK,YAAY,qBACZ2J,SAAU,SAAAC,GACRtU,GAAuBsU,IAEzBC,SAAUzT,GAEVwH,EAAA9J,EAAAlL,cAACkhB,GAAD,OAEFlM,EAAA9J,EAAAlL,cAAA,OAAKiV,UAAU,eACbD,EAAA9J,EAAAlL,cAACtB,GAAD,CAAKuW,UAAU,oBAEjBD,EAAA9J,EAAAlL,cAACmhB,GAAD,CAAcC,OAAQ3T,EAAa4T,WAAW,QAAQC,eAfhC,kBAAM3U,GAAc,KAgBxCqI,EAAA9J,EAAAlL,cAACuhB,GAAD,SCXFhK,GAAqB,CACzB7K,yBACA0D,aACAzD,kBAGauG,eAVS,SAAAzI,GAAK,OAAA3L,OAAAE,EAAA,EAAAF,CAAA,GACxB2L,EAAMuH,MAS6BuF,GAAzBrE,CAA6C4N,ICN7CU,GAVE,SAAAhgB,GAAoC,IAAlC4O,EAAkC5O,EAAlC4O,UAAW5F,EAAuBhJ,EAAvBgJ,kBAO5B,OANAgQ,oBAAU,WACRpK,IACA5F,KACC,CAAC4F,EAAW5F,IAGRwK,EAAA9J,EAAAlL,cAACyhB,GAAD,OCPMC,GAFM,kBAAM1M,EAAA9J,EAAAlL,cAAA,WAAKgV,EAAA9J,EAAAlL,cAAA,yBCK1B2hB,GAAU,IAAIvE,IAAI,CACtB,CAAC,OAAQoE,IACT,CAAC,WAAYA,MAmBAI,GAdA,SAAAvO,GAAS,IACN5E,EAAc4E,EAAtBhF,KAAQI,QACVoT,EAAOF,GAAQG,IAAIrT,GAAWkT,GAAQrd,IAAImK,GAAWiT,GAE3D,OAAO1M,EAAA9J,EAAAlL,cAAC6hB,EAASxO,ICXbkE,GAAqB,CACzBnH,aACA5F,sBAGa0I,eANS,SAAA1R,GAAA,MAAe,CAAE6M,KAAjB7M,EAAG6M,OAQzBkJ,GAFarE,CAGb0O,kBCKFG,IAASC,OAAOhN,EAAA9J,EAAAlL,cAPJ,kBACVgV,EAAA9J,EAAAlL,cAACiiB,EAAA,EAAD,CAAUjP,MAAOA,IACfgC,EAAA9J,EAAAlL,cAAC+W,EAAA,MAAD,MACA/B,EAAA9J,EAAAlL,cAACkiB,GAAD,QAIY,MAASniB,SAASoiB,eAAe,S3D8G3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAM/d,KAAK,SAACge,GAClCA,EAAaC","file":"static/js/main.35e71209.chunk.js","sourcesContent":["/* eslint-disable */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost'\n    // [::1] is the IPv6 localhost address.\n    || window.location.hostname === '[::1]'\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    || window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service '\n              + 'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all '\n                  + 'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404\n        || (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import json2csv from 'json2csv';\n\nclass ExportService {\n  saveAsJSON(data) {\n    const dataStr = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(data));\n    this.triggerDownload('dataset.json', dataStr);\n  }\n\n  saveAsCSV(data) {\n    const flattenedData = data.map(row => {\n      const {indicators, ...opts} = row;\n\n      if (!indicators) {\n        return {...opts};\n      }\n\n      return {\n        ...opts,\n        ...Object.fromEntries(\n          Object.entries(row.indicators).flatMap(\n            entry => Object.entries(entry[1]).map(\n              feat => [`${entry[0]}_${feat[0]}`,feat[1]]\n            )\n          )\n        )\n      };\n    });\n\n    const fields = Object.keys(flattenedData[0]);\n    \n    const csv = json2csv.parse(flattenedData, { fields });\n    const dataStr = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);\n    this.triggerDownload('dataset.csv', dataStr);\n  }\n\n  /**\n   * Save a static file\n   */\n  saveRankings() {\n    const dataStr = `${process.env.PUBLIC_URL}/Aqueduct30_Rankings_V01.xlsx`;\n    this.triggerDownload('Aqueduct30_Rankings_V01.xlsx', dataStr);\n  }\n  \n  /**\n   * Trigger download\n   * @param {string} name \n   * @param {string} dataStr \n   */\n  triggerDownload(name, dataStr) {\n    const el = document.createElement('a');\n    el.setAttribute('href', dataStr);\n    el.setAttribute('download', name);\n    el.click();\n  }\n}\n\nexport const service = new ExportService();\nexport default service;","export const INDICATORS = [\n  {\n    label: 'Baseline Water Stress',\n    value: 'bws'\n  },\n  {\n    label: 'Drought Risk',\n    value: 'drr'\n  },\n  {\n    label: 'Riverine Flood Risk',\n    value: 'rfr'\n  }\n];\n\nexport const INDICATOR_CATEGORIES = {\n  'Tot': 'Total',\n  'Dom': 'Domestic',\n  'Ind': 'Industrial',\n  'Irr': 'Agricultural',\n  'Liv': 'Livestock',\n  'Pop': 'Population',\n  'Avg': 'Average'\n};\n\nexport const ERRORS = {\n  MISSING_REQUIRED_PARAMETER: 'Required parameter is not present.',\n  MISSING_WIDGET_REQUEST_PARAMETERS: 'Cannot make widget data request. Missing parameters.'\n};\n\nexport default {\n  INDICATORS,\n  INDICATOR_CATEGORIES,\n  ERRORS\n};","import { INDICATOR_CATEGORIES } from 'services/wri-service/constants';\n\n/**\n * Get average of given values, skips 'Tot' total value.\n * @param {*} data \n */\nfunction getAverage(data) {\n  return data.filter(entry => entry.category !== 'Tot')\n    .reduce((acc, indicator, index, {length}) => (index === length -1)\n      ? (acc + indicator.score)/ length\n      : acc + indicator.score, 0);\n}\n\nfunction setScore(score) {\n  if (!score) {\n    return 'NO DATA';\n  }\n\n  return score.toFixed(2);\n}\n\nfunction getIndicators(data) {\n  return data.reduce((acc, indicator) => ({\n    ...acc,\n    [indicator.category]: {\n      name: INDICATOR_CATEGORIES[indicator.category],\n      score: setScore(indicator.score),\n      rank: indicator.rank\n    },\n    Avg: {\n      name: INDICATOR_CATEGORIES['Avg'],\n      score: getAverage(data).toFixed(2)\n    }\n  }), {});\n}\n\n/**\n * \n * @param {string} iso - Identifier\n * @param {*} data - Object where indicators are keys.\n */\nexport function processLocation(iso, data, nameProp='country') {\n  return {\n    iso,\n    name: data[0][nameProp],\n    indicators: getIndicators(data)\n  };\n}\n\nexport default processLocation;","import { createAction } from 'vizzuality-redux-tools';\n\nexport const setCountries = createAction('DASHBOARD/setCountries');\nexport const setIndicators = createAction('DASHBOARD/setIndicators');\nexport const setLocation = createAction('DASHBOARD/setLocation');\nexport const setCountryValue = createAction('DASHBOARD/setCountryValue');\nexport const setIndicatorValue = createAction('DASHBOARD/setIndicatorValue');\nexport const setWidgetData = createAction('DASHBOARD/setWidgetData');\nexport const setWidgetStats = createAction('DASHBOARD/setWidgetStats');\nexport const setWidth = createAction('DASHBOARD/setWidth');\n\nexport default {\n  setLocation,\n  setCountryValue,\n  setIndicatorValue\n};\n","export const SCOPE = {\n  GENERAL: 'GENERAL',\n  COUNTRY: 'COUNTRY'\n};\n\nexport default {\n  SCOPE\n};","import axios from 'axios';\nimport { createAction, createThunkAction } from 'vizzuality-redux-tools';\n\nexport const setMap = createAction('MAP/setMap');\nexport const setMapBounds = createAction('MAP/setMapBounds');\nexport const setMapStyle = createAction('MAP/setMapStyle');\nexport const setMapLabels = createAction('MAP/setMapLabels');\nexport const setMapRoads = createAction('MAP/setMapRoads');\nexport const setBasemap = createAction('MAP/setBasemap');\nexport const setMapViewport = createAction('MAP/setMapViewport');\nexport const setMapLoaded = createAction('MAP/setMapLoaded');\nexport const setMapFlying = createAction('MAP/setMapFlying');\n\nexport const getCountryBounds = createThunkAction('MAP/getCountryBounds', () => (dispatch, getState) => {\n  const state = getState();\n  const { locationId: iso, width: offset } = state.dashboard;\n  const boundsSQL = `SELECT ST_AsGeoJSON(ST_AsText(ST_Envelope(the_geom))) as geometry, gid_0, name_0 FROM gadm_wri_0 WHERE gid_0 = '${iso}'`;\n\n  axios.get(`https://wri-rw.carto.com/api/v2/sql?q=${boundsSQL}`)\n    .then((result) => {\n      const theGeom = JSON.parse(result.data.rows[0].geometry);\n      const bounds = window.L.geoJSON(theGeom).getBounds();\n      const bbox = bounds.toBBoxString().split(',').map(b => parseFloat(b));\n      dispatch(setMapBounds({ bbox, options: {\n        paddingTopLeft: [offset, 0]\n      } }));\n    });\n});\n\nexport default {\n  setMap,\n  setMapBounds,\n  setMapStyle,\n  setBasemap,\n  setMapLabels,\n  setMapRoads,\n  setMapViewport,\n  setMapLoaded,\n  setMapFlying,\n  getCountryBounds\n};\n","const serialize = ({ id, type, attributes }) => Object.assign({}, { id, type }, attributes);\n\nconst itemSerializer = ({ id, type, attributes }, options = {}) => {\n  const d = Object.assign({}, { id, type }, attributes);\n\n  if (Object.prototype.hasOwnProperty.call(d, 'widget')) d.widget = d.widget.map(serialize);\n  if (Object.prototype.hasOwnProperty.call(d, 'layer')) d.layer = d.layer.map(serialize);\n  if (Object.prototype.hasOwnProperty.call(d, 'metadata')) {\n    d.metadata = d.metadata.map(serialize);\n\n    if (options.locale) {\n      d.metadata = d.metadata.find(m => m.language === options.locale) || {};\n    }\n  }\n  if (Object.prototype.hasOwnProperty.call(d, 'vocabulary')) d.vocabulary = d.vocabulary.map(serialize);\n  if (Object.prototype.hasOwnProperty.call(d, 'legendConfig') &&\n    Object.prototype.hasOwnProperty.call(d.legendConfig, 'items')) {\n    d.legendConfig.items = d.legendConfig.items.map((item, index) => {\n      const i = Object.assign({}, item);\n      i.id = i.id || index;\n      return i;\n    });\n  }\n\n  return d;\n};\n\nexport const wriAPISerializer = ({ data }, options = {}) => {\n  if (data && Array.isArray(data)) return data.map(d => itemSerializer(d, options));\n  return itemSerializer(data, options);\n};\n\nexport default wriAPISerializer;\n","import get from 'lodash/get';\n\n/**\n * aggregateByKey\n * @param {Array} collection - The collection of objects to be aggregated. \n * @param {string} key - The key used to aggregate objects.\n * @param {function} mapFn - A map function for each of the objects in the collection.\n */\nexport function aggregateByKey(collection, key, mapFn = x => x) {\n  // todo: could stats be done better by flattening and using Math functions?\n  const stats = {\n    length: 0,\n    sum: null,\n    max: null,\n    min: null\n  };\n\n  return collection.reduce((acc, row) => {\n    const rowKey = get(row, key);\n    const rowValue = mapFn(row);\n\n    const name = (key === 'iso') ? row.country : row.province;\n\n    if (!name) {\n      return acc;\n    }\n\n    if (row.score) {\n      stats.length++;\n      stats.sum += row.score;\n\n      if (!stats.min) {\n        stats.min = row.score;\n      } else {\n        if (row.score < stats.min) {\n          stats.min = row.score;\n        }\n      }\n\n      if (!stats.max) {\n        stats.max = row.score;\n      } else {\n        if (row.score > stats.max) {\n          stats.max = row.score;\n        }\n      }\n    }\n\n    if (acc[rowKey]) {\n      acc[rowKey].push(rowValue);\n    } else {\n      acc[rowKey] = [rowValue];\n    }\n\n    return acc;\n  }, { _stats: stats });\n}\n\nexport default aggregateByKey;","import axios from 'axios';\nimport get from 'lodash/get';\n\nimport serializer from './wri-json-api-serializer';\nimport aggregateByKey from './aggregate-by-key';\nimport {\n  ERRORS\n} from './constants';\n\nclass WRIService {\n  constructor() {\n    this.client = axios.create({\n      baseURL: process.env.REACT_APP_API_URL,\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  fetchLayersFromDataset(id, params = {}) {\n    return this.client.get(`/dataset/${id}/layer`, { params })\n      .then(response => {\n        const { status, statusText, data } = response;\n        if (status >= 400) throw new Error(statusText);\n        return serializer(data);\n      });\n  }\n\n  fetchDatasetsLayers(datasets) {\n    // We are unzipping here, you can check https://lodash.com/docs/4.17.11#unzip\n    // It is better this way because Object entries, values and keys can be order inconsistent\n    const [ datasetNames, datasetPromises ] = Object.entries(datasets).reduce((acc, item) => [\n      [...acc[0], item[0]],\n      [...acc[1], this.fetchLayersFromDataset(item[1])]\n    ], [[], []]);\n\n    return axios.all(datasetPromises)\n      .then(response => {\n        return datasetNames.reduce((acc, name, index) => ({\n          ...acc,\n          [name]: response[index]\n        }), {});\n      });\n  }\n\n  /**\n   * \n   * @param {Object} options\n   * @param {Object} options.dataset - Widget dataset\n   * @param {string} options.dataset.id - Widget dataset id\n   * @param {Object} options.widget - Widget object\n   * @param {string} options.widget.id - Widget id\n   * @param {Object} options.widget.params - Widget request parameters\n   * @param {Object} options.params - Request parameters\n   */\n  fetchDatasetWidgets(options) {\n    const widgetId = get(options, 'widget.id', null);\n    const widgetParams = get(options, 'widget.params', null);\n    const params = get(options, 'params', {});\n\n    if (widgetId && widgetParams) {\n      return this.client(`/widget/${widgetId}`, params)\n        .then(response => {\n          const { status, statusText, data } = response;\n          if (status >= 400) throw new Error(statusText);\n          return serializer(data);\n        })\n        .then(widgetData => {\n          const url = this.processWidgetData(widgetData, widgetParams);\n          return axios.get(url);\n        })\n        .then(response => {\n          const { status, statusText, data } = response;\n          if (status >= 400) throw new Error(statusText);\n          return aggregateByKey(data.rows, options.indexKey, row => ({\n            country: (options.indexKey === 'iso') ? row.country : row.province,\n            category: row.weight,\n            score: row.score,\n            rank: row.score_ranked\n          }));\n        });\n    }\n\n    throw new Error(ERRORS.MISSING_WIDGET_REQUEST_PARAMETERS);\n  }\n\n  /**\n   * processWidgetData - Process widget data as returned from WRI service.\n   * @param {Object} widgetData\n   * @param {Object} widgetData.widgetConfig\n   * @param {Array} widgetData.widgetConfig.data - An array of objects with url property for querying Carto.\n   * @param {Array} widgetData.widgetConfig.params_config - An array of parameters to replace in widget url's.\n   * @param {Array} widgetParams - Array of parameters, must match the ones requested in paramsConfig.\n   */\n  processWidgetData(widgetData, widgetParams) {\n    const { data, params_config: paramsConfig } = widgetData.widgetConfig;\n    return paramsConfig.reduce((acc, param) => {\n      const { key } = param;\n      if (param.required && !widgetParams[key]) {\n        throw new Error(ERRORS.MISSING_REQUIRED_PARAMETER);\n      }\n\n      return acc.replace(`{{${key}}}`, `'${widgetParams[key]}'`);\n    }, data[0].url);\n  }\n}\n\nexport const service = new WRIService();\nexport default service;\n","import { createAction, createThunkAction } from 'vizzuality-redux-tools';\n\nimport WRIService from 'services/wri-service';\nimport processLocation from 'utils/process-location';\n\nimport { INDICATORS } from 'services/wri-service/constants';\n\nimport { setCountry } from 'modules/app/actions';\n\nimport {\n  setCountries,\n  // setCountryValue,\n  setIndicators,\n  setIndicatorValue,\n  setWidgetData,\n  setWidgetStats\n} from 'modules/dashboard/actions';\n\nexport const setCountriesData = createAction('DATA/setCountriesData');\n\n/**\n * A NOTE on DATA actions\n * Initialize dashboard, we need to do it in the following order:\n * 1. Load indicators, for now they are static, but they should be fetched from a service.\n * 2. Load countries, indicators are needed, because not all data is available for all countries.\n *    If the indicator changes chances are countries list will change.\n */\n\n export const loadDashboardData = createThunkAction('DATA/loadDashboardData', () => (dispatch, state) => {\n  const { router } = state();\n  const { country, indicator } = router.query || {};\n\n  dispatch(getIndicators());\n\n  if (indicator) {\n    dispatch(setIndicatorValue({data: indicator}));\n  }\n\n  dispatch(getCountriesData()).then(data => {\n    const countries4widget = Object.entries(data)\n      .filter(entry => entry[0] !== '_stats')\n      .map(entry => processLocation(entry[0], entry[1]));\n\n    if (country) {\n      dispatch(setCountry({data: country.toUpperCase()}));\n    } else {\n      dispatch(setWidgetStats({data: data._stats}));\n      dispatch(setWidgetData({data: countries4widget}));\n    }\n  });\n});\n\nexport const getIndicators = createThunkAction('DATA/getIndicators', () => dispatch => {\n  // todo: use a service\n  dispatch(setIndicators({data: INDICATORS}))\n  dispatch(setIndicatorValue({data: INDICATORS[0].value}));\n});\n\nexport const getCountriesData = createThunkAction('DATA/getCountriesData', () => async (dispatch, state) => {\n  const dashboard = state().dashboard;\n  const { indicators: { value: indicator }} = dashboard;\n  \n  if (!indicator) return;\n\n  const options = {\n    widget: {\n      id: 'e6e5d286-212b-48d8-b5f4-1678cded82bc',\n      params: { indicator }\n    },\n    indexKey: 'iso'\n  };\n\n  return await WRIService.fetchDatasetWidgets(options)\n  .then(res => {\n    const countries = Object.entries(res)\n      .filter(entry => entry[0] !== '_stats')\n      .map(\n        country => ({\n          label: country[1][0].country,\n          value: country[0],\n        })\n      ).sort((a,b) => {\n        if (a.label && b.label) {\n          return a.label.localeCompare(b.label);\n        }\n  \n        return -1;\n      });\n\n    dispatch(setCountries({data: countries}));\n    // These will be used for Country headers\n    dispatch(setCountriesData({data: res}));\n    return res;\n  })\n});\n\nexport const getProvincesData = createThunkAction('DATA/getProvincesData', () => async (dispatch, state) => {\n  const dashboard = state().dashboard;\n  const { locationId, indicators: { value: indicator }} = dashboard;\n  \n  if (!indicator) return;\n\n  const options = {\n    widget: {\n      id: '4b3d6e89-869c-45b6-88e3-28735d2b60fe',\n      params: { indicator, iso: locationId }\n    },\n    indexKey: 'province'\n  };\n\n  return await WRIService.fetchDatasetWidgets(options);\n});\n\n\n\nexport default {\n  getIndicators,\n  getCountriesData,\n  getProvincesData\n};\n","import { createAction, createThunkAction } from 'vizzuality-redux-tools';\n\nimport exportService from 'services/export-service';\nimport processLocation from 'utils/process-location';\n\nimport {\n  setCountryValue,\n  setIndicatorValue,\n  setLocation,\n  setWidgetData,\n  setWidgetStats\n} from 'modules/dashboard/actions';\nimport { SCOPE } from 'modules/dashboard/constants';\n\nimport { getCountryBounds } from 'modules/map/actions';\nimport { getCountriesData, getProvincesData } from 'modules/data/actions';\nimport { setMapBounds } from 'modules/map/actions';\n\nexport const setDashboardCollapsed = createAction('APP/setDashboardCollapsed');\nexport const setModalState = createAction('APP/setModalState');\n\nexport const setCountry = createThunkAction('APP/setCountry', payload => dispatch => {\n  dispatch(setLocation(payload));\n  dispatch(setCountryValue(payload));\n  dispatch(setUrl({params: {country: payload.data}}));\n  dispatch(getCountryBounds(payload.data));\n\n  const getData = (payload.data) ? getProvincesData : getCountriesData;\n\n  dispatch(getData()).then(data => {\n    const widgetData = Object.entries(data)\n      .filter(entry => entry[0] !== '_stats')\n      .map(entry => processLocation(entry[0], entry[1]));\n\n    dispatch(setWidgetStats({data: data._stats}));\n    dispatch(setWidgetData({data: widgetData}));\n  });\n\n  if (!payload.data) {\n    dispatch(setMapBounds({bbox: [-180, 90, 180, -90]}));\n  }\n});\n\nexport const setIndicator = createThunkAction('APP/setIndicator', payload => (dispatch, state) => {\n  dispatch(setIndicatorValue(payload));\n  dispatch(setUrl({params: {indicator: payload.data}}));\n\n  const {dashboard: {scope}} = state();\n  const getData = (scope === SCOPE.COUNTRY ) ? getProvincesData : getCountriesData;\n\n  dispatch(getData()).then(data => {\n    const widgetData = Object.entries(data)\n      .filter(entry => entry[0] !== '_stats')\n      .map(entry => processLocation(entry[0], entry[1]));\n\n    dispatch(setWidgetStats({data: data._stats}));\n    dispatch(setWidgetData({data: widgetData}));\n  });\n});\n\nexport const setUrl = createThunkAction('APP/saveData', ({ params, replace }) => (dispatch, state) => {\n  const { router: {type, query} } = state();\n\n  const newQuery = replace\n    ? {...params}\n    : {...query, ...params};\n\n  const cleanQuery = Object.fromEntries(Object.entries(newQuery).filter(entry => Boolean(entry[1])));\n\n  dispatch({\n    type,\n    query: cleanQuery\n  });\n});\n\nexport const saveData = createThunkAction('APP/saveData', () => () => {\n  exportService.saveRankings();\n});\n\n","import {\n  setCountry,\n  setDashboardCollapsed,\n  setModalState\n} from './actions';\n\nconst reducerMap = {\n  [setCountry]: (state, { payload }) => ({\n    ...state, country: payload.value\n  }),\n  [setDashboardCollapsed]: (state, { payload }) => ({\n    ...state, isDashboardCollapsed: Boolean(payload)\n  }),\n  [setModalState]: (state, { payload }) => ({\n    ...state, isModalOpen: Boolean(payload)\n  })\n};\n\nexport default reducerMap;\n","export default {\n  isDashboardCollapsed: false,\n  isModalOpen: false\n};\n","import * as actions from './actions';\n\nexport default {\n  [actions.setCountriesData]: (state, { payload: { data } }) => ({ ...state, countries: {...state.countries, data} }),\n  // These actions are created by vizzuality-redux-tools for thunks\n  'DATA/getCountries_STARTED': state  => ({ ...state, countries: {...state.countries, isLoading: true} }),\n  'DATA/getCountries_SUCCEEDED': state  => ({ ...state, countries: {...state.countries, isLoading: false, isLoaded: true} }),\n  'DATA/getIndicators_STARTED': state  => ({ ...state, indicators: {...state.indicators, isLoading: true} }),\n  'DATA/getIndicators_SUCCEEDED': state  => ({ ...state, indicators: {...state.indicators, isLoading: false, isLoaded: true} }),\n  'DATA/getWidgetData_STARTED': state  => ({ ...state, widget: {...state.widget, isLoading: true} }),\n  'DATA/getWidgetData_SUCCEEDED': state  => ({ ...state, widget: {...state.widget, isLoading: false, isLoaded: true} })\n};\n","export default {\n  countries: {\n    data: null,\n    isLoading: false,\n    isLoaded: false,\n    error: null\n  },\n  provinces: {\n    cache: [],\n    data: null,\n    isLoading: false,\n    isLoaded: false,\n    error: null\n  },\n  indicators: {\n    data: null,\n    isLoading: false,\n    isLoaded: false,\n    error: null\n  }\n};\n","import { NOT_FOUND } from 'redux-first-router';\n\nexport const PAGES = [\n  {\n    name: 'HOME',\n    path: '/:iso?/:indicator?',\n    page: 'home'\n  },\n  {\n    name: NOT_FOUND,\n    path: '/404',\n    page: 'not-found'\n  }\n];\n\nexport default PAGES;\n","import { createAction } from 'vizzuality-redux-tools';\n\nimport pages from './constants';\n\nexport const pageActions = pages.reduce(\n  (acc, page) => ({ ...acc, [page.name]: createAction(`PAGES/${page.name}`) }),\n  {}\n);\nexport const setPage = createAction('PAGES/setPage');\n","import { pageActions } from './actions';\n\nconst setPageReducer = key => (state, { payload }) => ({ ...state, current: key, payload });\nconst reducerMap = Object.keys(pageActions).reduce(\n  (acc, key) => ({ ...acc, [key]: setPageReducer(key) }),\n  {}\n);\n\nexport default reducerMap;\n","export default {\n  current: 'PAGES/HOME'\n};\n","import * as actions from './actions';\n\nexport default {\n  [actions.setMap]: (state, { payload }) => ({ ...state, ...payload }),\n  [actions.setMapBounds]: (state, { payload }) => ({ ...state, bounds: payload }),\n  [actions.setBasemap]: (state, { payload }) => ({ ...state, basemap: payload }),\n  [actions.setMapStyle]: (state, { payload }) => ({ ...state, mapStyle: payload }),\n  [actions.setMapLabels]: (state, { payload }) => ({ ...state, mapLabels: payload }),\n  [actions.setMapRoads]: (state, { payload }) => ({ ...state, mapRoads: payload }),\n  [actions.setMapViewport]: (state, { payload }) => ({ ...state, viewport: payload }),\n  [actions.setMapLoaded]: (state, { payload }) => ({ ...state, settings: { isLoaded: payload } }),\n  [actions.setMapFlying]: (state, { payload }) => ({ ...state, settings: { isFlying: payload } })\n};\n","export default {\n  viewport: {\n    zoom: 2,\n    latitude: 41.145218001222204,\n    longitude: -8.61132408966133,\n  },\n  basemap: 'hydro'\n};\n","import { createAction, createThunkAction } from 'vizzuality-redux-tools';\nimport WRIService from 'services/wri-service';\n\nexport const setList = createAction('LAYERS/setList');\nexport const setLoading = createAction('LAYERS/setLoading');\nexport const setError = createAction('LAYERS/setError');\nexport const setLayersOpacity = createAction('LAYERS/setLayersOpacity');\nexport const getLayers = createThunkAction('LAYERS/getLayers', () => dispatch => {\n  dispatch(setLoading(true));\n  dispatch(setError(null));\n\n  const datasets = {\n    country_rankings: 'fd4b4ba5-a16a-45a4-bc6b-954397e37bda',\n    province_rankings: 'e0adfbfb-441d-4ec5-9e4c-7d051d0f7b22'\n  };\n\n  return WRIService.fetchDatasetsLayers(datasets)\n    .then(layers => {\n      dispatch(setList(layers));\n      dispatch(setLoading(false));\n    })\n    .catch((err) => {\n      dispatch(setError(err));\n      dispatch(setLoading(false));\n    });\n});\n\nexport default {\n  setList,\n  setLoading,\n  setError,\n  getLayers,\n  setLayersOpacity\n};\n","import {\n  setList,\n  setLoading,\n  setError,\n  setLayersOpacity\n} from './actions';\n\nexport default {\n  [setList]: (state, { payload }) => ({\n    ...state, list: payload\n  }),\n  [setLoading]: (state, { payload }) => ({\n    ...state, isLoading: Boolean(payload)\n  }),\n  [setError]: (state, { payload }) => ({\n    ...state, error: payload\n  }),\n  [setLayersOpacity]: (state, { payload }) => ({\n    ...state,\n    list: {\n      country_rankings: state.list.country_rankings.map(l => ({ ...l, opacity: payload })),\n      province_rankings: state.list.province_rankings.map(l => ({ ...l, opacity: payload }))\n    }\n  })\n};\n","export default {\n  list: null,\n  isLoading: false,\n  isLoaded: false,\n  error: null\n};\n","import * as actions from './actions';\n\nimport { SCOPE } from './constants';\n\nexport default {\n  [actions.setCountries]: (state, { payload: { data }}) => ({ ...state, countries: {...state.countries, list: data} }),\n  [actions.setIndicators]: (state, { payload: { data } }) => ({ ...state, indicators: {...state.indicators, list: data} }),\n  [actions.setLocation]: (state, { payload: { data } }) => ({\n    ...state,\n    locationId: data,\n    scope: data ? SCOPE.COUNTRY : SCOPE.GENERAL\n  }),\n  [actions.setCountryValue]: (state, { payload: { data } }) => ({ ...state, countries: {...state.countries, value: data} }),\n  [actions.setIndicatorValue]: (state, { payload: { data } }) => ({ ...state, indicators: {...state.indicators, value: data} }),\n  [actions.setWidgetData]: (state, { payload: { data } }) => ({ ...state, widget: {...state.widget, data} }),\n  [actions.setWidgetStats]: (state, { payload: { data: stats } }) => ({ ...state, widget: {...state.widget, stats} }),\n  [actions.setWidth]: (state, { payload: { data } }) => ({ ...state, width: data })\n};\n","import { SCOPE } from './constants';\n\nexport default {\n  scope: SCOPE.GENERAL,\n  locationId: null,\n  width: null,\n  countries: {\n    list: [],\n    value: null\n  },\n  indicators: {\n    list: [],\n    value: null\n  },\n  widget: {\n    data: []\n  }\n};\n","import { connectRoutes } from 'redux-first-router';\nimport queryString from 'query-string';\n\nimport { PAGES } from 'modules/pages/constants';\n\nconst routes = PAGES.reduce((acc, page) => ({\n  ...acc,\n  [page.name]: {\n    path: page.path,\n    ...{ thunk: page.thunk }\n  }\n}), {});\n\nconst options = {\n  basename: process.env.REACT_APP_BASE_URL,\n  location: 'router',\n  notFoundPath: `${process.env.REACT_APP_BASE_URL}404`,\n  initialDispatch: false,\n  querySerializer: queryString\n};\n\nexport default connectRoutes(routes, options);\n","import { createStore, combineReducers, applyMiddleware } from 'redux';\nimport thunkMiddleware from 'redux-thunk';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport { handleModule } from 'vizzuality-redux-tools';\n\nimport * as app from 'modules/app';\nimport * as data from 'modules/data';\nimport * as pages from 'modules/pages';\nimport * as map from 'modules/map';\nimport * as layers from 'modules/layers';\nimport * as dashboard from 'modules/dashboard';\nimport router from './router';\n\nconst modules = [\n  { namespace: 'app', components: app },\n  { namespace: 'data', components: data },\n  { namespace: 'page', components: pages },\n  { namespace: 'map', components: map },\n  { namespace: 'layers', components: layers },\n  { namespace: 'dashboard', components: dashboard }\n];\n\nconst {\n  initialDispatch,\n  reducer: routerReducer,\n  middleware: routerMiddleware,\n  enhancer: routerEnhancer\n} = router;\n\nconst reducers = combineReducers({\n  router: routerReducer,\n  ...modules.reduce(\n    (acc, module) => ({ ...acc, [module.namespace]: handleModule(module.components) }),\n    {}\n  )\n});\n\nconst middleware = applyMiddleware( routerMiddleware, thunkMiddleware );\n\nconst enhancers = composeWithDevTools(routerEnhancer, middleware);\n\nconst store = createStore(reducers, enhancers);\n\ninitialDispatch();\n\nexport default store;\n","import { connect } from 'react-redux';\n\nimport { Modal } from 'aqueduct-components';\n\nconst mapStateToProps = state => ({});\n\nconst mapDispatchToProps = {};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Modal);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Clipboard from 'clipboard';\nimport { Icon } from 'vizzuality-components';\n\n\nexport default class ShareModal extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      copied: false\n    };\n  }\n\n  componentWillMount() {\n    this.props.getShareUrl(window.location.href);\n  }\n\n\n  componentDidMount() {\n    this.clipboard = new Clipboard(this.btn);\n    this.clipboard.on('success', (e) => {\n      this.setState({ copied: true });\n      setTimeout(() => {\n        this.setState({ copied: false });\n        e.clearSelection();\n      }, 2000);\n    });\n\n    this.clipboard.on('error', () => {\n      this.setState({ error: true });\n      setTimeout(() => {\n        this.setState({ error: false });\n      }, 2000);\n    });\n  }\n\n  // UI EVENTS\n  triggerPopup(e) {\n    e && e.preventDefault();\n    const width = 575;\n    const height = 400;\n    const left = (window.innerWidth - width) / 2;\n    const top = (window.innerHeight - height) / 2;\n\n    const url = e.currentTarget.href;\n    const opts = `status=1,width=${width},height=${height},top=${top},left=${left}`;\n\n    window.open(url, 'Share this analysis', opts);\n  }\n\n  render() {\n    const title = 'Water and Food Security Analyzer';\n    const url = this.props.share.url || window.location.href;\n    const urlEncoded = encodeURIComponent(this.props.share.url || window.location.href);\n\n    let text = 'Copy';\n    let classCopy = '';\n\n    if (this.state.copied) {\n      text = 'Copied';\n      classCopy = '-success';\n    }\n    if (this.state.error) {\n      text = 'Error';\n      classCopy = '-error';\n    }\n\n    return (\n      <div className=\"c-share\">\n        <div className=\"share-header\">\n          <h3 className=\"share-title\">Share this page</h3>\n        </div>\n        <div className=\"share-content\">\n          <div className=\"share-button\">\n            <input\n              id=\"url\"\n              className=\"share-url\"\n              value={url}\n              readOnly\n              onFocus={e => e.currentTarget.select()}\n            />\n            <button\n              data-clipboard-target=\"#url\"\n              ref={(node) => { this.btn = node; }}\n              className={`c-btn -primary ${classCopy}`}\n              type=\"button\"\n            >\n              {text}\n            </button>\n          </div>\n\n          <div className=\"share-sozial\">\n            <a\n              href={`https://twitter.com/share?url=${urlEncoded}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"c-btn -primary -with-icon -twitter -social\"\n              onClick={this.triggerPopup}\n            >\n              <Icon name=\"icon-twitter\" />\n              <span>Twitter</span>\n            </a>\n            <a\n              href={`https://www.facebook.com/sharer/sharer.php?u=${urlEncoded}&t=${title}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"c-btn -primary -with-icon -facebook -social\"\n              onClick={this.triggerPopup}\n            >\n              <Icon name=\"icon-facebook\" />\n              <span>Facebook</span>\n            </a>\n            <a\n              href={`https://www.linkedin.com/shareArticle?mini=true&url=${urlEncoded}&title=${title}&summary=&source=`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"c-btn -primary -with-icon -linkedin -social\"\n              onClick={this.triggerPopup}\n            >\n              <Icon name=\"icon-linkedin\" />\n              <span>Linkedin</span>\n            </a>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nShareModal.propTypes = {\n  share: PropTypes.object,\n  getShareUrl: PropTypes.func\n};\n\nShareModal.defaultProps = {\n  share: {},\n  getShareUrl: x => x\n};\n","import { createSelector } from 'reselect';\nimport processLocation from 'utils/process-location';\n\nconst dashboard = state => state.dashboard;\nconst data = state => state.data;\nconst countries = createSelector([data], _data => _data.countries.data);\n\nexport const currentLocation = createSelector([dashboard], _dashboard => _dashboard.locationId);\n\nexport const getCountryData = createSelector(\n  [currentLocation, countries],\n  (_currentLocation, _countries) => _currentLocation\n    ? processLocation(_currentLocation, _countries[_currentLocation])\n    : null\n);","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { Icon } from 'vizzuality-components';\nimport { CustomSelect } from 'aqueduct-components';\n\nconst countrySelectStyles = {\n  container: styles => ({\n    ...styles,\n    height: '40px'\n  }),\n  valueContainer: styles => ({\n    ...styles,\n    height: '40px',\n    marginLeft: '16px'\n  })\n};\n\nconst IndicatorsContainer = () => (\n  <div className=\"country-selector--icon\">\n    <Icon className=\"-small\" name=\"icon-search\" />\n  </div>\n);\n\nfunction CountrySelector({\n  countries,\n  setCountry\n}) {\n  const countryChangeHandler = (option) => {\n    setCountry({data: option.value});\n  };\n\n  return (\n    <CustomSelect\n      theme=\"light\"\n      placeholder=\"Search a country\"\n      options={countries.list}\n      onChange={countryChangeHandler}\n      customClass=\"c-country-selector\"\n      styles={countrySelectStyles}\n      components={{ IndicatorsContainer }}\n      value={countries.value}\n    />\n  );\n}\n\nCountrySelector.propTypes = {\n  countries: PropTypes.shape({}).isRequired,\n  setCountry: PropTypes.func,\n};\n\nCountrySelector.defaultProps = {\n  setCountry: () => {\n    console.log('Country value was changed.');\n  }\n};\n\nexport default CountrySelector;","import { connect } from 'react-redux';\n\nimport { setCountry } from 'modules/app/actions';\nimport CountrySelector from './component';\n\nconst mapStateToProps = state => ({\n  countries: state.dashboard.countries\n});\n\nconst mapDispatchToProps = { setCountry };\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CountrySelector);\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classnames from 'classnames';\n\nimport { Field, CustomSelect } from 'aqueduct-components';\n\nfunction IndicatorSelector({\n  indicators,\n  setIndicator,\n  className\n}) {\n  const indicatorChangeHandler = option => setIndicator({data: option.value});\n\n  return (\n    <Field\n      name=\"indication-filter\"\n      label=\"Select Water Risk Indicator\"\n      className=\"-bigger\"\n    >\n      <CustomSelect\n        theme=\"light\"\n        options={indicators.list}\n        onChange={indicatorChangeHandler}\n        customClass={classnames('c-indicator-selector', { [className]: Boolean(className)})}\n        value={indicators.value}\n      />\n    </Field>\n  );\n}\n\nIndicatorSelector.propTypes = {\n  indicators: PropTypes.shape({}).isRequired,\n  setIndicator: PropTypes.func,\n};\n\nIndicatorSelector.defaultProps = {\n  setIndicator: () => {\n    console.log('Indicator value was changed.');\n  }\n};\n\nexport default IndicatorSelector;","import { connect } from 'react-redux';\n\nimport { setIndicator } from 'modules/app/actions';\nimport IndicatorSelector from './component';\n\nconst mapStateToProps = state => ({\n  indicators: state.dashboard.indicators\n});\n\nconst mapDispatchToProps = {\n  setIndicator\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(IndicatorSelector);\n","import React from 'react';\n\nimport CountrySelector from 'components/country-selector';\nimport IndicatorSelector from 'components/indicator-selector';\n\nconst HeaderGeneral = () => {\n  return (\n    <header className=\"c-header\">\n      <div className=\"header--content\">\n        <CountrySelector />\n        <IndicatorSelector />\n        <p className=\"header--disclaimer\">This map is for illustrative purposes and does not imply the expression of any opinion on the part of WRI concerning the legal status of any country or territory, or concerning the delimitation of frontiers or boundaries.</p>\n      </div>\n    </header>\n  );\n};\n\nexport default HeaderGeneral;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Icon } from 'vizzuality-components';\nimport { Field } from 'aqueduct-components';\n\nimport IndicatorSelector from 'components/indicator-selector';\n\nconst HeaderCountry = ({ onBackClick, data }) => {\n  const backClickHandler = () => onBackClick();\n\n  const order = ['Irr', 'Dom', 'Ind', 'Tot'];\n  const headerIndicators = Object.fromEntries(Object.entries(data.indicators)\n    .filter(data => order.includes(data[0]))\n    .sort((a, b) => order.indexOf(a[0]) - order.indexOf(b[0])));\n\n  return (\n    <header className=\"c-header\">\n      <div className=\"header--back-button\" onClick={backClickHandler}>\n        <Icon className=\"-small\" name=\"icon-arrow-left\" />\n        <span className=\"-uppercase\">Country Rankings</span>\n      </div>\n      <div className=\"header--content\">\n        <div className=\"header--info\">\n          <h1>{data.name}</h1>\n          <Field\n            name=\"header-indicators\"\n            label=\"Summary Results\"\n            className=\"-bigger\"\n          >\n            <ul className=\"header--indicators\">\n              {Object.entries(headerIndicators).map(indicator => (\n                <li className=\"header--indicator\" key={indicator[0]}>\n                  {indicator[1].name}: {indicator[1].score}\n                </li>\n              ))}\n            </ul>\n          </Field>\n        </div>\n        <IndicatorSelector className=\"header--indicator-selector\"/>\n        <p className=\"header--disclaimer\">This map is for illustrative purposes and does not imply the expression of any opinion on the part of WRI concerning the legal status of any country or territory, or concerning the delimitation of frontiers or boundaries.</p>\n      </div>\n    </header>\n  );\n};\n\nHeaderCountry.propTypes = {\n  onBackClick: PropTypes.func\n};\n\nHeaderCountry.defaultProps = {\n  onBackClick: () => {\n    console.log('Go back button was pressed.');\n  }\n};\n\nexport default HeaderCountry;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst DashboardWidgets = ({className, height, width, fill}) => {\n  return (\n    <div\n      className={className}\n      style={{display: 'inline-block', backgroundColor: fill, height, width}}\n    />\n  );\n};\n\nDashboardWidgets.propTypes = {\n  height: PropTypes.string,\n  width: PropTypes.string,\n  fill: PropTypes.string\n};\n\nDashboardWidgets.defaultProps = {\n  height: '11px',\n  width: '11px',\n  fill: '#000000'\n};\n\nexport default DashboardWidgets;\n","import React, {Fragment} from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\nimport Bar from 'components/bar';\n\nconst Chart = ({indicators, config: {fields, palette, length}}) => {\n  if (!indicators) {\n    return null;\n  }\n\n  const fill = (palette, index) => palette[index % palette.length];\n\n  return (\n    <Fragment>\n      {fields.map((field, index) => {\n        if (!indicators[field]) {\n          return null;\n        }\n\n        const value = indicators[field].score;\n\n        return (\n          <div key={field}>\n            <span className='widget--chart-text'>{`${value}`}</span>\n            <Bar fill={fill(palette, index)} width={`${length(value)}px`} />\n          </div>\n        );\n      })}\n    </Fragment>\n  );\n};\n\nconst Widget = ({classes, rowNumber, country, chartConfig}) => {\n  return (\n    <div className={classnames('c-widget', { [classes.row]: Boolean(classes.row)})}>\n      <div className={classes.columns[0]}>{rowNumber}</div>\n      <div className={classes.columns[1]}>{country.name}</div>\n      <div className={classes.columns[2]}>\n        <Chart indicators={country.indicators} config={chartConfig} />\n      </div>\n      <div className={classes.columns[3]}>{country.indicators && country.indicators['Tot'] && country.indicators['Tot'].score}</div>\n    </div>\n  );\n};\n\nWidget.propTypes = {\n  rowNumber: PropTypes.number.isRequired,\n  country: PropTypes.shape({}).isRequired\n};\n\nexport default Widget;\n","export const palette = ['#3FA989', '#00A0E1', '#4A596A'];\nexport const chartOrder = ['Irr', 'Dom', 'Ind', 'Pop'];\nexport const tableClasses = {\n  row: 'widgets--content-row',\n  columns: [\n    'widgets--row-number',\n    'widgets--name',\n    'widgets--chart',\n    'widgets--total'\n  ]\n};\n\nexport default {\n  palette,\n  chartOrder,\n  tableClasses\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Widget from 'components/widget';\nimport Bar from 'components/bar';\nimport {\n  palette,\n  chartOrder,\n  tableClasses\n} from './constants';\n\nconst DashboardWidgets = ({title, buttonText, data, onSelect}) => {\n  if (data.length === 0) {\n    return null;\n  }\n\n  const headerIndicators = Object.entries(data[0].indicators)\n    .filter(data => chartOrder.includes(data[0]))\n    .sort((a, b) => chartOrder.indexOf(a[0]) - chartOrder.indexOf(b[0]));\n\n  const indicatorsLegend = headerIndicators.map((data, i) => (\n    <div className=\"widgets--content-legend\" key={data}>\n      <Bar className=\"widgets--content-bullet\" fill={palette[i]} />\n      {data[1].name}\n    </div>\n  ));\n\n  const chartConfig = {\n    fields: chartOrder,\n    palette,\n    length: value => (value / 5) * 76\n  };\n\n  const sortedData = data.sort((a, b) => {\n    const {Tot:aTot, Pop:aPop} = a.indicators;\n    const {Tot:bTot, Pop:bPop} = b.indicators;\n    if (aTot && bTot && aTot.score && bTot.score) {\n      return parseFloat(bTot.score) - parseFloat(aTot.score);\n    } else if (aPop && bPop && aPop.score && bPop.score) {\n      return parseFloat(bPop.score) - parseFloat(aPop.score);\n    }\n\n    return 0;\n  });\n\n  return (\n    <div className=\"c-widgets\">\n      <div className=\"widgets--header\">\n        <span className=\"-uppercase\">{title}</span>\n        <button type=\"button\" onClick={onSelect}>{buttonText}</button>\n      </div>\n      <div className=\"widgets--content-wrapper\">\n        <div className=\"widgets--content-header\">\n          <div className={tableClasses.columns[0]}>Rank</div>\n          <div className={tableClasses.columns[1]}>Name</div>\n          <div className={tableClasses.columns[2]}>Sectoral Score{indicatorsLegend}</div>\n          <div className={tableClasses.columns[3]}>Total Score</div>\n        </div>\n        <div className=\"widgets--content-body\">\n        {sortedData.map((country, index) => {\n          return (\n              <Widget\n                classes={tableClasses}\n                key={country.iso}\n                rowNumber={index + 1}\n                country={country}\n                chartConfig={chartConfig}\n              />\n          );\n        })}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nDashboardWidgets.propTypes = {\n  title: PropTypes.string,\n  buttonText: PropTypes.string,\n  data: PropTypes.arrayOf(PropTypes.shape({})).isRequired\n};\n\nDashboardWidgets.defaultProps = {\n  title: 'Water Usage (Score)',\n  buttonText: 'Download ranking'\n};\n\nexport default DashboardWidgets;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Field } from 'aqueduct-components';\n\nimport { SCOPE } from 'modules/dashboard/constants';\nimport CountrySelector from 'components/country-selector';\n\nconst Footer = ({\n  scope\n}) => {\n  if (scope === SCOPE.GENERAL) {\n    return null;\n  }\n\n  return (\n    <footer className=\"c-footer\">\n      <Field\n        name=\"countries-filter\"\n        label=\"Explore more\"\n        className=\"-bigger\"\n      >\n        <CountrySelector />\n      </Field>\n    </footer>\n  );\n};\n\nFooter.propTypes = {\n  scope: PropTypes.string.isRequired\n};\n\nexport default Footer;\n","import React, { useEffect, useRef } from 'react';\n\nimport HeaderGeneral from 'components/header-general';\nimport HeaderCountry from 'components/header-country';\nimport DashboardWidgets from 'components/dashboard-widgets';\nimport Footer from 'components/footer';\n\nimport { SCOPE } from 'modules/dashboard/constants';\n\nconst Dashboard = ({\n  width,\n  setWidth,\n  scope,\n  headerData,\n  widgetsData,\n  setCountry,\n  saveData\n}) => {\n  const dashboardEl = useRef(null);\n  useEffect(() => {\n    const currentWidth = dashboardEl.current.offsetWidth;\n\n    if (currentWidth !== width) {\n      setWidth({data: currentWidth});\n    }\n  });\n  const backClickHandler = () => setCountry({data: null});\n  const rankingTitle = (scope === SCOPE.GENERAL) ? 'Country Rankings' : 'Sub-national Rankings';\n\n  return (\n    <div ref={dashboardEl} className=\"dashboard\">\n      { scope === SCOPE.GENERAL ?\n        <HeaderGeneral /> :\n        <HeaderCountry data={headerData} onBackClick={backClickHandler} />\n      }\n      <DashboardWidgets data={widgetsData} onSelect={saveData} title={rankingTitle} />\n      <Footer scope={scope} />\n    </div>\n  );\n};\n\nexport default Dashboard;\n","import { connect } from 'react-redux';\n\nimport { setCountry, saveData } from 'modules/app/actions';\nimport { setWidth } from 'modules/dashboard/actions';\nimport { getCountryData } from 'modules/dashboard/selectors';\n\nimport Dashboard from './component';\n\nconst mapStateToProps = state => ({\n  scope: state.dashboard.scope,\n  width: state.dashboard.width,\n  headerData: getCountryData(state),\n  widgetsData: state.dashboard.widget.data\n});\n\nconst mapDispatchToProps = {\n  setCountry,\n  saveData,\n  setWidth\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nclass LegendTypeChoropleth extends React.PureComponent {\n  static propTypes = {\n    activeLayer: PropTypes.object\n  }\n\n  static defaultProps = {\n    activeLayer: {}\n  }\n\n  render() {\n    const { activeLayer } = this.props;\n    const { legendConfig } = activeLayer;\n\n    if (!legendConfig || legendConfig.type !== 'choropleth') {\n      return null;\n    }\n\n    return (\n      <div>\n        <ul className=\"c-legend-type-choropleth\">\n          {legendConfig.items.map(({ name, value, color }) => (\n            <li key={`legend-choropleth-item-${name || value}`}>\n              <div className=\"icon-choropleth\" style={{ backgroundColor: color }} />\n              <span className=\"name\">\n                {name}\n              </span>\n              <span className=\"name\">\n                {value}\n              </span>\n            </li>\n          ))}\n        </ul>\n        {legendConfig.disclaimer && (\n          <div className=\"graph -basic -disclaimer\">\n            <div className=\"graph-list\">\n              {legendConfig.disclaimer.map(item => (\n                <div className=\"graph-list-item\" key={item.name}>\n                  <span className=\"color\" style={{ background: item.color }} />\n                  <span className=\"label\">{item.name}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default LegendTypeChoropleth;\n","import Component from './component';\r\n\r\nexport default Component;","export const BASEMAP_CONFIG = {\n  url: process.env['REACT_APP_BASEMAP_TILE_URL'],\n  options: { attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\" rel=\"noopener noreferrer\">OpenStreetMap</a>' }\n};\n\nexport const LABEL_LAYER_CONFIG = {\n  url: process.env['REACT_APP_BASEMAP_LABEL_URL'],\n  options: { attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\" rel=\"noopener noreferrer\">OpenStreetMap</a>' }\n};\n\nexport const BASEMAPS = {\n  // Open Street Maps\n  osm: {\n    id: 'osm',\n    value: process.env['REACT_APP_BASEMAP_TILE_URL'],\n    label: 'Light',\n    options: { attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\" rel=\"noopener noreferrer\">OpenStreetMap</a>' }\n  },\n  satellite: {\n    id: 'satellite',\n    value: 'https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',\n    label: 'Satellite',\n    options: { attribution: '&copy; <a href=\"https://www.google.com/maps/@15,-2.970703,3z?hl=es\" target=\"_blank\">Google</a>' }\n  },\n  terrain: {\n    id: 'terrain',\n    value: 'https://api.mapbox.com/styles/v1/resourcewatch/cjhqi456h02pg2rp6w2mwp61c/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoicmVzb3VyY2V3YXRjaCIsImEiOiJjajFlcXZhNzcwMDBqMzNzMTQ0bDN6Y3U4In0.FRcIP_yusVaAy0mwAX1B8w',\n    label: 'Terrain',\n    options: { attribution: '<a href=\"https://www.mapbox.com/about/maps/\" target=\"_blank\"> Mapbox</a> <a href=\"http://www.openstreetmap.org/about/\" target=\"_blank\"> OpenStreetMap</a>' }\n  },\n  hydro: {\n    id: 'hydro',\n    value: 'https://api.mapbox.com/styles/v1/resourcewatch/cjtr6fhr3060g1fok829tfwm7/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoicmVzb3VyY2V3YXRjaCIsImEiOiJjajFlcXZhNzcwMDBqMzNzMTQ0bDN6Y3U4In0.FRcIP_yusVaAy0mwAX1B8w',\n    label: 'Hydrography',\n    options: { attribution: '<a href=\"https://www.mapbox.com/about/maps/\" target=\"_blank\"> Mapbox</a> <a href=\"http://www.openstreetmap.org/about/\" target=\"_blank\"> OpenStreetMap</a>' }\n  }\n};\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport TetherComponent from 'react-tether';\n\n// components\nimport { Icon, RadioGroup } from 'aqueduct-components';\n\n// constants\nimport { BASEMAPS } from 'components/map/constants';\n\nclass BasemapControl extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = { active: false };\n\n    this._onScreenClick = this.onScreenClick.bind(this);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.onScreenClick);\n  }\n\n  onScreenClick(e) {\n    const el = document.querySelector('.c-basemap-tooltip');\n    const clickOutside = el && el.contains && !el.contains(e.target);\n\n    if (clickOutside) this.toggleDropdown(false);\n  }\n\n  onBasemapChange({ value }) {\n    this.props.setBasemap(value);\n  }\n\n  toggleDropdown(to) {\n    const active = (typeof to !== 'undefined' && to !== null) ? to : !this.state.active;\n\n    this.setState({ active });\n\n    requestAnimationFrame(() => {\n      if (to) {\n        window.addEventListener('click', this._onScreenClick);\n      } else {\n        window.removeEventListener('click', this._onScreenClick);\n      }\n    });\n    this.setState({ active });\n  }\n\n  // RENDER\n  render() {\n    const { basemap } = this.props;\n    const { active } = this.state;\n\n    return (\n      <TetherComponent\n        attachment=\"top right\"\n        constraints={[{\n          to: 'window'\n        }]}\n        targetOffset=\"8px 100%\"\n        classes={{\n          element: 'c-basemap-tooltip -arrow-right'\n        }}\n      >\n        {/* First child: This is what the item will be tethered to */}\n        <button type=\"button\" className=\"basemap-button\" onClick={() => this.toggleDropdown(true)}>\n          <Icon name=\"layers\" className=\"-small\" />\n        </button>\n\n        {/* Second child: If present, this item will be tethered to the the first child */}\n        {active &&\n          <div>\n            <RadioGroup\n              items={Object.keys(BASEMAPS).map((k) => {\n                const bs = BASEMAPS[k];\n                return {\n                  label: bs.label,\n                  value: bs.id\n                };\n              })}\n              name=\"basemap\"\n              selected={basemap}\n              onChange={(_basemap) => { this.onBasemapChange(_basemap); }}\n              // className=\"-secondary\"\n            />\n\n            <div className=\"divisor\" />\n\n          </div>\n        }\n      </TetherComponent>\n    );\n  }\n}\n\nBasemapControl.propTypes = {\n  basemap: PropTypes.string.isRequired,\n  setBasemap: PropTypes.func.isRequired\n};\n\nexport default BasemapControl;\n","import { connect } from 'react-redux';\nimport { setBasemap } from 'modules/map/actions';\nimport BasemapControl from './component';\n\nexport default connect(\n  state => ({ basemap: state.map.basemap }),\n  { setBasemap }\n)(BasemapControl);\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport LegendTypeChoropleth from '../legend-type-choropleth';\nimport {\n  Map as LeMap,\n  MapControls,\n  ZoomControl,\n  Icon,\n  Legend,\n  LegendListItem,\n  LegendItemTypes,\n  MapPopup,\n  LegendItemToolbar,\n  LegendItemButtonOpacity\n} from 'vizzuality-components';\nimport BasemapControl from './basemap-control';\nimport { PluginLeaflet } from 'layer-manager';\nimport { LayerManager, Layer } from 'layer-manager/dist/components';\n\nimport { BASEMAPS, LABEL_LAYER_CONFIG } from './constants';\n\nclass Map extends Component {\n  static propTypes = {\n    children: PropTypes.func,\n    viewport: PropTypes.shape({}),\n    bounds: PropTypes.shape({\n      bbox: PropTypes.array,\n      options: PropTypes.shape({})\n    }),\n    dragPan: PropTypes.bool,\n    dragRotate: PropTypes.bool, // A boolean that allows rotating\n    setMapViewport: PropTypes.func,\n    onViewportChange: PropTypes.func,\n    onLoad: PropTypes.func,\n    onStyleLoad: PropTypes.func,\n    layers: PropTypes.array,\n    setModalState: PropTypes.func\n  }\n\n  static defaultProps = {\n    children: null,\n    viewport: { zoom: 2, lat: 0, lng: 0 },\n    bounds: {},\n    dragPan: true,\n    dragRotate: true,\n    onViewportChange: () => {},\n    onLoad: () => {},\n    onStyleLoad: () => {},\n    setMapViewport: () => {},\n    layers: []\n  }\n\n  state = {\n    latlng: null,\n    interactions: {}\n  }\n\n  render() {\n    const { className = '', viewport, layers, bounds, basemap, scope, setLayersOpacity, setModalState } = this.props;\n    const basemapConfig = {\n      ...BASEMAPS[basemap ||'osm'],\n      url: BASEMAPS[basemap || 'osm'].value\n    };\n    const mapProps = {\n      customClass: className,\n      mapOptions: {\n        zoom: viewport.zoom,\n        center: {\n          lat: viewport.latitude,\n          lng: viewport.longitude\n        }\n      },\n      bounds,\n      basemap: basemapConfig,\n      events: {\n        zoomend: (e, map) => { /*console.info(e, map);*/ },\n        dragend: (e, map) => { /*console.info(e, map);*/ }\n      }\n    };\n\n    const layerGroups = (layers && layers.length) ? layers.map(l => ({\n      name: l.name,\n      dataset: l.dataset,\n      layers: [{...l, active: true}]\n    })) : [];\n\n    if (scope !== 'COUNTRY') mapProps.label = LABEL_LAYER_CONFIG;\n\n    const shareClickHandler = () => {\n      setModalState(true);\n    };\n\n    // NOTE: We need to prefix icon name with 'icon-' because Icon from vizzuality\n    // does not do that automatically but Icon from aqueduct does.\n    return (\n      <LeMap {...mapProps}>\n        {_map => {\n          window.m = _map;\n\n          return (\n          <Fragment>\n            <LayerManager\n                map={_map}\n                plugin={PluginLeaflet}\n                onReady={() => { /*if (loading) setLoading(false);*/ }}\n            >\n              {layers.map(layer => (\n                <Layer\n                  key={layer.id}\n                  {...layer}\n                  {...!!layer.interactionConfig && !!layer.interactionConfig.output && !!layer.interactionConfig.output.length && {\n                    interactivity: (layer.provider === 'carto' || layer.provider === 'cartodb') ? layer.interactionConfig.output.map(o => o.column) : true,\n                    events: {\n                      click: (e) => {\n                        this.setState({\n                          interactionData: e.data,\n                          latlng: e.latlng\n                        })\n                      }\n                    }\n                  }}\n                />\n              ))}\n            </LayerManager>\n            <MapControls>\n              <ZoomControl map={_map} />\n              <BasemapControl />\n              <button type=\"button\" onClick={shareClickHandler}><Icon className=\"-medium\" name=\"icon-share\" /></button>\n              {/* <Icon className=\"-medium\" name=\"icon-download\" /> */}\n            </MapControls>\n            <MapPopup\n              map={_map}\n              latlng={this.state.latlng}\n              data={{\n                latlng: this.state.latlng,\n                interactions: this.state.interactions\n              }}\n            >\n              {\n                (this.state.interactionData) ?\n                  <div>\n                    {this.state.interactionData.name_1 ? (\n                      <div>\n                        <h3>{this.state.interactionData.name_1}</h3>\n                        <h4>{this.state.interactionData.name_0}</h4>\n                      </div>\n                    ): (\n                      <h3>{this.state.interactionData.name_0}</h3>\n                    )}\n                    <div>{this.state.interactionData.label}</div>\n                  </div>\n                  : <div>No data</div>\n              }\n            </MapPopup>\n            <div className=\"c-legend\">\n              <Legend sortable={false}>\n                {layerGroups.map((lg, i) => (\n                  <LegendListItem\n                    index={i}\n                    key={lg.dataset}\n                    layerGroup={lg}\n                    onChangeOpacity={(_layer, _opacity) => setLayersOpacity(_opacity)}\n                    toolbar={(\n                      <LegendItemToolbar>\n                        <LegendItemButtonOpacity\n                          trackStyle={{ backgroundColor: '#2E57B8' }}\n                          handleStyle={{ backgroundColor: '#2E57B8' }}\n                        />\n                      </LegendItemToolbar>\n                    )}\n                  >\n                    <LegendItemTypes>\n                      <LegendTypeChoropleth />\n                    </LegendItemTypes>\n                  </LegendListItem>\n                ))}\n              </Legend>\n            </div>\n          </Fragment>\n        )}}\n      </LeMap>\n    );\n  }\n}\n\nexport default Map;\n","import { createSelector } from 'reselect';\n\nconst layers = state => state.layers.list;\nconst currentCountry = state => state.dashboard.locationId;\nconst currentScope = state => state.dashboard.scope;\nconst currentIndicator = state => state.dashboard.indicators.value;\n\nconst indexes = { bws: 0, drr: 1, rfr: 2 };\n\nexport const getActiveLayers = createSelector(\n  [layers, currentScope, currentCountry, currentIndicator],\n  (_layers, _currentScope, _currentCountry, _currentIndicator) => {\n    if (!_layers) {\n      return [];\n    }\n\n    const indicatorIndex = indexes[_currentIndicator];\n\n    // Country view: show provinces in this case\n    if (_currentScope === 'COUNTRY') {\n      const layerSpec = _layers.province_rankings[indicatorIndex];\n      return [{\n        ...layerSpec,\n        opacity: layerSpec.opacity || 0.5,\n        params: { ...layerSpec.params, iso: _currentCountry }\n      }];\n    }\n\n    // Global view: show country layer\n    return [{\n      ..._layers.country_rankings[indicatorIndex],\n      opacity: _layers.country_rankings[indicatorIndex].opacity || 0.5\n    }];\n  }\n);\n","import { connect } from 'react-redux';\nimport { setModalState } from 'modules/app/actions';\nimport {\n  setMapViewport, setMapBounds, setMapLoaded, setMapFlying\n} from 'modules/map/actions';\n\nimport Map from './component';\nimport { setLayersOpacity } from 'modules/layers/actions';\nimport { getActiveLayers } from 'modules/layers/selectors';\n\nconst mapStateToProps = state => ({\n  ...state.map,\n  layers: getActiveLayers(state),\n  scope: state.dashboard.scope\n});\n\nconst mapDispatchToProps = {\n  setMapViewport,\n  setMapBounds,\n  setMapLoaded,\n  setMapFlying,\n  setLayersOpacity,\n  setModalState\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Map);\n","import React from 'react';\nimport { Sidebar } from 'aqueduct-components';\n\nimport ModalManager from 'components/modal-manager';\nimport ShareModal from 'components/share-modal';\nimport Dashboard from 'components/dashboard';\nimport Map from 'components/map';\n\nconst Main = ({ isDashboardCollapsed, isModalOpen, setDashboardCollapsed, setModalState}) => {\n  const closeModalHandler = () => setModalState(false);\n  return (\n    <main className=\"c-main\">\n      <Sidebar\n        customClass=\"c-aqueduct-sidebar\"\n        onToggle={isExpanded => {\n          setDashboardCollapsed(!isExpanded);\n        }}\n        visible={!isDashboardCollapsed}\n      >\n        <Dashboard />\n      </Sidebar>\n      <div className=\"map-wrapper\">\n        <Map className=\"c-aqueduct-map\" />\n      </div>\n      <ModalManager isOpen={isModalOpen} appElement=\"#root\" onRequestClose={closeModalHandler}>\n        <ShareModal />\n      </ModalManager>\n    </main>\n  );\n}\n\nexport default Main;\n","import { connect } from 'react-redux';\nimport {\n  setDashboardCollapsed\n} from 'modules/app/actions';\nimport { getLayers } from 'modules/layers/actions';\nimport { setModalState } from 'modules/app/actions';\n\n\nimport Main from './component';\n\nconst mapStateToProps = state => ({\n  ...state.app\n});\n\nconst mapDispatchToProps = {\n  setDashboardCollapsed,\n  getLayers,\n  setModalState\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Main);\n","import React, { useEffect } from 'react';\n\nimport Main from 'components/main';\n\nconst HomePage = ({getLayers, loadDashboardData}) => {\n  useEffect(() => {\n    getLayers();\n    loadDashboardData();\n  }, [getLayers, loadDashboardData]);\n\n\n  return <Main />;\n}\n\nexport default HomePage;\n","import React from 'react';\n\nconst NotFoundPage = () => <div><h1>Not found</h1></div>;\n\nexport default NotFoundPage;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\n// todo: add Universal component or loadable\nimport HomePage from 'pages/home';\nimport NotFoundPage from 'pages/not-found';\n\nconst pageMap = new Map([\n  ['HOME', HomePage],\n  ['LOCATION', HomePage]\n]);\n\n\n// prompts or error logging should be handled here\nconst Layout = props => {\n  const { page: { current } } = props;\n  const Page = pageMap.has(current) ? pageMap.get(current) : NotFoundPage;\n\n  return <Page {...props} />;\n};\n\nLayout.propTypes = {\n  page: PropTypes.shape({\n    current: PropTypes.string.isRequired,\n    payload: PropTypes.shape({}).isRequired\n  }).isRequired\n};\n\nexport default Layout;\n","import { connect } from 'react-redux';\nimport Layout from './component';\n\nimport { loadDashboardData } from 'modules/data/actions';\nimport { getLayers } from 'modules/layers/actions';\n\nconst mapStateToProps = ({ page }) => ({ page });\nconst mapDispatchToProps = {\n  getLayers,\n  loadDashboardData\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Layout);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { Icons } from 'aqueduct-components';\n\nimport * as serviceWorker from 'config/serviceWorker';\nimport store from 'config/store';\nimport Pages from 'components/layout';\n\nimport 'react-app-polyfill/stable';\nimport 'aqueduct-components/dist/bundle';\nimport 'styles/index.scss';\n\nconst App = () => (\n  <Provider store={store}>\n    <Icons />\n    <Pages />\n  </Provider>\n);\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}