{"version":3,"sources":["utils/analytics.js","services/export-service/index.js","services/wri-service/constants.js","utils/process-location.js","modules/dashboard/actions.js","modules/dashboard/constants.js","modules/map/actions.js","services/wri-service/wri-json-api-serializer.js","services/wri-service/aggregate-by-key.js","services/wri-service/index.js","modules/data/actions.js","modules/app/actions.js","modules/app/reducers.js","modules/app/initial-state.js","modules/data/reducers.js","modules/data/initial-state.js","modules/pages/constants.js","modules/pages/actions.js","modules/pages/reducers.js","modules/pages/initial-state.js","modules/map/reducers.js","modules/map/initial-state.js","modules/layers/actions.js","modules/layers/reducers.js","modules/layers/initial-state.js","modules/dashboard/reducers.js","modules/dashboard/initial-state.js","config/router.js","config/store.js","components/modal-manager/index.js","components/share-modal/component.js","components/indicators-info-modal/component.js","modules/dashboard/selectors.js","components/country-selector/component.js","components/country-selector/index.js","components/indicator-selector/component.js","components/indicator-selector/index.js","components/header-general/component.js","components/header-country/component.js","components/bar/component.js","components/widget/component.js","components/dashboard-widgets/constants.js","components/dashboard-widgets/component.js","components/footer/component.js","components/dashboard/component.js","components/dashboard/index.js","components/legend-type-choropleth/component.js","components/legend-type-choropleth/index.js","components/map/constants.js","components/map/basemap-control/component.js","components/map/basemap-control/index.js","components/map/component.js","modules/layers/selectors.js","components/map/index.js","components/main/component.js","components/main/index.js","pages/home/index.js","pages/not-found/index.js","components/layout/component.js","components/layout/index.js","index.js"],"names":["logEvent","category","arguments","length","undefined","action","label","ReactGA","event","Object","objectSpread","service","data","dataStr","encodeURIComponent","JSON","stringify","this","triggerDownload","flattenedData","map","row","indicators","opts","objectWithoutProperties","fromEntries","entries","flatMap","entry","feat","concat","fields","keys","csv","json2csv","parse","process","name","el","document","createElement","setAttribute","body","appendChild","click","removeChild","INDICATORS","value","INDICATOR_CATEGORIES","Tot","Dom","Ind","Irr","Liv","Pop","Avg","ERRORS","MISSING_REQUIRED_PARAMETER","MISSING_WIDGET_REQUEST_PARAMETERS","getAverage","filter","reduce","acc","indicator","index","_ref","score","setScore","toFixed","getIndicators","defineProperty","rank","_objectSpread2","processLocation","iso","nameProp","setCountries","createAction","setIndicators","setLocation","setCountryValue","setIndicatorValue","setWidgetData","setWidgetStats","setWidth","actions","SCOPE","GENERAL","COUNTRY","setMap","setMapBounds","setMapStyle","setMapLabels","setMapRoads","setBasemap","setMapViewport","setMapLoaded","setMapFlying","getCountryBounds","createThunkAction","dispatch","getState","_state$dashboard","dashboard","locationId","offset","width","boundsSQL","axios","get","then","rows","bbox","geometry","window","L","geoJSON","getBounds","toBBoxString","split","b","parseFloat","options","paddingTopLeft","map_actions","serialize","id","type","attributes","assign","itemSerializer","_ref2","d","prototype","hasOwnProperty","call","widget","layer","metadata","locale","find","m","language","vocabulary","legendConfig","items","item","i","wriAPISerializer","_ref3","Array","isArray","aggregateByKey","collection","key","mapFn","x","stats","sum","max","min","rowKey","rowValue","country","province","push","_stats","WRIService","classCallCheck","client","create","baseURL","headers","Content-Type","params","response","status","statusText","Error","serializer","datasets","_this","_Object$entries$reduc","toConsumableArray","fetchLayersFromDataset","_Object$entries$reduc2","slicedToArray","datasetNames","datasetPromises","all","_this2","widgetId","widgetParams","widgetData","url","processWidgetData","indexKey","weight","score_ranked","_widgetData$widgetCon","widgetConfig","params_config","param","required","replace","setCountriesData","loadDashboardData","state","router","query","getCountriesData","countries4widget","setCountry","toUpperCase","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","abrupt","fetchDatasetWidgets","res","countries","sort","localeCompare","sent","stop","_x","_x2","apply","getProvincesData","_callee2","_context2","_x3","_x4","data_actions","setDashboardCollapsed","setModalState","payload","setUrl","getData","setIndicator","scope","_state2$router","newQuery","Boolean","saveData","exportService","saveRankings","reducerMap","_reducerMap","isDashboardCollapsed","_ref3$payload","isOpen","content","isModalOpen","modalContent","initial_state","data_reducers","_actions$setCountries","isLoading","isLoaded","data_initial_state","error","provinces","cache","PAGES","path","page","NOT_FOUND","pageActions","setPage","current","setPageReducer","pages_initial_state","map_reducers","_actions$setMap$actio","bounds","basemap","_ref4","mapStyle","_ref5","mapLabels","_ref6","mapRoads","_ref7","viewport","_ref8","settings","_ref9","isFlying","map_initial_state","zoom","latitude","longitude","setList","setLoading","setError","setLayersOpacity","getLayers","fetchDatasetsLayers","country_rankings","province_rankings","layers","catch","err","layers_actions","layers_reducers","_setList$setLoading$s","list","l","opacity","layers_initial_state","dashboard_reducers","reducers_actions$setCountries","dashboard_initial_state","routes","thunk","basename","location","notFoundPath","initialDispatch","querySerializer","queryString","connectRoutes","modules","namespace","components","app","pages","routerReducer","reducer","routerMiddleware","middleware","routerEnhancer","enhancer","reducers","combineReducers","module","handleModule","applyMiddleware","thunkMiddleware","enhancers","composeWithDevTools","store","createStore","connect","Modal","ShareModal","props","possibleConstructorReturn","getPrototypeOf","copied","getShareUrl","href","clipboard","Clipboard","btn","on","e","setState","setTimeout","clearSelection","preventDefault","left","innerWidth","top","innerHeight","currentTarget","open","_this3","title","share","urlEncoded","text","classCopy","react_default","className","readOnly","onFocus","select","data-clipboard-target","ref","node","target","rel","onClick","triggerPopup","dist_bundle","React","Component","defaultProps","component","createSelector","_data","currentLocation","_dashboard","getCountryData","_currentLocation","_countries","countrySelectStyles","container","styles","height","valueContainer","marginLeft","IndicatorsContainer","CountrySelector","bundle","theme","placeholder","onChange","option","customClass","console","log","mapDispatchToProps","IndicatorSelector","onMoreInfo","classnames","HeaderGeneral","country_selector","indicator_selector","HeaderCountry","onBackClick","order","headerIndicators","includes","indexOf","DashboardWidgets","fill","style","display","backgroundColor","Chart","_ref$config","config","palette","react","field","bar_component","Widget","classes","rowNumber","chartConfig","columns","component_Chart","values","chartOrder","tableClasses","buttonText","onSelect","indicatorsLegend","sortedData","_a$indicators","aTot","aPop","_b$indicators","bTot","bPop","widget_component","Footer","Dashboard","headerData","dashboardEl","useRef","useEffect","currentWidth","offsetWidth","rankingTitle","header_general_component","header_country_component","dashboard_widgets_component","footer_component","LegendTypeChoropleth","activeLayer","color","disclaimer","background","PureComponent","LABEL_LAYER_CONFIG","attribution","BASEMAPS","osm","satellite","terrain","hydro","BasemapControl","active","_onScreenClick","onScreenClick","bind","assertThisInitialized","removeEventListener","querySelector","contains","toggleDropdown","to","requestAnimationFrame","addEventListener","react_tether_default","attachment","constraints","targetOffset","element","k","bs","selected","_basemap","onBasemapChange","Map","latlng","interactions","_this$props","_this$props$className","basemapConfig","mapProps","mapOptions","center","lat","lng","events","zoomend","dragend","layerGroups","dataset","shareClickHandler","_map","plugin","PluginLeaflet","onReady","interactionConfig","output","interactivity","provider","o","column","interactionData","basemap_control","name_1","Fragment","name_0","sortable","lg","layerGroup","onChangeOpacity","_layer","_opacity","toolbar","trackStyle","handleStyle","legend_type_choropleth","children","dragPan","dragRotate","onViewportChange","onLoad","onStyleLoad","indexes","bws","drr","rfr","getActiveLayers","_layers","_currentScope","_currentCountry","_currentIndicator","indicatorIndex","layerSpec","Main","onToggle","isExpanded","visible","components_dashboard","modal_manager","appElement","onRequestClose","component_ShareModal","getModalContent","HomePage","set","pathname","search","pageview","main","NotFoundPage","pageMap","Layout","Page","has","initialize","REACT_APP_GOOGLE_ANALYTICS","ReactDOM","render","es","appRoute","layout","getElementById"],"mappings":"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","file":"static/js/main.b1e26e39.chunk.js","sourcesContent":["import ReactGA from 'react-ga';\n\nexport const initGA = () => {\n  if (process.env.NODE_ENV === 'production') {\n    ReactGA.initialize(process.env.REACT_APP_GOOGLE_ANALYTICS);\n  } else {\n    console.info('[GA] Init');\n  }\n};\n\nexport const logPageView = () => {\n  if (process.env.NODE_ENV === 'production') {\n    ReactGA.set({ page: `${window.location.pathname}${window.location.search}`});\n    ReactGA.pageview(`${window.location.pathname}${window.location.search}`);\n  } else {\n    console.info(`[GA] Page view: ${window.location.pathname}${window.location.search}`);\n  }\n};\n\nexport const logEvent = (category = '', action = '', label = '') => {\n  if (process.env.NODE_ENV === 'production') {\n    if (category && action) {\n      ReactGA.event({\n        category,\n        action,\n        ...!!label && { label }\n      });\n    }\n  } else {\n    console.info(`[GA] Event: ${category}, ${action}, ${label}`);\n  }\n};\n","import json2csv from 'json2csv';\n\nclass ExportService {\n  saveAsJSON(data) {\n    const dataStr = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(data));\n    this.triggerDownload('dataset.json', dataStr);\n  }\n\n  saveAsCSV(data) {\n    const flattenedData = data.map(row => {\n      const {indicators, ...opts} = row;\n\n      if (!indicators) {\n        return {...opts};\n      }\n\n      return {\n        ...opts,\n        ...Object.fromEntries(\n          Object.entries(row.indicators).flatMap(\n            entry => Object.entries(entry[1]).map(\n              feat => [`${entry[0]}_${feat[0]}`,feat[1]]\n            )\n          )\n        )\n      };\n    });\n\n    const fields = Object.keys(flattenedData[0]);\n    \n    const csv = json2csv.parse(flattenedData, { fields });\n    const dataStr = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);\n    this.triggerDownload('dataset.csv', dataStr);\n  }\n\n  /**\n   * Save a static file\n   */\n  saveRankings() {\n    const dataStr = `${process.env.PUBLIC_URL}/Aqueduct30_Rankings_V01.xlsx`;\n    this.triggerDownload('Aqueduct30_Rankings_V01.xlsx', dataStr);\n  }\n  \n  /**\n   * Trigger download\n   * @param {string} name \n   * @param {string} dataStr \n   */\n  triggerDownload(name, dataStr) {\n    const el = document.createElement('a');\n    el.setAttribute('href', dataStr);\n    el.setAttribute('download', name);\n    document.body.appendChild(el);\n    el.click();\n    document.body.removeChild(el);\n  }\n}\n\nexport const service = new ExportService();\nexport default service;","export const INDICATORS = [\n  {\n    label: 'Baseline Water Stress',\n    value: 'bws'\n  },\n  {\n    label: 'Drought Risk',\n    value: 'drr'\n  },\n  {\n    label: 'Riverine Flood Risk',\n    value: 'rfr'\n  }\n];\n\nexport const INDICATOR_CATEGORIES = {\n  'Tot': 'Total',\n  'Dom': 'Domestic',\n  'Ind': 'Industrial',\n  'Irr': 'Agricultural',\n  'Liv': 'Livestock',\n  'Pop': 'Population',\n  'Avg': 'Average'\n};\n\nexport const ERRORS = {\n  MISSING_REQUIRED_PARAMETER: 'Required parameter is not present.',\n  MISSING_WIDGET_REQUEST_PARAMETERS: 'Cannot make widget data request. Missing parameters.'\n};\n\nexport default {\n  INDICATORS,\n  INDICATOR_CATEGORIES,\n  ERRORS\n};","import { INDICATOR_CATEGORIES } from 'services/wri-service/constants';\n\n/**\n * Get average of given values, skips 'Tot' total value.\n * @param {*} data \n */\nfunction getAverage(data) {\n  return data.filter(entry => entry.category !== 'Tot')\n    .reduce((acc, indicator, index, {length}) => (index === length -1)\n      ? (acc + indicator.score)/ length\n      : acc + indicator.score, 0);\n}\n\nfunction setScore(score) {\n  if (!score) {\n    return 'NO DATA';\n  }\n\n  return score.toFixed(2);\n}\n\nfunction getIndicators(data) {\n  if (data.length === 1) {\n    const indicator = data[0];\n    return {\n      [indicator.category]: {\n        name: INDICATOR_CATEGORIES[indicator.category],\n        score: setScore(indicator.score),\n        rank: indicator.rank\n      }\n    };\n  }\n\n  return data.reduce((acc, indicator) => ({\n    ...acc,\n    [indicator.category]: {\n      name: INDICATOR_CATEGORIES[indicator.category],\n      score: setScore(indicator.score),\n      rank: indicator.rank\n    },\n    Avg: {\n      name: INDICATOR_CATEGORIES['Avg'],\n      score: getAverage(data).toFixed(2)\n    }\n  }), {});\n}\n\n/**\n * \n * @param {string} iso - Identifier\n * @param {*} data - Object where indicators are keys.\n */\nexport function processLocation(iso, data, nameProp='country') {\n  return {\n    iso,\n    name: data[0][nameProp],\n    indicators: getIndicators(data)\n  };\n}\n\nexport default processLocation;","import { createAction } from 'vizzuality-redux-tools';\n\nexport const setCountries = createAction('DASHBOARD/setCountries');\nexport const setIndicators = createAction('DASHBOARD/setIndicators');\nexport const setLocation = createAction('DASHBOARD/setLocation');\nexport const setCountryValue = createAction('DASHBOARD/setCountryValue');\nexport const setIndicatorValue = createAction('DASHBOARD/setIndicatorValue');\nexport const setWidgetData = createAction('DASHBOARD/setWidgetData');\nexport const setWidgetStats = createAction('DASHBOARD/setWidgetStats');\nexport const setWidth = createAction('DASHBOARD/setWidth');\n\nexport default {\n  setLocation,\n  setCountryValue,\n  setIndicatorValue\n};\n","export const SCOPE = {\n  GENERAL: 'GENERAL',\n  COUNTRY: 'COUNTRY'\n};\n\nexport default {\n  SCOPE\n};","import axios from 'axios';\nimport { createAction, createThunkAction } from 'vizzuality-redux-tools';\n\nexport const setMap = createAction('MAP/setMap');\nexport const setMapBounds = createAction('MAP/setMapBounds');\nexport const setMapStyle = createAction('MAP/setMapStyle');\nexport const setMapLabels = createAction('MAP/setMapLabels');\nexport const setMapRoads = createAction('MAP/setMapRoads');\nexport const setBasemap = createAction('MAP/setBasemap');\nexport const setMapViewport = createAction('MAP/setMapViewport');\nexport const setMapLoaded = createAction('MAP/setMapLoaded');\nexport const setMapFlying = createAction('MAP/setMapFlying');\n\nexport const getCountryBounds = createThunkAction('MAP/getCountryBounds', () => (dispatch, getState) => {\n  const state = getState();\n  const { locationId: iso, width: offset } = state.dashboard;\n  const boundsSQL = `SELECT ST_AsGeoJSON(ST_AsText(ST_Envelope(the_geom))) as geometry, gid_0, name_0 FROM gadm_wri_0 WHERE gid_0 = '${iso}'`;\n\n  axios.get(`https://wri-rw.carto.com/api/v2/sql?q=${boundsSQL}`)\n    .then(({data: {rows}}) => {\n      if (rows.length < 1) {\n        return dispatch(setMapBounds({bbox: [-180,90, 180, -90]}));\n      }\n\n      const geometry = JSON.parse(rows[0].geometry);\n      const bounds = window.L.geoJSON(geometry).getBounds();\n      const bbox = bounds.toBBoxString().split(',').map(b => parseFloat(b));\n      dispatch(setMapBounds({ bbox, options: {\n        paddingTopLeft: [offset, 0]\n      } }));\n    });\n});\n\nexport default {\n  setMap,\n  setMapBounds,\n  setMapStyle,\n  setBasemap,\n  setMapLabels,\n  setMapRoads,\n  setMapViewport,\n  setMapLoaded,\n  setMapFlying,\n  getCountryBounds\n};\n","const serialize = ({ id, type, attributes }) => Object.assign({}, { id, type }, attributes);\n\nconst itemSerializer = ({ id, type, attributes }, options = {}) => {\n  const d = Object.assign({}, { id, type }, attributes);\n\n  if (Object.prototype.hasOwnProperty.call(d, 'widget')) d.widget = d.widget.map(serialize);\n  if (Object.prototype.hasOwnProperty.call(d, 'layer')) d.layer = d.layer.map(serialize);\n  if (Object.prototype.hasOwnProperty.call(d, 'metadata')) {\n    d.metadata = d.metadata.map(serialize);\n\n    if (options.locale) {\n      d.metadata = d.metadata.find(m => m.language === options.locale) || {};\n    }\n  }\n  if (Object.prototype.hasOwnProperty.call(d, 'vocabulary')) d.vocabulary = d.vocabulary.map(serialize);\n  if (Object.prototype.hasOwnProperty.call(d, 'legendConfig') &&\n    Object.prototype.hasOwnProperty.call(d.legendConfig, 'items')) {\n    d.legendConfig.items = d.legendConfig.items.map((item, index) => {\n      const i = Object.assign({}, item);\n      i.id = i.id || index;\n      return i;\n    });\n  }\n\n  return d;\n};\n\nexport const wriAPISerializer = ({ data }, options = {}) => {\n  if (data && Array.isArray(data)) return data.map(d => itemSerializer(d, options));\n  return itemSerializer(data, options);\n};\n\nexport default wriAPISerializer;\n","import get from 'lodash/get';\n\n/**\n * aggregateByKey\n * @param {Array} collection - The collection of objects to be aggregated. \n * @param {string} key - The key used to aggregate objects.\n * @param {function} mapFn - A map function for each of the objects in the collection.\n */\nexport function aggregateByKey(collection, key, mapFn = x => x) {\n  // todo: could stats be done better by flattening and using Math functions?\n  const stats = {\n    length: 0,\n    sum: null,\n    max: null,\n    min: null\n  };\n\n  return collection.reduce((acc, row) => {\n    const rowKey = get(row, key);\n    const rowValue = mapFn(row);\n\n    const name = (key === 'iso') ? row.country : row.province;\n\n    if (!name) {\n      return acc;\n    }\n\n    if (row.score) {\n      stats.length++;\n      stats.sum += row.score;\n\n      if (!stats.min) {\n        stats.min = row.score;\n      } else {\n        if (row.score < stats.min) {\n          stats.min = row.score;\n        }\n      }\n\n      if (!stats.max) {\n        stats.max = row.score;\n      } else {\n        if (row.score > stats.max) {\n          stats.max = row.score;\n        }\n      }\n    }\n\n    if (acc[rowKey]) {\n      acc[rowKey].push(rowValue);\n    } else {\n      acc[rowKey] = [rowValue];\n    }\n\n    return acc;\n  }, { _stats: stats });\n}\n\nexport default aggregateByKey;","import axios from 'axios';\nimport get from 'lodash/get';\n\nimport serializer from './wri-json-api-serializer';\nimport aggregateByKey from './aggregate-by-key';\nimport {\n  ERRORS\n} from './constants';\n\nclass WRIService {\n  constructor() {\n    this.client = axios.create({\n      baseURL: process.env.REACT_APP_API_URL,\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  fetchLayersFromDataset(id, params = {}) {\n    return this.client.get(`/dataset/${id}/layer`, { params })\n      .then(response => {\n        const { status, statusText, data } = response;\n        if (status >= 400) throw new Error(statusText);\n        return serializer(data);\n      });\n  }\n\n  fetchDatasetsLayers(datasets) {\n    // We are unzipping here, you can check https://lodash.com/docs/4.17.11#unzip\n    // It is better this way because Object entries, values and keys can be order inconsistent\n    const [ datasetNames, datasetPromises ] = Object.entries(datasets).reduce((acc, item) => [\n      [...acc[0], item[0]],\n      [...acc[1], this.fetchLayersFromDataset(item[1])]\n    ], [[], []]);\n\n    return axios.all(datasetPromises)\n      .then(response => {\n        return datasetNames.reduce((acc, name, index) => ({\n          ...acc,\n          [name]: response[index]\n        }), {});\n      });\n  }\n\n  /**\n   * \n   * @param {Object} options\n   * @param {Object} options.dataset - Widget dataset\n   * @param {string} options.dataset.id - Widget dataset id\n   * @param {Object} options.widget - Widget object\n   * @param {string} options.widget.id - Widget id\n   * @param {Object} options.widget.params - Widget request parameters\n   * @param {Object} options.params - Request parameters\n   */\n  fetchDatasetWidgets(options) {\n    const widgetId = get(options, 'widget.id', null);\n    const widgetParams = get(options, 'widget.params', null);\n    const params = get(options, 'params', {});\n\n    if (widgetId && widgetParams) {\n      return this.client(`/widget/${widgetId}`, params)\n        .then(response => {\n          const { status, statusText, data } = response;\n          if (status >= 400) throw new Error(statusText);\n          return serializer(data);\n        })\n        .then(widgetData => {\n          const url = this.processWidgetData(widgetData, widgetParams);\n          return axios.get(url);\n        })\n        .then(response => {\n          const { status, statusText, data } = response;\n          if (status >= 400) throw new Error(statusText);\n          return aggregateByKey(data.rows, options.indexKey, row => ({\n            country: (options.indexKey === 'iso') ? row.country : row.province,\n            category: row.weight,\n            score: row.score,\n            rank: row.score_ranked\n          }));\n        });\n    }\n\n    throw new Error(ERRORS.MISSING_WIDGET_REQUEST_PARAMETERS);\n  }\n\n  /**\n   * processWidgetData - Process widget data as returned from WRI service.\n   * @param {Object} widgetData\n   * @param {Object} widgetData.widgetConfig\n   * @param {Array} widgetData.widgetConfig.data - An array of objects with url property for querying Carto.\n   * @param {Array} widgetData.widgetConfig.params_config - An array of parameters to replace in widget url's.\n   * @param {Array} widgetParams - Array of parameters, must match the ones requested in paramsConfig.\n   */\n  processWidgetData(widgetData, widgetParams) {\n    const { data, params_config: paramsConfig } = widgetData.widgetConfig;\n    return paramsConfig.reduce((acc, param) => {\n      const { key } = param;\n      if (param.required && !widgetParams[key]) {\n        throw new Error(ERRORS.MISSING_REQUIRED_PARAMETER);\n      }\n\n      return acc.replace(`{{${key}}}`, `'${widgetParams[key]}'`);\n    }, data[0].url);\n  }\n}\n\nexport const service = new WRIService();\nexport default service;\n","import { createAction, createThunkAction } from 'vizzuality-redux-tools';\n\nimport WRIService from 'services/wri-service';\nimport processLocation from 'utils/process-location';\n\nimport { INDICATORS } from 'services/wri-service/constants';\n\nimport { setCountry } from 'modules/app/actions';\n\nimport {\n  setCountries,\n  // setCountryValue,\n  setIndicators,\n  setIndicatorValue,\n  setWidgetData,\n  setWidgetStats\n} from 'modules/dashboard/actions';\n\nexport const setCountriesData = createAction('DATA/setCountriesData');\n\n/**\n * A NOTE on DATA actions\n * Initialize dashboard, we need to do it in the following order:\n * 1. Load indicators, for now they are static, but they should be fetched from a service.\n * 2. Load countries, indicators are needed, because not all data is available for all countries.\n *    If the indicator changes chances are countries list will change.\n */\n\n export const loadDashboardData = createThunkAction('DATA/loadDashboardData', () => (dispatch, state) => {\n  const { router } = state();\n  const { country, indicator } = router.query || {};\n\n  dispatch(getIndicators());\n\n  if (indicator) {\n    dispatch(setIndicatorValue({data: indicator}));\n  }\n\n  dispatch(getCountriesData()).then(data => {\n    const countries4widget = Object.entries(data)\n      .filter(entry => entry[0] !== '_stats')\n      .map(entry => processLocation(entry[0], entry[1]));\n\n    if (country) {\n      dispatch(setCountry({data: country.toUpperCase()}));\n    } else {\n      dispatch(setWidgetStats({data: data._stats}));\n      dispatch(setWidgetData({data: countries4widget}));\n    }\n  });\n});\n\nexport const getIndicators = createThunkAction('DATA/getIndicators', () => dispatch => {\n  // todo: use a service\n  dispatch(setIndicators({data: INDICATORS}))\n  dispatch(setIndicatorValue({data: INDICATORS[0].value}));\n});\n\nexport const getCountriesData = createThunkAction('DATA/getCountriesData', () => async (dispatch, state) => {\n  const dashboard = state().dashboard;\n  const { indicators: { value: indicator }} = dashboard;\n  \n  if (!indicator) return;\n\n  const options = {\n    widget: {\n      id: 'e6e5d286-212b-48d8-b5f4-1678cded82bc',\n      params: { indicator }\n    },\n    indexKey: 'iso'\n  };\n\n  return await WRIService.fetchDatasetWidgets(options)\n  .then(res => {\n    const countries = Object.entries(res)\n      .filter(entry => entry[0] !== '_stats')\n      .map(\n        country => ({\n          label: country[1][0].country,\n          value: country[0],\n        })\n      ).sort((a,b) => {\n        if (a.label && b.label) {\n          return a.label.localeCompare(b.label);\n        }\n  \n        return -1;\n      });\n\n    dispatch(setCountries({data: countries}));\n    // These will be used for Country headers\n    dispatch(setCountriesData({data: res}));\n    return res;\n  })\n});\n\nexport const getProvincesData = createThunkAction('DATA/getProvincesData', () => async (dispatch, state) => {\n  const dashboard = state().dashboard;\n  const { locationId, indicators: { value: indicator }} = dashboard;\n  \n  if (!indicator) return;\n\n  const options = {\n    widget: {\n      id: '4b3d6e89-869c-45b6-88e3-28735d2b60fe',\n      params: { indicator, iso: locationId }\n    },\n    indexKey: 'province'\n  };\n\n  return await WRIService.fetchDatasetWidgets(options);\n});\n\n\n\nexport default {\n  getIndicators,\n  getCountriesData,\n  getProvincesData\n};\n","import { createAction, createThunkAction } from 'vizzuality-redux-tools';\n\nimport exportService from 'services/export-service';\nimport processLocation from 'utils/process-location';\n\n// utils\nimport { logEvent } from 'utils/analytics';\n\nimport {\n  setCountryValue,\n  setIndicatorValue,\n  setLocation,\n  setWidgetData,\n  setWidgetStats\n} from 'modules/dashboard/actions';\nimport { SCOPE } from 'modules/dashboard/constants';\n\nimport { getCountryBounds } from 'modules/map/actions';\nimport { getCountriesData, getProvincesData } from 'modules/data/actions';\nimport { setMapBounds } from 'modules/map/actions';\n\nexport const setDashboardCollapsed = createAction('APP/setDashboardCollapsed');\nexport const setModalState = createAction('APP/setModalState');\n\nexport const setCountry = createThunkAction('APP/setCountry', payload => dispatch => {\n  dispatch(setLocation(payload));\n  dispatch(setCountryValue(payload));\n  dispatch(setUrl({params: {country: payload.data}}));\n  dispatch(getCountryBounds(payload.data));\n\n  const getData = (payload.data) ? getProvincesData : getCountriesData;\n\n  dispatch(getData()).then(data => {\n    const widgetData = Object.entries(data)\n      .filter(entry => entry[0] !== '_stats')\n      .map(entry => processLocation(entry[0], entry[1]));\n\n    dispatch(setWidgetStats({data: data._stats}));\n    dispatch(setWidgetData({data: widgetData}));\n  });\n\n  if (!payload.data) {\n    dispatch(setMapBounds({bbox: [-180, 90, 180, -90]}));\n  }\n});\n\nexport const setIndicator = createThunkAction('APP/setIndicator', payload => (dispatch, state) => {\n  dispatch(setIndicatorValue(payload));\n  dispatch(setUrl({params: {indicator: payload.data}}));\n\n  const {dashboard: {scope}} = state();\n  const getData = (scope === SCOPE.COUNTRY ) ? getProvincesData : getCountriesData;\n\n  dispatch(getData()).then(data => {\n    const widgetData = Object.entries(data)\n      .filter(entry => entry[0] !== '_stats')\n      .map(entry => processLocation(entry[0], entry[1]));\n\n    dispatch(setWidgetStats({data: data._stats}));\n    dispatch(setWidgetData({data: widgetData}));\n  });\n});\n\nexport const setUrl = createThunkAction('APP/saveData', ({ params, replace }) => (dispatch, state) => {\n  const { router: {type, query} } = state();\n\n  const newQuery = replace\n    ? {...params}\n    : {...query, ...params};\n\n  const cleanQuery = Object.fromEntries(Object.entries(newQuery).filter(entry => Boolean(entry[1])));\n\n  dispatch({\n    type,\n    query: cleanQuery\n  });\n});\n\nexport const saveData = createThunkAction('APP/saveData', () => () => {\n  exportService.saveRankings();\n  logEvent('[AQ-Country-Ranking] Download', 'user downloads ranking', 'click');\n});\n\n","import {\n  setCountry,\n  setDashboardCollapsed,\n  setModalState\n} from './actions';\n\nconst reducerMap = {\n  [setCountry]: (state, { payload }) => ({\n    ...state, country: payload.value\n  }),\n  [setDashboardCollapsed]: (state, { payload }) => ({\n    ...state, isDashboardCollapsed: Boolean(payload)\n  }),\n  [setModalState]: (state, { payload: { isOpen, content } }) => ({\n    ...state, isModalOpen: Boolean(isOpen), modalContent: content\n  })\n};\n\nexport default reducerMap;\n","export default {\n  isDashboardCollapsed: false,\n  isModalOpen: false,\n  modalContent: null\n};\n","import * as actions from './actions';\n\nexport default {\n  [actions.setCountriesData]: (state, { payload: { data } }) => ({ ...state, countries: {...state.countries, data} }),\n  // These actions are created by vizzuality-redux-tools for thunks\n  'DATA/getCountries_STARTED': state  => ({ ...state, countries: {...state.countries, isLoading: true} }),\n  'DATA/getCountries_SUCCEEDED': state  => ({ ...state, countries: {...state.countries, isLoading: false, isLoaded: true} }),\n  'DATA/getIndicators_STARTED': state  => ({ ...state, indicators: {...state.indicators, isLoading: true} }),\n  'DATA/getIndicators_SUCCEEDED': state  => ({ ...state, indicators: {...state.indicators, isLoading: false, isLoaded: true} }),\n  'DATA/getWidgetData_STARTED': state  => ({ ...state, widget: {...state.widget, isLoading: true} }),\n  'DATA/getWidgetData_SUCCEEDED': state  => ({ ...state, widget: {...state.widget, isLoading: false, isLoaded: true} })\n};\n","export default {\n  countries: {\n    data: null,\n    isLoading: false,\n    isLoaded: false,\n    error: null\n  },\n  provinces: {\n    cache: [],\n    data: null,\n    isLoading: false,\n    isLoaded: false,\n    error: null\n  },\n  indicators: {\n    data: null,\n    isLoading: false,\n    isLoaded: false,\n    error: null\n  }\n};\n","import { NOT_FOUND } from 'redux-first-router';\n\nexport const PAGES = [\n  {\n    name: 'HOME',\n    path: '/:iso?/:indicator?',\n    page: 'home'\n  },\n  {\n    name: NOT_FOUND,\n    path: '/404',\n    page: 'not-found'\n  }\n];\n\nexport default PAGES;\n","import { createAction } from 'vizzuality-redux-tools';\n\nimport pages from './constants';\n\nexport const pageActions = pages.reduce(\n  (acc, page) => ({ ...acc, [page.name]: createAction(`PAGES/${page.name}`) }),\n  {}\n);\nexport const setPage = createAction('PAGES/setPage');\n","import { pageActions } from './actions';\n\nconst setPageReducer = key => (state, { payload }) => ({ ...state, current: key, payload });\nconst reducerMap = Object.keys(pageActions).reduce(\n  (acc, key) => ({ ...acc, [key]: setPageReducer(key) }),\n  {}\n);\n\nexport default reducerMap;\n","export default {\n  current: 'HOME'\n};\n","import * as actions from './actions';\n\nexport default {\n  [actions.setMap]: (state, { payload }) => ({ ...state, ...payload }),\n  [actions.setMapBounds]: (state, { payload }) => ({ ...state, bounds: payload }),\n  [actions.setBasemap]: (state, { payload }) => ({ ...state, basemap: payload }),\n  [actions.setMapStyle]: (state, { payload }) => ({ ...state, mapStyle: payload }),\n  [actions.setMapLabels]: (state, { payload }) => ({ ...state, mapLabels: payload }),\n  [actions.setMapRoads]: (state, { payload }) => ({ ...state, mapRoads: payload }),\n  [actions.setMapViewport]: (state, { payload }) => ({ ...state, viewport: payload }),\n  [actions.setMapLoaded]: (state, { payload }) => ({ ...state, settings: { isLoaded: payload } }),\n  [actions.setMapFlying]: (state, { payload }) => ({ ...state, settings: { isFlying: payload } })\n};\n","export default {\n  viewport: {\n    zoom: 2,\n    latitude: 41.145218001222204,\n    longitude: -8.61132408966133,\n  },\n  basemap: 'hydro'\n};\n","import { createAction, createThunkAction } from 'vizzuality-redux-tools';\nimport WRIService from 'services/wri-service';\n\nexport const setList = createAction('LAYERS/setList');\nexport const setLoading = createAction('LAYERS/setLoading');\nexport const setError = createAction('LAYERS/setError');\nexport const setLayersOpacity = createAction('LAYERS/setLayersOpacity');\nexport const getLayers = createThunkAction('LAYERS/getLayers', () => dispatch => {\n  dispatch(setLoading(true));\n  dispatch(setError(null));\n\n  const datasets = {\n    country_rankings: 'fd4b4ba5-a16a-45a4-bc6b-954397e37bda',\n    province_rankings: 'e0adfbfb-441d-4ec5-9e4c-7d051d0f7b22'\n  };\n\n  return WRIService.fetchDatasetsLayers(datasets)\n    .then(layers => {\n      dispatch(setList(layers));\n      dispatch(setLoading(false));\n    })\n    .catch((err) => {\n      dispatch(setError(err));\n      dispatch(setLoading(false));\n    });\n});\n\nexport default {\n  setList,\n  setLoading,\n  setError,\n  getLayers,\n  setLayersOpacity\n};\n","import {\n  setList,\n  setLoading,\n  setError,\n  setLayersOpacity\n} from './actions';\n\nexport default {\n  [setList]: (state, { payload }) => ({\n    ...state, list: payload\n  }),\n  [setLoading]: (state, { payload }) => ({\n    ...state, isLoading: Boolean(payload)\n  }),\n  [setError]: (state, { payload }) => ({\n    ...state, error: payload\n  }),\n  [setLayersOpacity]: (state, { payload }) => ({\n    ...state,\n    list: {\n      country_rankings: state.list.country_rankings.map(l => ({ ...l, opacity: payload })),\n      province_rankings: state.list.province_rankings.map(l => ({ ...l, opacity: payload }))\n    }\n  })\n};\n","export default {\n  list: null,\n  isLoading: false,\n  isLoaded: false,\n  error: null\n};\n","import * as actions from './actions';\n\nimport { SCOPE } from './constants';\n\nexport default {\n  [actions.setCountries]: (state, { payload: { data }}) => ({ ...state, countries: {...state.countries, list: data} }),\n  [actions.setIndicators]: (state, { payload: { data } }) => ({ ...state, indicators: {...state.indicators, list: data} }),\n  [actions.setLocation]: (state, { payload: { data } }) => ({\n    ...state,\n    locationId: data,\n    scope: data ? SCOPE.COUNTRY : SCOPE.GENERAL\n  }),\n  [actions.setCountryValue]: (state, { payload: { data } }) => ({ ...state, countries: {...state.countries, value: data} }),\n  [actions.setIndicatorValue]: (state, { payload: { data } }) => ({ ...state, indicators: {...state.indicators, value: data} }),\n  [actions.setWidgetData]: (state, { payload: { data } }) => ({ ...state, widget: {...state.widget, data} }),\n  [actions.setWidgetStats]: (state, { payload: { data: stats } }) => ({ ...state, widget: {...state.widget, stats} }),\n  [actions.setWidth]: (state, { payload: { data } }) => ({ ...state, width: data })\n};\n","import { SCOPE } from './constants';\n\nexport default {\n  scope: SCOPE.GENERAL,\n  locationId: null,\n  width: null,\n  countries: {\n    list: [],\n    value: null\n  },\n  indicators: {\n    list: [],\n    value: null\n  },\n  widget: {\n    data: []\n  }\n};\n","import { connectRoutes } from 'redux-first-router';\nimport queryString from 'query-string';\n\nimport { PAGES } from 'modules/pages/constants';\n\nconst routes = PAGES.reduce((acc, page) => ({\n  ...acc,\n  [page.name]: {\n    path: page.path,\n    ...{ thunk: page.thunk }\n  }\n}), {});\n\nconst options = {\n  basename: process.env.REACT_APP_BASE_URL,\n  location: 'router',\n  notFoundPath: `${process.env.REACT_APP_BASE_URL}404`,\n  initialDispatch: false,\n  querySerializer: queryString\n};\n\nexport default connectRoutes(routes, options);\n","import { createStore, combineReducers, applyMiddleware } from 'redux';\nimport thunkMiddleware from 'redux-thunk';\nimport { composeWithDevTools } from 'redux-devtools-extension/logOnlyInProduction';\nimport { handleModule } from 'vizzuality-redux-tools';\n\nimport * as app from 'modules/app';\nimport * as data from 'modules/data';\nimport * as pages from 'modules/pages';\nimport * as map from 'modules/map';\nimport * as layers from 'modules/layers';\nimport * as dashboard from 'modules/dashboard';\nimport router from './router';\n\nconst modules = [\n  { namespace: 'app', components: app },\n  { namespace: 'data', components: data },\n  { namespace: 'page', components: pages },\n  { namespace: 'map', components: map },\n  { namespace: 'layers', components: layers },\n  { namespace: 'dashboard', components: dashboard }\n];\n\nconst {\n  initialDispatch,\n  reducer: routerReducer,\n  middleware: routerMiddleware,\n  enhancer: routerEnhancer\n} = router;\n\nconst reducers = combineReducers({\n  router: routerReducer,\n  ...modules.reduce(\n    (acc, module) => ({ ...acc, [module.namespace]: handleModule(module.components) }),\n    {}\n  )\n});\n\nconst middleware = applyMiddleware( routerMiddleware, thunkMiddleware );\n\nconst enhancers = composeWithDevTools(routerEnhancer, middleware);\n\nconst store = createStore(reducers, enhancers);\n\ninitialDispatch();\n\nexport default store;\n","import { connect } from 'react-redux';\n\nimport { Modal } from 'aqueduct-components';\n\nconst mapStateToProps = state => ({});\n\nconst mapDispatchToProps = {};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Modal);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Clipboard from 'clipboard';\nimport { Icon } from 'vizzuality-components';\n\n\nexport default class ShareModal extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      copied: false\n    };\n  }\n\n  componentWillMount() {\n    this.props.getShareUrl(window.location.href);\n  }\n\n\n  componentDidMount() {\n    this.clipboard = new Clipboard(this.btn);\n    this.clipboard.on('success', (e) => {\n      this.setState({ copied: true });\n      setTimeout(() => {\n        this.setState({ copied: false });\n        e.clearSelection();\n      }, 2000);\n    });\n\n    this.clipboard.on('error', () => {\n      this.setState({ error: true });\n      setTimeout(() => {\n        this.setState({ error: false });\n      }, 2000);\n    });\n  }\n\n  // UI EVENTS\n  triggerPopup(e) {\n    e && e.preventDefault();\n    const width = 575;\n    const height = 400;\n    const left = (window.innerWidth - width) / 2;\n    const top = (window.innerHeight - height) / 2;\n\n    const url = e.currentTarget.href;\n    const opts = `status=1,width=${width},height=${height},top=${top},left=${left}`;\n\n    window.open(url, 'Share this analysis', opts);\n  }\n\n  render() {\n    const title = 'Water and Food Security Analyzer';\n    const url = this.props.share.url || window.location.href;\n    const urlEncoded = encodeURIComponent(this.props.share.url || window.location.href);\n\n    let text = 'Copy';\n    let classCopy = '';\n\n    if (this.state.copied) {\n      text = 'Copied';\n      classCopy = '-success';\n    }\n    if (this.state.error) {\n      text = 'Error';\n      classCopy = '-error';\n    }\n\n    return (\n      <div className=\"c-share\">\n        <div className=\"share-header\">\n          <h3 className=\"share-title\">Share this page</h3>\n        </div>\n        <div className=\"share-content\">\n          <div className=\"share-button\">\n            <input\n              id=\"url\"\n              className=\"share-url\"\n              value={url}\n              readOnly\n              onFocus={e => e.currentTarget.select()}\n            />\n            <button\n              data-clipboard-target=\"#url\"\n              ref={(node) => { this.btn = node; }}\n              className={`c-btn -primary ${classCopy}`}\n              type=\"button\"\n            >\n              {text}\n            </button>\n          </div>\n\n          <div className=\"share-sozial\">\n            <a\n              href={`https://twitter.com/share?url=${urlEncoded}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"c-btn -primary -with-icon -twitter -social\"\n              onClick={this.triggerPopup}\n            >\n              <Icon name=\"icon-twitter\" />\n              <span>Twitter</span>\n            </a>\n            <a\n              href={`https://www.facebook.com/sharer/sharer.php?u=${urlEncoded}&t=${title}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"c-btn -primary -with-icon -facebook -social\"\n              onClick={this.triggerPopup}\n            >\n              <Icon name=\"icon-facebook\" />\n              <span>Facebook</span>\n            </a>\n            <a\n              href={`https://www.linkedin.com/shareArticle?mini=true&url=${urlEncoded}&title=${title}&summary=&source=`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"c-btn -primary -with-icon -linkedin -social\"\n              onClick={this.triggerPopup}\n            >\n              <Icon name=\"icon-linkedin\" />\n              <span>Linkedin</span>\n            </a>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nShareModal.propTypes = {\n  share: PropTypes.object,\n  getShareUrl: PropTypes.func\n};\n\nShareModal.defaultProps = {\n  share: {},\n  getShareUrl: x => x\n};\n","import React from 'react';\n\nexport default () => (\n  <div className=\"c-info\">\n    <div className=\"info-header\">\n      <div className=\"info-titles\">\n        <span className=\"info-title\">Water Risk Indicator</span>\n      </div>\n    </div>\n    <div className=\"info-description\">\n      <dl>\n        <dt>Baseline Water Stress</dt><br />\n        <dd>Baseline water stress measures the ratio of total water withdrawals to available renewable water supplies. Water withdrawals include domestic, industrial, irrigation and livestock consumptive and non-consumptive uses. Available renewable water supplies include surface and groundwater supplies and considers the impact of upstream consumptive water users and large dams on downstream water availability. Higher values indicate more competition among users.</dd>\n        <br />\n        <dt>Drought Risk</dt><br />\n        <dd>Drought risk measures where droughts are likely to occur, the population and assets exposed, and the vulnerability of the population and assets to suffering adverse effects. Higher values indicate higher risk of drought.</dd>\n        <br />\n        <dt>Coastal Flood Risk</dt><br />\n        <dd>Coastal flood risk measures the percentage of population expected to be affected by coastal flooding in an average year, accounting for existing flood protection standards. Higher values indicate greater proportion of the population is expected to be impacted by coastal floods.</dd>\n        <br />\n        <dt>Source: </dt>\n        <dd><a href=\"https://www.wri.org/publication/aqueduct-30\">Aqueduct 2019</a> aggregated to a country and sub-national level using the methods described in Aqueduct <a href=\"https://www.wri.org/publication/aqueduct-country-and-river-basin-rankings\">2013</a></dd>\n      </dl>\n    </div>\n  </div>\n);\n","import { createSelector } from 'reselect';\nimport processLocation from 'utils/process-location';\n\nconst dashboard = state => state.dashboard;\nconst data = state => state.data;\nconst countries = createSelector([data], _data => _data.countries.data);\n\nexport const currentLocation = createSelector([dashboard], _dashboard => _dashboard.locationId);\n\nexport const getCountryData = createSelector(\n  [currentLocation, countries],\n  (_currentLocation, _countries) => _currentLocation\n    ? processLocation(_currentLocation, _countries[_currentLocation])\n    : null\n);","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { Icon } from 'vizzuality-components';\nimport { CustomSelect } from 'aqueduct-components';\n\n// utils\nimport { logEvent } from 'utils/analytics';\n\nconst countrySelectStyles = {\n  container: styles => ({\n    ...styles,\n    height: '40px'\n  }),\n  valueContainer: styles => ({\n    ...styles,\n    height: '40px',\n    marginLeft: '16px'\n  })\n};\n\nconst IndicatorsContainer = () => (\n  <div className=\"country-selector--icon\">\n    <Icon className=\"-small\" name=\"icon-search\" />\n  </div>\n);\n\nfunction CountrySelector({\n  countries,\n  setCountry\n}) {\n  const countryChangeHandler = (option) => {\n    setCountry({data: option.value});\n    logEvent('[AQ-Country-Ranking] Countries', 'user selects a country', option.label);\n  };\n\n  return (\n    <CustomSelect\n      theme=\"light\"\n      placeholder=\"Search a country\"\n      options={countries.list}\n      onChange={countryChangeHandler}\n      customClass=\"c-country-selector\"\n      styles={countrySelectStyles}\n      components={{ IndicatorsContainer }}\n      value={countries.value}\n    />\n  );\n}\n\nCountrySelector.propTypes = {\n  countries: PropTypes.shape({}).isRequired,\n  setCountry: PropTypes.func,\n};\n\nCountrySelector.defaultProps = {\n  setCountry: () => {\n    console.log('Country value was changed.');\n  }\n};\n\nexport default CountrySelector;","import { connect } from 'react-redux';\n\nimport { setCountry } from 'modules/app/actions';\nimport CountrySelector from './component';\n\nconst mapStateToProps = state => ({\n  countries: state.dashboard.countries\n});\n\nconst mapDispatchToProps = { setCountry };\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CountrySelector);\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classnames from 'classnames';\n\nimport { Field, CustomSelect } from 'aqueduct-components';\n\n// utils\nimport { logEvent } from 'utils/analytics';\n\nfunction IndicatorSelector({\n  indicators,\n  setIndicator,\n  setModalState,\n  className\n}) {\n  const indicatorChangeHandler = (option) => {\n    setIndicator({data: option.value})\n    logEvent('[AQ-Country-Ranking] Indicators', 'user selects an indicator', option.label);\n  };\n\n  \n  const indicatorsInfoHandler = () => {\n    setModalState({ isOpen: true, content: 'indicators'});\n    // logEvent('[AQ-Country-Ranking] Share', 'user opens share modal', 'click');\n  };\n\n\n  return (\n    <Field\n      name=\"indication-filter\"\n      label=\"Select Water Risk Indicator\"\n      className=\"-bigger\"\n      customClass=\"c-indicator-selector\"\n      theme=\"light\"\n      onMoreInfo={indicatorsInfoHandler}\n    >\n      <CustomSelect\n        theme=\"light\"\n        options={indicators.list}\n        onChange={indicatorChangeHandler}\n        customClass={classnames('indicator-selector--select', { [className]: Boolean(className)})}\n        value={indicators.value}\n      />\n    </Field>\n  );\n}\n\nIndicatorSelector.propTypes = {\n  indicators: PropTypes.shape({}).isRequired,\n  setIndicator: PropTypes.func,\n};\n\nIndicatorSelector.defaultProps = {\n  setIndicator: () => {\n    console.log('Indicator value was changed.');\n  }\n};\n\nexport default IndicatorSelector;","import { connect } from 'react-redux';\n\nimport { setIndicator } from 'modules/app/actions';\nimport IndicatorSelector from './component';\nimport { setModalState } from 'modules/app/actions';\n\nconst mapStateToProps = state => ({\n  indicators: state.dashboard.indicators\n});\n\nconst mapDispatchToProps = {\n  setIndicator,\n  setModalState\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(IndicatorSelector);\n","import React from 'react';\n\nimport CountrySelector from 'components/country-selector';\nimport IndicatorSelector from 'components/indicator-selector';\n\nconst HeaderGeneral = () => {\n  return (\n    <header className=\"c-header\">\n      <div className=\"header--content\">\n        <CountrySelector />\n        <IndicatorSelector />\n        <p className=\"header--disclaimer\">This map is for illustrative purposes and does not imply the expression of any opinion on the part of WRI concerning the legal status of any country or territory, or concerning the delimitation of frontiers or boundaries.</p>\n      </div>\n    </header>\n  );\n};\n\nexport default HeaderGeneral;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Icon } from 'vizzuality-components';\nimport { Field } from 'aqueduct-components';\n\nimport IndicatorSelector from 'components/indicator-selector';\n\nconst HeaderCountry = ({ onBackClick, data }) => {\n  const backClickHandler = () => onBackClick();\n\n  const order = ['Irr', 'Dom', 'Ind', 'Tot'];\n  const headerIndicators = Object.fromEntries(Object.entries(data.indicators)\n    .filter(data => order.includes(data[0]))\n    .sort((a, b) => order.indexOf(a[0]) - order.indexOf(b[0])));\n\n  return (\n    <header className=\"c-header\">\n      <div className=\"header--back-button\" onClick={backClickHandler}>\n        <Icon className=\"-small\" name=\"icon-arrow-left\" />\n        <span className=\"-uppercase\">Country Rankings</span>\n      </div>\n      <div className=\"header--content\">\n        <div className=\"header--info\">\n          <h1>{data.name}</h1>\n          <Field\n            name=\"header-indicators\"\n            label=\"Summary Results\"\n            className=\"-bigger\"\n          >\n            <ul className=\"header--indicators\">\n              {Object.entries(headerIndicators).map(indicator => (\n                <li className=\"header--indicator\" key={indicator[0]}>\n                  {indicator[1].name}: {indicator[1].score}\n                </li>\n              ))}\n            </ul>\n          </Field>\n        </div>\n        <IndicatorSelector className=\"header--indicator-selector\"/>\n        <p className=\"header--disclaimer\">This map is for illustrative purposes and does not imply the expression of any opinion on the part of WRI concerning the legal status of any country or territory, or concerning the delimitation of frontiers or boundaries.</p>\n      </div>\n    </header>\n  );\n};\n\nHeaderCountry.propTypes = {\n  onBackClick: PropTypes.func\n};\n\nHeaderCountry.defaultProps = {\n  onBackClick: () => {\n    console.log('Go back button was pressed.');\n  }\n};\n\nexport default HeaderCountry;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst DashboardWidgets = ({className, height, width, fill}) => {\n  return (\n    <div\n      className={className}\n      style={{display: 'inline-block', backgroundColor: fill, height, width}}\n    />\n  );\n};\n\nDashboardWidgets.propTypes = {\n  height: PropTypes.string,\n  width: PropTypes.string,\n  fill: PropTypes.string\n};\n\nDashboardWidgets.defaultProps = {\n  height: '11px',\n  width: '11px',\n  fill: '#000000'\n};\n\nexport default DashboardWidgets;\n","import React, {Fragment} from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\nimport Bar from 'components/bar';\n\nconst Chart = ({indicators, config: {fields, palette, length}}) => {\n  if (!indicators) {\n    return null;\n  }\n\n  const fill = (palette, index) => palette[index % palette.length];\n\n  return (\n    <Fragment>\n      {fields.map((field, index) => {\n        if (!indicators[field]) {\n          return null;\n        }\n\n        const value = indicators[field].score;\n\n        return (\n          <div key={field}>\n            <span className='widget--chart-text'>{`${value}`}</span>\n            <Bar fill={fill(palette, index)} width={`${length(value)}px`} />\n          </div>\n        );\n      })}\n    </Fragment>\n  );\n};\n\nconst Widget = ({classes, rowNumber, country, chartConfig}) => {\n  return (\n    <div className={classnames('c-widget', { [classes.row]: Boolean(classes.row)})}>\n      <div className={classes.columns[0]}>{rowNumber}</div>\n      <div className={classes.columns[1]}>{country.name}</div>\n      <div className={classes.columns[2]}>\n        <Chart indicators={country.indicators} config={chartConfig} />\n      </div>\n      { Object.values(country.indicators).length > 1 \n        ? <div className={classes.columns[3]}>{country.indicators['Tot'] && country.indicators['Tot'].score}</div>\n        : null }\n    </div>\n  );\n};\n\nWidget.propTypes = {\n  rowNumber: PropTypes.number.isRequired,\n  country: PropTypes.shape({}).isRequired\n};\n\nexport default Widget;\n","export const palette = ['#3FA989', '#00A0E1', '#4A596A'];\nexport const chartOrder = ['Irr', 'Dom', 'Ind', 'Pop'];\nexport const tableClasses = {\n  row: 'widgets--content-row',\n  columns: [\n    'widgets--row-number',\n    'widgets--name',\n    'widgets--chart',\n    'widgets--total'\n  ]\n};\n\nexport default {\n  palette,\n  chartOrder,\n  tableClasses\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Widget from 'components/widget';\nimport Bar from 'components/bar';\nimport {\n  palette,\n  chartOrder,\n  tableClasses\n} from './constants';\n\nconst DashboardWidgets = ({title, buttonText, data: widget, onSelect}) => {\n  const { data, stats} = widget;\n\n  if (!data.length || data.length === 0) {\n    return null;\n  }\n\n  const headerIndicators = Object.entries(data[0].indicators)\n    .filter(data => chartOrder.includes(data[0]))\n    .sort((a, b) => chartOrder.indexOf(a[0]) - chartOrder.indexOf(b[0]));\n\n  const indicatorsLegend = headerIndicators.map((data, i) => (\n    <div className=\"widgets--content-legend\" key={data}>\n      <Bar className=\"widgets--content-bullet\" fill={palette[i]} />\n      {data[1].name}\n    </div>\n  ));\n\n  const minLength = 1;\n  const maxLength = 76;\n  const chartConfig = {\n    fields: chartOrder,\n    palette,\n    length: value => minLength + ((value - stats.min) / stats.max) * (maxLength - minLength)\n  };\n\n  const sortedData = data.sort((a, b) => {\n    const {Tot:aTot, Pop:aPop} = a.indicators;\n    const {Tot:bTot, Pop:bPop} = b.indicators;\n    if (aTot && bTot && aTot.score && bTot.score) {\n      return parseFloat(bTot.score) - parseFloat(aTot.score);\n    } else if (aPop && bPop && aPop.score && bPop.score) {\n      return parseFloat(bPop.score) - parseFloat(aPop.score);\n    }\n\n    return 0;\n  });\n\n  return (\n    <div className=\"c-widgets\">\n      <div className=\"widgets--header\">\n        <span className=\"-uppercase\">{title}</span>\n        <button type=\"button\" onClick={onSelect}>{buttonText}</button>\n      </div>\n      <div className=\"widgets--content-wrapper\">\n        <div className=\"widgets--content-header\">\n          <div className={tableClasses.columns[0]}>Rank</div>\n          <div className={tableClasses.columns[1]}>Name</div>\n          <div className={tableClasses.columns[2]}>Sectoral Score{indicatorsLegend}</div>\n          {Object.values(sortedData[0].indicators).length > 1 ? <div className={tableClasses.columns[3]}>Total Score</div> : null}\n        </div>\n        <div className=\"widgets--content-body\">\n        {sortedData.map((country, index) => {\n          return (\n              <Widget\n                classes={tableClasses}\n                key={country.iso}\n                rowNumber={index + 1}\n                country={country}\n                chartConfig={chartConfig}\n              />\n          );\n        })}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nDashboardWidgets.propTypes = {\n  title: PropTypes.string,\n  buttonText: PropTypes.string,\n  data: PropTypes.shape({\n    data: PropTypes.arrayOf(PropTypes.shape({})),\n    stats: PropTypes.shape({\n      min: PropTypes.number,\n      max: PropTypes.number\n    })\n  }).isRequired\n};\n\nDashboardWidgets.defaultProps = {\n  title: 'Water Usage (Score)',\n  buttonText: 'Download ranking'\n};\n\nexport default DashboardWidgets;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Field } from 'aqueduct-components';\n\nimport { SCOPE } from 'modules/dashboard/constants';\nimport CountrySelector from 'components/country-selector';\n\nconst Footer = ({\n  scope\n}) => {\n  if (scope === SCOPE.GENERAL) {\n    return null;\n  }\n\n  return (\n    <footer className=\"c-footer\">\n      <Field\n        name=\"countries-filter\"\n        label=\"Explore more\"\n        className=\"-bigger\"\n      >\n        <CountrySelector />\n      </Field>\n    </footer>\n  );\n};\n\nFooter.propTypes = {\n  scope: PropTypes.string.isRequired\n};\n\nexport default Footer;\n","import React, { useEffect, useRef } from 'react';\n\nimport HeaderGeneral from 'components/header-general';\nimport HeaderCountry from 'components/header-country';\nimport DashboardWidgets from 'components/dashboard-widgets';\nimport Footer from 'components/footer';\n\nimport { SCOPE } from 'modules/dashboard/constants';\n\nconst Dashboard = ({\n  width,\n  setWidth,\n  scope,\n  headerData,\n  widget,\n  setCountry,\n  saveData\n}) => {\n  const dashboardEl = useRef(null);\n  useEffect(() => {\n    const currentWidth = dashboardEl.current.offsetWidth;\n\n    if (currentWidth !== width) {\n      setWidth({data: currentWidth});\n    }\n  });\n  const backClickHandler = () => setCountry({data: null});\n  const rankingTitle = (scope === SCOPE.GENERAL) ? 'Country Rankings' : 'Sub-national Rankings';\n\n  return (\n    <div ref={dashboardEl} className=\"dashboard\">\n      { scope === SCOPE.GENERAL ?\n        <HeaderGeneral /> :\n        <HeaderCountry data={headerData} onBackClick={backClickHandler} />\n      }\n      <DashboardWidgets data={widget} onSelect={saveData} title={rankingTitle} />\n      <Footer scope={scope} />\n    </div>\n  );\n};\n\nexport default Dashboard;\n","import { connect } from 'react-redux';\n\nimport { setCountry, saveData } from 'modules/app/actions';\nimport { setWidth } from 'modules/dashboard/actions';\nimport { getCountryData } from 'modules/dashboard/selectors';\n\nimport Dashboard from './component';\n\nconst mapStateToProps = state => ({\n  scope: state.dashboard.scope,\n  width: state.dashboard.width,\n  headerData: getCountryData(state),\n  widget: state.dashboard.widget\n});\n\nconst mapDispatchToProps = {\n  setCountry,\n  saveData,\n  setWidth\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nclass LegendTypeChoropleth extends React.PureComponent {\n  static propTypes = {\n    activeLayer: PropTypes.object\n  }\n\n  static defaultProps = {\n    activeLayer: {}\n  }\n\n  render() {\n    const { activeLayer } = this.props;\n    const { legendConfig } = activeLayer;\n\n    if (!legendConfig || legendConfig.type !== 'choropleth') {\n      return null;\n    }\n\n    return (\n      <div>\n        <ul className=\"c-legend-type-choropleth\">\n          {legendConfig.items.map(({ name, value, color }) => (\n            <li key={`legend-choropleth-item-${name || value}`}>\n              <div className=\"icon-choropleth\" style={{ backgroundColor: color }} />\n              <span className=\"name\">\n                {name}\n              </span>\n              <span className=\"name\">\n                {value}\n              </span>\n            </li>\n          ))}\n        </ul>\n        {legendConfig.disclaimer && (\n          <div className=\"graph -basic -disclaimer\">\n            <div className=\"graph-list\">\n              {legendConfig.disclaimer.map(item => (\n                <div className=\"graph-list-item\" key={item.name}>\n                  <span className=\"color\" style={{ background: item.color }} />\n                  <span className=\"label\">{item.name}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default LegendTypeChoropleth;\n","import Component from './component';\r\n\r\nexport default Component;","export const BASEMAP_CONFIG = {\n  url: process.env['REACT_APP_BASEMAP_TILE_URL'],\n  options: { attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\" rel=\"noopener noreferrer\">OpenStreetMap</a>' }\n};\n\nexport const LABEL_LAYER_CONFIG = {\n  url: process.env['REACT_APP_BASEMAP_LABEL_URL'],\n  options: { attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\" rel=\"noopener noreferrer\">OpenStreetMap</a>' }\n};\n\nexport const BASEMAPS = {\n  // Open Street Maps\n  osm: {\n    id: 'osm',\n    value: process.env['REACT_APP_BASEMAP_TILE_URL'],\n    label: 'Light',\n    options: { attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\" rel=\"noopener noreferrer\">OpenStreetMap</a>' }\n  },\n  satellite: {\n    id: 'satellite',\n    value: 'https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',\n    label: 'Satellite',\n    options: { attribution: '&copy; <a href=\"https://www.google.com/maps/@15,-2.970703,3z?hl=es\" target=\"_blank\">Google</a>' }\n  },\n  terrain: {\n    id: 'terrain',\n    value: 'https://api.mapbox.com/styles/v1/resourcewatch/cjhqi456h02pg2rp6w2mwp61c/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoicmVzb3VyY2V3YXRjaCIsImEiOiJjajFlcXZhNzcwMDBqMzNzMTQ0bDN6Y3U4In0.FRcIP_yusVaAy0mwAX1B8w',\n    label: 'Terrain',\n    options: { attribution: '<a href=\"https://www.mapbox.com/about/maps/\" target=\"_blank\"> Mapbox</a> <a href=\"http://www.openstreetmap.org/about/\" target=\"_blank\"> OpenStreetMap</a>' }\n  },\n  hydro: {\n    id: 'hydro',\n    value: 'https://api.mapbox.com/styles/v1/resourcewatch/cjtr6fhr3060g1fok829tfwm7/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoicmVzb3VyY2V3YXRjaCIsImEiOiJjajFlcXZhNzcwMDBqMzNzMTQ0bDN6Y3U4In0.FRcIP_yusVaAy0mwAX1B8w',\n    label: 'Hydrography',\n    options: { attribution: '<a href=\"https://www.mapbox.com/about/maps/\" target=\"_blank\"> Mapbox</a> <a href=\"http://www.openstreetmap.org/about/\" target=\"_blank\"> OpenStreetMap</a>' }\n  }\n};\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport TetherComponent from 'react-tether';\n\n// components\nimport { Icon, RadioGroup } from 'aqueduct-components';\n\n// constants\nimport { BASEMAPS } from 'components/map/constants';\n\nclass BasemapControl extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = { active: false };\n\n    this._onScreenClick = this.onScreenClick.bind(this);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.onScreenClick);\n  }\n\n  onScreenClick(e) {\n    const el = document.querySelector('.c-basemap-tooltip');\n    const clickOutside = el && el.contains && !el.contains(e.target);\n\n    if (clickOutside) this.toggleDropdown(false);\n  }\n\n  onBasemapChange({ value }) {\n    this.props.setBasemap(value);\n  }\n\n  toggleDropdown(to) {\n    const active = (typeof to !== 'undefined' && to !== null) ? to : !this.state.active;\n\n    this.setState({ active });\n\n    requestAnimationFrame(() => {\n      if (to) {\n        window.addEventListener('click', this._onScreenClick);\n      } else {\n        window.removeEventListener('click', this._onScreenClick);\n      }\n    });\n    this.setState({ active });\n  }\n\n  // RENDER\n  render() {\n    const { basemap } = this.props;\n    const { active } = this.state;\n\n    return (\n      <TetherComponent\n        attachment=\"top right\"\n        constraints={[{\n          to: 'window'\n        }]}\n        targetOffset=\"8px 100%\"\n        classes={{\n          element: 'c-basemap-tooltip -arrow-right'\n        }}\n      >\n        {/* First child: This is what the item will be tethered to */}\n        <button type=\"button\" className=\"basemap-button\" onClick={() => this.toggleDropdown(true)}>\n          <Icon name=\"layers\" className=\"-small\" />\n        </button>\n\n        {/* Second child: If present, this item will be tethered to the the first child */}\n        {active &&\n          <div>\n            <RadioGroup\n              items={Object.keys(BASEMAPS).map((k) => {\n                const bs = BASEMAPS[k];\n                return {\n                  label: bs.label,\n                  value: bs.id\n                };\n              })}\n              name=\"basemap\"\n              selected={basemap}\n              onChange={(_basemap) => { this.onBasemapChange(_basemap); }}\n              // className=\"-secondary\"\n            />\n\n            <div className=\"divisor\" />\n\n          </div>\n        }\n      </TetherComponent>\n    );\n  }\n}\n\nBasemapControl.propTypes = {\n  basemap: PropTypes.string.isRequired,\n  setBasemap: PropTypes.func.isRequired\n};\n\nexport default BasemapControl;\n","import { connect } from 'react-redux';\nimport { setBasemap } from 'modules/map/actions';\nimport BasemapControl from './component';\n\nexport default connect(\n  state => ({ basemap: state.map.basemap }),\n  { setBasemap }\n)(BasemapControl);\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport LegendTypeChoropleth from '../legend-type-choropleth';\nimport {\n  Map as LeMap,\n  MapControls,\n  ZoomControl,\n  Icon,\n  Legend,\n  LegendListItem,\n  LegendItemTypes,\n  MapPopup,\n  LegendItemToolbar,\n  LegendItemButtonOpacity\n} from 'vizzuality-components';\nimport BasemapControl from './basemap-control';\nimport { PluginLeaflet } from 'layer-manager';\nimport { LayerManager, Layer } from 'layer-manager/dist/components';\n\n// utils\nimport { logEvent } from 'utils/analytics';\n\nimport { BASEMAPS, LABEL_LAYER_CONFIG } from './constants';\n\nclass Map extends Component {\n  static propTypes = {\n    children: PropTypes.func,\n    viewport: PropTypes.shape({}),\n    bounds: PropTypes.shape({\n      bbox: PropTypes.array,\n      options: PropTypes.shape({})\n    }),\n    dragPan: PropTypes.bool,\n    dragRotate: PropTypes.bool, // A boolean that allows rotating\n    setMapViewport: PropTypes.func,\n    onViewportChange: PropTypes.func,\n    onLoad: PropTypes.func,\n    onStyleLoad: PropTypes.func,\n    layers: PropTypes.array,\n    setModalState: PropTypes.func\n  }\n\n  static defaultProps = {\n    children: null,\n    viewport: { zoom: 2, lat: 0, lng: 0 },\n    bounds: {},\n    dragPan: true,\n    dragRotate: true,\n    onViewportChange: () => {},\n    onLoad: () => {},\n    onStyleLoad: () => {},\n    setMapViewport: () => {},\n    layers: []\n  }\n\n  state = {\n    latlng: null,\n    interactions: {}\n  }\n\n  render() {\n    const { className = '', viewport, layers, bounds, basemap, setLayersOpacity, setModalState } = this.props;\n    const basemapConfig = {\n      ...BASEMAPS[basemap ||'osm'],\n      url: BASEMAPS[basemap || 'osm'].value\n    };\n    const mapProps = {\n      customClass: className,\n      mapOptions: {\n        zoom: viewport.zoom,\n        center: {\n          lat: viewport.latitude,\n          lng: viewport.longitude\n        }\n      },\n      bounds,\n      basemap: basemapConfig,\n      label: LABEL_LAYER_CONFIG,\n      events: {\n        zoomend: (e, map) => { /*console.info(e, map);*/ },\n        dragend: (e, map) => { /*console.info(e, map);*/ }\n      }\n    };\n\n    const layerGroups = (layers && layers.length) ? layers.map(l => ({\n      name: l.name,\n      dataset: l.dataset,\n      layers: [{...l, active: true}]\n    })) : [];\n\n    const shareClickHandler = () => {\n      setModalState({isOpen: true, content: 'share' });\n      logEvent('[AQ-Country-Ranking] Share', 'user opens share modal', 'click');\n    };\n\n    // NOTE: We need to prefix icon name with 'icon-' because Icon from vizzuality\n    // does not do that automatically but Icon from aqueduct does.\n    return (\n      <LeMap {...mapProps}>\n        {_map => {\n          window.m = _map;\n\n          const Score = ({score}) => {\n            return (score)\n            ? <div>{`Score: ${score.toFixed(2)}`}</div>\n            : null;\n          };\n\n          return (\n          <Fragment>\n            <LayerManager\n                map={_map}\n                plugin={PluginLeaflet}\n                onReady={() => { /*if (loading) setLoading(false);*/ }}\n            >\n              {layers.map(layer => (\n                <Layer\n                  key={layer.id}\n                  {...layer}\n                  {...!!layer.interactionConfig && !!layer.interactionConfig.output && !!layer.interactionConfig.output.length && {\n                    interactivity: (layer.provider === 'carto' || layer.provider === 'cartodb') ? layer.interactionConfig.output.map(o => o.column) : true,\n                    events: {\n                      click: (e) => {\n                        this.setState({\n                          interactionData: e.data,\n                          latlng: e.latlng\n                        })\n                      }\n                    }\n                  }}\n                />\n              ))}\n            </LayerManager>\n            <MapControls>\n              <ZoomControl map={_map} />\n              <BasemapControl />\n              <button type=\"button\" onClick={shareClickHandler}><Icon className=\"-medium\" name=\"icon-share\" /></button>\n              {/* <Icon className=\"-medium\" name=\"icon-download\" /> */}\n            </MapControls>\n            <MapPopup\n              map={_map}\n              latlng={this.state.latlng}\n              data={{\n                latlng: this.state.latlng,\n                interactions: this.state.interactions\n              }}\n            >\n              {\n                (this.state.interactionData) ?\n                  <div className=\"c-map-popup\">\n                    <div className=\"popup-header\">\n                      {this.state.interactionData.name_1 ? (\n                        <>\n                          <h3>{this.state.interactionData.name_1}</h3>\n                          <h4>{this.state.interactionData.name_0}</h4>\n                        </>\n                      ): (\n                        <h3>{this.state.interactionData.name_0}</h3>\n                      )}\n                    </div>\n                    <Score score={this.state.interactionData.score} />\n                    <div>{this.state.interactionData.label}</div>\n                  </div>\n                  : <div>No data</div>\n              }\n            </MapPopup>\n            <div className=\"c-legend\">\n              <Legend sortable={false}>\n                {layerGroups.map((lg, i) => (\n                  <LegendListItem\n                    index={i}\n                    key={lg.dataset}\n                    layerGroup={lg}\n                    onChangeOpacity={(_layer, _opacity) => setLayersOpacity(_opacity)}\n                    toolbar={(\n                      <LegendItemToolbar>\n                        <LegendItemButtonOpacity\n                          trackStyle={{ backgroundColor: '#2E57B8' }}\n                          handleStyle={{ backgroundColor: '#2E57B8' }}\n                        />\n                      </LegendItemToolbar>\n                    )}\n                  >\n                    <LegendItemTypes>\n                      <LegendTypeChoropleth />\n                    </LegendItemTypes>\n                  </LegendListItem>\n                ))}\n              </Legend>\n            </div>\n          </Fragment>\n        )}}\n      </LeMap>\n    );\n  }\n}\n\nexport default Map;\n","import { createSelector } from 'reselect';\n\nconst layers = state => state.layers.list;\nconst currentCountry = state => state.dashboard.locationId;\nconst currentScope = state => state.dashboard.scope;\nconst currentIndicator = state => state.dashboard.indicators.value;\n\nconst indexes = { bws: 0, drr: 1, rfr: 2 };\n\nexport const getActiveLayers = createSelector(\n  [layers, currentScope, currentCountry, currentIndicator],\n  (_layers, _currentScope, _currentCountry, _currentIndicator) => {\n    if (!_layers) {\n      return [];\n    }\n\n    const indicatorIndex = indexes[_currentIndicator];\n\n    // Country view: show provinces in this case\n    if (_currentScope === 'COUNTRY') {\n      const layerSpec = _layers.province_rankings[indicatorIndex];\n      return [{\n        ...layerSpec,\n        opacity: layerSpec.opacity || 0.5,\n        params: { ...layerSpec.params, iso: _currentCountry }\n      }];\n    }\n\n    // Global view: show country layer\n    return [{\n      ..._layers.country_rankings[indicatorIndex],\n      opacity: _layers.country_rankings[indicatorIndex].opacity || 0.5\n    }];\n  }\n);\n","import { connect } from 'react-redux';\nimport { setModalState } from 'modules/app/actions';\nimport {\n  setMapViewport, setMapBounds, setMapLoaded, setMapFlying\n} from 'modules/map/actions';\n\nimport Map from './component';\nimport { setLayersOpacity } from 'modules/layers/actions';\nimport { getActiveLayers } from 'modules/layers/selectors';\n\nconst mapStateToProps = state => ({\n  ...state.map,\n  layers: getActiveLayers(state),\n  scope: state.dashboard.scope\n});\n\nconst mapDispatchToProps = {\n  setMapViewport,\n  setMapBounds,\n  setMapLoaded,\n  setMapFlying,\n  setLayersOpacity,\n  setModalState\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Map);\n","import React from 'react';\nimport { Sidebar } from 'aqueduct-components';\n\nimport ModalManager from 'components/modal-manager';\nimport ShareModal from 'components/share-modal';\nimport IndicatorsInfoModal from 'components/indicators-info-modal';\nimport Dashboard from 'components/dashboard';\nimport Map from 'components/map';\n\nfunction getModalContent(content) {\n  switch(content) {\n    case 'share':\n      return <ShareModal />;\n    case 'indicators':\n      return <IndicatorsInfoModal />;\n    default:\n      return <></>;\n  }\n}\n\nconst Main = ({ isDashboardCollapsed, isModalOpen, modalContent, setDashboardCollapsed, setModalState}) => {\n  const closeModalHandler = () => setModalState({ isOpen: false, content: null });\n  return (\n    <main className=\"c-main\">\n      <Sidebar\n        customClass=\"c-aqueduct-sidebar\"\n        onToggle={isExpanded => {\n          setDashboardCollapsed(!isExpanded);\n        }}\n        visible={!isDashboardCollapsed}\n      >\n        <Dashboard />\n      </Sidebar>\n      <div className=\"map-wrapper\">\n        <Map className=\"c-aqueduct-map\" />\n      </div>\n      <ModalManager isOpen={isModalOpen} appElement=\"#root\" onRequestClose={closeModalHandler}>\n        {getModalContent(modalContent)}\n      </ModalManager>\n    </main>\n  );\n}\n\nexport default Main;\n","import { connect } from 'react-redux';\nimport {\n  setDashboardCollapsed\n} from 'modules/app/actions';\nimport { getLayers } from 'modules/layers/actions';\nimport { setModalState } from 'modules/app/actions';\n\nimport Main from './component';\n\nconst mapStateToProps = state => ({\n  ...state.app\n});\n\nconst mapDispatchToProps = {\n  setDashboardCollapsed,\n  getLayers,\n  setModalState\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Main);\n","import React, { useEffect } from 'react';\n\nimport Main from 'components/main';\n\n// utils\nimport { logPageView } from 'utils/analytics';\n\nconst HomePage = ({getLayers, loadDashboardData}) => {\n  useEffect(() => {\n    getLayers();\n    loadDashboardData();\n    logPageView();\n  }, [getLayers, loadDashboardData]);\n\n\n  return <Main />;\n}\n\nexport default HomePage;\n","import React from 'react';\n\nconst NotFoundPage = () => <div><h1>Not found</h1></div>;\n\nexport default NotFoundPage;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\n// todo: add Universal component or loadable\nimport HomePage from 'pages/home';\nimport NotFoundPage from 'pages/not-found';\n\nconst pageMap = new Map([\n  ['HOME', HomePage],\n  ['LOCATION', HomePage]\n]);\n\n\n// prompts or error logging should be handled here\nconst Layout = props => {\n  const { page: { current } } = props;\n  const Page = pageMap.has(current) ? pageMap.get(current) : NotFoundPage;\n\n  return <Page {...props} />;\n};\n\nLayout.propTypes = {\n  page: PropTypes.shape({\n    current: PropTypes.string.isRequired,\n    payload: PropTypes.shape({}).isRequired\n  }).isRequired\n};\n\nexport default Layout;\n","import { connect } from 'react-redux';\nimport Layout from './component';\n\nimport { loadDashboardData } from 'modules/data/actions';\nimport { getLayers } from 'modules/layers/actions';\n\nconst mapStateToProps = ({ page }) => ({ page });\nconst mapDispatchToProps = {\n  getLayers,\n  loadDashboardData\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Layout);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { Icons, Header } from 'aqueduct-components';\nimport { initGA } from './utils/analytics';\nimport store from 'config/store';\nimport Pages from 'components/layout';\n\nimport 'react-app-polyfill/stable';\n// import 'aqueduct-components/dist/bundle';\nimport 'styles/index.scss';\n\ninitGA();\n\nconst App = () => (\n  <Provider store={store}>\n    <Icons />\n    <div className=\"header--wrapper\">\n      <Header\n        title=\"Country Rankings\"\n        appRoute=\"/aqueduct/\"\n      >\n        <ul className=\"list\">\n          <li>\n            <a className=\"c-header-button\" href=\"https://www.wri.org/aqueduct#aqueduct-tools\" target=\"_blank\" rel=\"noopener noreferrer\">Tools</a>\n          </li>\n          <li>\n            <a className=\"c-header-button\" href=\"https://wri.org/aqueduct/blog\" target=\"_blank\" rel=\"noopener noreferrer\">Blog</a>\n          </li>\n          <li>\n            <a className=\"c-header-button\" href=\"https://wri.org/aqueduct/publications\" target=\"_blank\" rel=\"noopener noreferrer\">Publications</a>\n          </li>\n          <li>\n            <a className=\"c-header-button\" href=\"https://wri.org/aqueduct/data\" target=\"_blank\" rel=\"noopener noreferrer\">Data</a>\n          </li>\n          <li>\n            <a className=\"c-header-button\" href=\"https://wri.org/aqueduct/user-stories\" target=\"_blank\" rel=\"noopener noreferrer\">User Stories</a>\n          </li>\n          <li>\n            <a className=\"c-header-button\" href=\"https://wri.org/aqueduct/about\" target=\"_blank\" rel=\"noopener noreferrer\">About</a>\n          </li>\n          <li>\n            <a className=\"c-header-button\" href=\"https://wri.org/aqueduct/subscribe\" target=\"_blank\" rel=\"noopener noreferrer\">Subscribe</a>\n          </li>\n        </ul>\n      </Header>\n    </div>\n    <Pages />\n  </Provider>\n);\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}